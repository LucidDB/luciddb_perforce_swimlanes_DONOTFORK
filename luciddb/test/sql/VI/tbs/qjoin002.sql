-- Simple SELF JOIN tests
-- Cover the following join types
-- b) NOT IN
-- c) NOT BETWEEN

set schema 's';

-- NOT IN JOIN
-- IN is P2
SELECT B1.KSEQ, B1.K2 as B1K2, B2.K2 as B2K2, B2.K4 
FROM BENCH100 B1, BENCH100 B2 
WHERE B1.K2 NOT IN (B2.K2, B2.K4)  AND B1.KSEQ < 20
ORDER BY KSEQ, B1K2, B2K2, K4
;

SELECT B1.KSEQ, B1.K2 as B1K2, B2.K2 as B2K2, B2.K5 
FROM BENCH100 B1, BENCH100 B2 
WHERE B1.K2 NOT IN (B2.K4, B2.K5)  AND B1.KSEQ < 20
ORDER BY KSEQ, B1K2, B2K2, K5
;

SELECT B1.KSEQ, B1.K2, B2.K2, B2.K10 FROM BENCH100 B1, BENCH100 B2 
WHERE B1.K2 NOT IN (B2.K4, B2.K10)  AND B1.KSEQ < 20
ORDER BY B1.KSEQ, B1.K2, B2.K2, B2.K10
;

SELECT B1.KSEQ, B1.K2, B2.K2, B2.K25 FROM BENCH100 B1, BENCH100 B2 
WHERE B1.K2 NOT IN (B2.K4, B2.K25)  AND B1.KSEQ < 20
ORDER BY B1.KSEQ, B1.K2, B2.K2, B2.K25
;

-- NOT BETWEEN JOIN

SELECT B1.KSEQ, B1.K2 as B1K2, B2.K2 as B2K2, B2.K4 
FROM BENCH100 B1, BENCH100 B2 
WHERE B1.K2 NOT BETWEEN B2.K2 AND B2.K4 AND B1.KSEQ < 20
ORDER BY KSEQ, B1K2, B2K2, K4
;

SELECT B1.KSEQ, B1.K2 as B1K2, B2.K2 as B2K2, B2.K5 
FROM BENCH100 B1, BENCH100 B2 
WHERE B1.K2 NOT BETWEEN B2.K2 AND B2.K5 AND B1.KSEQ < 20
ORDER BY KSEQ, B1K2, B2K2, K5
;

SELECT B1.KSEQ, B1.K2 as B1K2, B2.K2 as B2K2, B2.K10 
FROM BENCH100 B1, BENCH100 B2 
WHERE B1.K2 NOT BETWEEN B2.K2 AND B2.K10 AND B1.KSEQ < 20
ORDER BY KSEQ, B1K2, B2K2, K10
;

SELECT B1.KSEQ, B1.K2 as B1K2, B2.K2 B2K2, B2.K25 
FROM BENCH100 B1, BENCH100 B2 
WHERE B1.K2 NOT BETWEEN B2.K2 AND B2.K25 AND B1.KSEQ < 20
ORDER BY KSEQ, B1K2, B2K2, K25
;

