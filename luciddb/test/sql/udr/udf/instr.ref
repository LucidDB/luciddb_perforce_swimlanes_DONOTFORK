0: jdbc:luciddb:> -- $Id$
0: jdbc:luciddb:> -- Tests for INSTR UDF
0: jdbc:luciddb:> set schema 'udftest';
0: jdbc:luciddb:> set path 'udftest';
0: jdbc:luciddb:> 
0: jdbc:luciddb:> values applib.instr('this, is, a , test', ' ');
+---------+
| EXPR$0  |
+---------+
| 6       |
+---------+
0: jdbc:luciddb:> values applib.instr('hello there. what''s your name? henny''s ', '''');
+---------+
| EXPR$0  |
+---------+
| 18      |
+---------+
0: jdbc:luciddb:> values applib.instr('this, is, a , test', ' ', -1, 3);
+---------+
| EXPR$0  |
+---------+
| 10      |
+---------+
0: jdbc:luciddb:> values applib.instr('AAABBBCCCDDDAABBBCCCEEE', 'AB', 1, 1);
+---------+
| EXPR$0  |
+---------+
| 3       |
+---------+
0: jdbc:luciddb:> values applib.instr('AAABBBCCCDDDAABBBCCCEEE', 'ABB', -8, 1);
+---------+
| EXPR$0  |
+---------+
| 14      |
+---------+
0: jdbc:luciddb:> values applib.instr('AAABBBCCCDDDAABBBCCCEEE', 'ABB', -10, 1);
+---------+
| EXPR$0  |
+---------+
| 14      |
+---------+
0: jdbc:luciddb:> values applib.instr('hello there. what''s your name? henny''s ', 'he', 8, 2);
+---------+
| EXPR$0  |
+---------+
| 32      |
+---------+
0: jdbc:luciddb:> values applib.instr('hello there. what''s your name? henny''s ', '''', 1, 2);
+---------+
| EXPR$0  |
+---------+
| 37      |
+---------+
0: jdbc:luciddb:> values applib.instr('n1b2n1h4jn1;', 'n1', -1, 4);
+---------+
| EXPR$0  |
+---------+
| 0       |
+---------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- invalid argument failures
0: jdbc:luciddb:> values applib.instr('nononon', 'no', 0, 1);
Error: Could not calculate result column 1 for the following row:
[0]
Messages: Invocation of user-defined external Java method execute failed
InStrUdf: invalid argument: inStr=nononon subStr=no startPos=0 nthAppearance=1 (state=,code=0)
0: jdbc:luciddb:> values applib.instr('nono', 'no', 1, 0);
Error: Could not calculate result column 1 for the following row:
[0]
Messages: Invocation of user-defined external Java method execute failed
InStrUdf: invalid argument: inStr=nono subStr=no startPos=1 nthAppearance=0 (state=,code=0)
0: jdbc:luciddb:> values applib.instr('nonon', 'no', 6, 1);
Error: Could not calculate result column 1 for the following row:
[0]
Messages: Invocation of user-defined external Java method execute failed
InStrUdf: invalid argument: inStr=nonon subStr=no startPos=6 nthAppearance=1 (state=,code=0)
0: jdbc:luciddb:> values applib.instr('fds', 'sdfkdsl');
Error: Could not calculate result column 1 for the following row:
[0]
Messages: Invocation of user-defined external Java method execute failed
InStrUdf: invalid argument: inStr=fds subStr=sdfkdsl startPos=1 nthAppearance=1 (state=,code=0)
0: jdbc:luciddb:> values applib.instr('hello there!', '');
Error: Could not calculate result column 1 for the following row:
[0]
Messages: Invocation of user-defined external Java method execute failed
InStrUdf: invalid argument: inStr=hello there! subStr= startPos=1 nthAppearance=1 (state=,code=0)
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- view test
0: jdbc:luciddb:> create view flpview(flp, instr_flp) as 
. . . . . . . . > select fname||lname||phone, applib.instr(fname||lname||phone, '23')
. . . . . . . . > from customers;
0: jdbc:luciddb:> 
0: jdbc:luciddb:> select * from flpview
. . . . . . . . > order by 1;
+----------------------------------------------+------------+
|                     FLP                      | INSTR_FLP  |
+----------------------------------------------+------------+
| 2Tito1               888 888 8888            | 0          |
| Dirk the 3rdTreethorn8622399175              | 25         |
| Ephram      Vestrit  (321)3454321            | 0          |
| Gregory     Packery  (342) 234-2355          | 28         |
| Lilah       Lowe        234    412   344  2  | 25         |
| Mark        Wyatt    1234567890              | 23         |
| Mary        O Brian  234-456-7843            | 22         |
+----------------------------------------------+------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> select flp, applib.instr(flp, 'a', -3, 2)
. . . . . . . . > from flpview
. . . . . . . . > order by 1;
+----------------------------------------------+---------+
|                     FLP                      | EXPR$1  |
+----------------------------------------------+---------+
| 2Tito1               888 888 8888            | 0       |
| Dirk the 3rdTreethorn8622399175              | 0       |
| Ephram      Vestrit  (321)3454321            | 0       |
| Gregory     Packery  (342) 234-2355          | 0       |
| Lilah       Lowe        234    412   344  2  | 0       |
| Mark        Wyatt    1234567890              | 2       |
| Mary        O Brian  234-456-7843            | 2       |
+----------------------------------------------+---------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- cleanup
0: jdbc:luciddb:> drop view flpview;
0: jdbc:luciddb:> !quit
