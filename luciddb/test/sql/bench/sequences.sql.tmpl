create schema s;
set schema 's';

--
-- create tables with auto-increment column
--
create table seq210 (
seqcol bigint generated by default as identity
  (minvalue -9 maxvalue 200 start with 0 cycle),
"kseq" bigint primary key,
"k2" bigint,
"k4" bigint,
"k5" bigint,
"k10" bigint,
"k25" bigint,
"k100" bigint,
"k1k" bigint,
"k10k" bigint,
"k40k" bigint,
"k100k" bigint,
"k250k" bigint,
"k500k" bigint)
server @DATA_STORE@;

create table seq10k(
seq10kcol bigint generated by default as identity
  (minvalue 0 maxvalue 10000 increment by 1),
"kseq" bigint primary key,
"k2" bigint,
"k4" bigint,
"k5" bigint,
"k10" bigint,
"k25" bigint,
"k100" bigint,
"k1k" bigint,
"k10k" bigint,
"k40k" bigint,
"k100k" bigint,
"k250k" bigint,
"k500k" bigint)
server @DATA_STORE@;

-- 
-- inserts/queries
--
insert into s.seq210("kseq","k2","k4","k5","k10","k25","k100","k1k","k10k",
  "k40k","k100k", "k250k", "k500k")
select "kseq","k2","k4","k5","k10","k25","k100","k1k","k10k","k40k","k100k","k250k","k500k"
FROM @name_prefix@_schema."bench100";

insert into s.seq210("kseq","k2","k4","k5","k10","k25","k100","k1k","k10k",
  "k40k","k100k", "k250k", "k500k")
select "kseq","k2","k4","k5","k10","k25","k100","k1k","k10k","k40k","k100k","k250k","k500k"
FROM @name_prefix@_schema."bench100";

insert into s.seq210("kseq","k2","k4","k5","k10","k25","k100","k1k","k10k",
  "k40k","k100k", "k250k", "k500k")
select "kseq","k2","k4","k5","k10","k25","k100","k1k","k10k","k40k","k100k","k250k","k500k"
FROM @name_prefix@_schema."bench100";

select count(distinct seqcol) from s.seq210;

delete from seq210 where "kseq" in (50,51,52,53,54,55,56,57,58,59);

select count(distinct seqcol) from s.seq210;

insert into s.seq210 ("kseq") values (101);

alter table s.seq210 alter column seqcol
  set minvalue 30;

insert into s.seq210("kseq") values(102);

-- should fail, sequence start is higher than maxvalue
alter table s.seq210 alter column seqcol
  set maxvalue 60;

alter table s.seq210 alter column seqcol
  set maxvalue 100 set increment by -1;

insert into s.seq210("kseq") values(103);

insert into s.seq210("kseq") values(104), (105);

select * from s.seq210 where "kseq" > 100
order by "kseq";

-- should fail
alter table s.seq210 alter column seqcol
  set maxvalue 60 set increment by 10;

-- if alter table fails, base value resets..
insert into s.seq210("kseq") values (106), (107), (108), (109);

select * from s.seq210 where "kseq" > 100
order by "kseq";

alter table s.seq210 alter column seqcol
  set increment by 1 set no cycle;

truncate table s.seq210;

--
--

insert into s.seq10k("kseq","k2","k4","k5","k10","k25","k100","k1k","k10k",
  "k40k","k100k", "k250k", "k500k")
select "kseq","k2","k4","k5","k10","k25","k100","k1k","k10k","k40k","k100k","k250k","k500k"
FROM @name_prefix@_schema."bench10K";

select count (distinct seq10kcol) from seq10k;

insert into s.seq10k(seq10kcol, "kseq") values (50, 10001);

insert into s.seq10k("kseq") values (10002);

insert into s.seq210("kseq") values (1), (2);

select * from s.seq210 order by "kseq";

