0: jdbc:luciddb:> set schema 'ssb';
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q1.1
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     sum(lo_extendedprice*lo_discount) as revenue
. . . . . . . . > from 
. . . . . . . . >     lineorder, dates
. . . . . . . . > where 
. . . . . . . . >     lo_orderdate = d_datekey
. . . . . . . . >     and d_year = 1993
. . . . . . . . >     and lo_discount between 1 and 3
. . . . . . . . >     and lo_quantity < 25;
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                  column0                                                                                                                                  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                                                 |
|   FennelAggRel(groupCount=[0], REVENUE=[SUM($0)])                                                                                                                                                                                                                         |
|     IteratorToFennelConverter                                                                                                                                                                                                                                             |
|       IterCalcRel(expr#0..1=[{inputs}], expr#2=[*($t0, $t1)], $f0=[$t2])                                                                                                                                                                                                  |
|         FennelToIteratorConverter                                                                                                                                                                                                                                         |
|           LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[9, 11]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_DISCOUNT, SYS$CLUSTERED_INDEX$LINEORDER$LO_QUANTITY, SYS$CLUSTERED_INDEX$LINEORDER$LO_EXTENDEDPRICE]], residual columns=[[11, 8]])  |
|             LcsIndexMergeRel(consumerSridParamId=[0], segmentLimitParamId=[0], ridLimitParamId=[1])                                                                                                                                                                       |
|               LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                         |
|                 FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                       |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                     |
|                     FennelValuesRel(tuples=[[{ '[', 1993, ']', 1993 }]])                                                                                                                                                                                                  |
|             FennelValuesRel(tuples=[[{ '[', 1, ']', 3 }]])                                                                                                                                                                                                                |
|             FennelValuesRel(tuples=[[{ '(', null, ')', 25 }]])                                                                                                                                                                                                            |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q1.2
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     sum(lo_extendedprice*lo_discount) as revenue
. . . . . . . . > from 
. . . . . . . . >     lineorder, dates
. . . . . . . . > where 
. . . . . . . . >     lo_orderdate = d_datekey
. . . . . . . . >     and d_yearmonthnum = 199401
. . . . . . . . >     and lo_discount between 4 and 6
. . . . . . . . >     and lo_quantity between 26 and 35;
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                  column0                                                                                                                                  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                                                 |
|   FennelAggRel(groupCount=[0], REVENUE=[SUM($0)])                                                                                                                                                                                                                         |
|     IteratorToFennelConverter                                                                                                                                                                                                                                             |
|       IterCalcRel(expr#0..1=[{inputs}], expr#2=[*($t0, $t1)], $f0=[$t2])                                                                                                                                                                                                  |
|         FennelToIteratorConverter                                                                                                                                                                                                                                         |
|           LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[9, 11]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_QUANTITY, SYS$CLUSTERED_INDEX$LINEORDER$LO_DISCOUNT, SYS$CLUSTERED_INDEX$LINEORDER$LO_EXTENDEDPRICE]], residual columns=[[8, 11]])  |
|             LcsIndexMergeRel(consumerSridParamId=[0], segmentLimitParamId=[0], ridLimitParamId=[1])                                                                                                                                                                       |
|               LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                         |
|                 FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                       |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]])                                                                                                                               |
|                     LcsIndexSearchRel(table=[[LOCALDB, SSB, DATES]], index=[D_YEARMONTHNUM_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                            |
|                       FennelValuesRel(tuples=[[{ '[', 199401, ']', 199401 }]])                                                                                                                                                                                            |
|             FennelValuesRel(tuples=[[{ '[', 26, ']', 35 }]])                                                                                                                                                                                                              |
|             FennelValuesRel(tuples=[[{ '[', 4, ']', 6 }]])                                                                                                                                                                                                                |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q1.3
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     sum(lo_extendedprice*lo_discount) as revenue
. . . . . . . . > from 
. . . . . . . . >     lineorder, dates
. . . . . . . . > where 
. . . . . . . . >     lo_orderdate = d_datekey
. . . . . . . . >     and d_weeknuminyear = 6
. . . . . . . . >     and d_year = 1994
. . . . . . . . >     and lo_discount between 5 and 7
. . . . . . . . >     and lo_quantity between 26 and 35;
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                  column0                                                                                                                                  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                                                 |
|   FennelAggRel(groupCount=[0], REVENUE=[SUM($0)])                                                                                                                                                                                                                         |
|     IteratorToFennelConverter                                                                                                                                                                                                                                             |
|       IterCalcRel(expr#0..1=[{inputs}], expr#2=[*($t0, $t1)], $f0=[$t2])                                                                                                                                                                                                  |
|         FennelToIteratorConverter                                                                                                                                                                                                                                         |
|           LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[9, 11]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_QUANTITY, SYS$CLUSTERED_INDEX$LINEORDER$LO_DISCOUNT, SYS$CLUSTERED_INDEX$LINEORDER$LO_EXTENDEDPRICE]], residual columns=[[8, 11]])  |
|             LcsIndexMergeRel(consumerSridParamId=[0], segmentLimitParamId=[0], ridLimitParamId=[1])                                                                                                                                                                       |
|               LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                         |
|                 FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                       |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                     |
|                     LcsIndexSearchRel(table=[[LOCALDB, SSB, DATES]], index=[D_WEEKNUMINYEAR_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                           |
|                       FennelValuesRel(tuples=[[{ '[', 6, ']', 6 }]])                                                                                                                                                                                                      |
|                     FennelValuesRel(tuples=[[{ '[', 1994, ']', 1994 }]])                                                                                                                                                                                                  |
|             FennelValuesRel(tuples=[[{ '[', 26, ']', 35 }]])                                                                                                                                                                                                              |
|             FennelValuesRel(tuples=[[{ '[', 5, ']', 7 }]])                                                                                                                                                                                                                |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q2.1
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     sum(lo_revenue), d_year, p_brand
. . . . . . . . > from 
. . . . . . . . >     lineorder, dates, part, supplier
. . . . . . . . > where 
. . . . . . . . >     lo_orderdate = d_datekey
. . . . . . . . >     and lo_partkey = p_partkey
. . . . . . . . >     and lo_suppkey = s_suppkey
. . . . . . . . >     and p_category = 'MFGR#12'
. . . . . . . . >     and s_region = 'AMERICA'
. . . . . . . . > group by 
. . . . . . . . >     d_year, p_brand
. . . . . . . . > order by 
. . . . . . . . >     d_year, p_brand;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                         column0                                                                                                                          |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                                |
|   FennelSortRel(key=[[1, 2]], discardDuplicates=[false])                                                                                                                                                                                                 |
|     FennelReshapeRel(projection=[[2, 0, 1]], outputRowType=[RecordType(BIGINT EXPR$0, INTEGER NOT NULL D_YEAR, VARCHAR(9) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL P_BRAND) NOT NULL])                                     |
|       LhxAggRel(groupCount=[2], EXPR$0=[SUM($2)])                                                                                                                                                                                                        |
|         FennelReshapeRel(projection=[[1, 2, 4]], outputRowType=[RecordType(INTEGER NOT NULL D_YEAR, VARCHAR(9) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL P_BRAND, BIGINT LO_REVENUE) NOT NULL])                             |
|           LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                                  |
|             LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_DATEKEY, SYS$CLUSTERED_INDEX$DATES$D_YEAR]])                                                                               |
|             FennelReshapeRel(projection=[[1, 3, 4]], outputRowType=[RecordType(VARCHAR(9) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL P_BRAND, INTEGER NOT NULL LO_ORDERDATE, BIGINT LO_REVENUE) NOT NULL])                   |
|               LhxJoinRel(leftKeys=[[0]], rightKeys=[[0]], joinType=[INNER])                                                                                                                                                                              |
|                 FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[7])                                                                                                                                                                     |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, PART]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$PART$P_CATEGORY, SYS$CLUSTERED_INDEX$PART$P_BRAND, SYS$CLUSTERED_INDEX$PART$P_PARTKEY]], residual columns=[[3]])              |
|                     FennelValuesRel(tuples=[[{ '[', 'MFGR#12', ']', 'MFGR#12' }]])                                                                                                                                                                       |
|                 LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[3, 5, 12]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_ORDERDATE, SYS$CLUSTERED_INDEX$LINEORDER$LO_PARTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_REVENUE]])          |
|                   LcsIndexIntersectRel(startRidParamId=[2], rowLimitParamId=[3])                                                                                                                                                                         |
|                     LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[5])                                                                                                                                              |
|                       LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_PARTKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                  |
|                         FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                              |
|                           FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL P_PARTKEY) NOT NULL])                                                                                                                            |
|                             FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[7])                                                                                                                                                         |
|                               LcsRowScanRel(table=[[LOCALDB, SSB, PART]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$PART$P_CATEGORY, SYS$CLUSTERED_INDEX$PART$P_BRAND, SYS$CLUSTERED_INDEX$PART$P_PARTKEY]], residual columns=[[3]])  |
|                                 FennelValuesRel(tuples=[[{ '[', 'MFGR#12', ']', 'MFGR#12' }]])                                                                                                                                                           |
|                     LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[1])                                                                                                                                              |
|                       LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                |
|                         FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                              |
|                           LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]])                                                                                                      |
|                     LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[4])                                                                                                                                              |
|                       LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_SUPPKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                  |
|                         FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                              |
|                           LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_REGION, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]], residual columns=[[5]])                                 |
|                             FennelValuesRel(tuples=[[{ '[', 'AMERICA', ']', 'AMERICA' }]])                                                                                                                                                               |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q2.2
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     sum(lo_revenue), d_year, p_brand
. . . . . . . . > from 
. . . . . . . . >     lineorder, dates, part, supplier
. . . . . . . . > where 
. . . . . . . . >     lo_orderdate = d_datekey
. . . . . . . . >     and lo_partkey = p_partkey
. . . . . . . . >     and lo_suppkey = s_suppkey
. . . . . . . . >     and p_brand between 'MFGR#2221' and 'MFGR#2228'
. . . . . . . . >     and s_region = 'ASIA'
. . . . . . . . > group by 
. . . . . . . . >     d_year, p_brand
. . . . . . . . > order by 
. . . . . . . . >     d_year, p_brand;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                     column0                                                                                                                      |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                        |
|   FennelSortRel(key=[[1, 2]], discardDuplicates=[false])                                                                                                                                                                                         |
|     FennelReshapeRel(projection=[[2, 0, 1]], outputRowType=[RecordType(BIGINT EXPR$0, INTEGER NOT NULL D_YEAR, VARCHAR(9) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL P_BRAND) NOT NULL])                             |
|       LhxAggRel(groupCount=[2], EXPR$0=[SUM($2)])                                                                                                                                                                                                |
|         FennelReshapeRel(projection=[[2, 1, 4]], outputRowType=[RecordType(INTEGER NOT NULL D_YEAR, VARCHAR(9) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL P_BRAND, BIGINT LO_REVENUE) NOT NULL])                     |
|           LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                          |
|             FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[7])                                                                                                                                                                 |
|               LcsRowScanRel(table=[[LOCALDB, SSB, PART]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$PART$P_BRAND, SYS$CLUSTERED_INDEX$PART$P_PARTKEY]], residual columns=[[4]])                                               |
|                 FennelValuesRel(tuples=[[{ '[', 'MFGR#2221', ']', 'MFGR#2228' }]])                                                                                                                                                               |
|             FennelReshapeRel(projection=[[1, 2, 4]], outputRowType=[RecordType(INTEGER NOT NULL D_YEAR, INTEGER NOT NULL LO_PARTKEY, BIGINT LO_REVENUE) NOT NULL])                                                                               |
|               LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                      |
|                 LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_DATEKEY, SYS$CLUSTERED_INDEX$DATES$D_YEAR]])                                                                   |
|                 LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[3, 5, 12]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_ORDERDATE, SYS$CLUSTERED_INDEX$LINEORDER$LO_PARTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_REVENUE]])  |
|                   LcsIndexIntersectRel(startRidParamId=[2], rowLimitParamId=[3])                                                                                                                                                                 |
|                     LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[5])                                                                                                                                      |
|                       LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_PARTKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                          |
|                         FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                      |
|                           FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL P_PARTKEY) NOT NULL])                                                                                                                    |
|                             FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[7])                                                                                                                                                 |
|                               LcsRowScanRel(table=[[LOCALDB, SSB, PART]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$PART$P_BRAND, SYS$CLUSTERED_INDEX$PART$P_PARTKEY]], residual columns=[[4]])                               |
|                                 FennelValuesRel(tuples=[[{ '[', 'MFGR#2221', ']', 'MFGR#2228' }]])                                                                                                                                               |
|                     LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[1])                                                                                                                                      |
|                       LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                        |
|                         FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                      |
|                           LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]])                                                                                              |
|                     LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[4])                                                                                                                                      |
|                       LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_SUPPKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                          |
|                         FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                      |
|                           LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_REGION, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]], residual columns=[[5]])                         |
|                             FennelValuesRel(tuples=[[{ '[', 'ASIA', ']', 'ASIA' }]])                                                                                                                                                             |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q2.3
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     sum(lo_revenue), d_year, p_brand
. . . . . . . . > from 
. . . . . . . . >     lineorder, dates, part, supplier
. . . . . . . . > where 
. . . . . . . . >     lo_orderdate = d_datekey
. . . . . . . . >     and lo_partkey = p_partkey
. . . . . . . . >     and lo_suppkey = s_suppkey
. . . . . . . . >     and p_brand = 'MFGR#2239'
. . . . . . . . >     and s_region = 'EUROPE'
. . . . . . . . > group by 
. . . . . . . . >     d_year, p_brand
. . . . . . . . > order by 
. . . . . . . . >     d_year, p_brand;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                     column0                                                                                                                      |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                        |
|   FennelSortRel(key=[[1, 2]], discardDuplicates=[false])                                                                                                                                                                                         |
|     FennelReshapeRel(projection=[[2, 0, 1]], outputRowType=[RecordType(BIGINT EXPR$0, INTEGER NOT NULL D_YEAR, VARCHAR(9) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL P_BRAND) NOT NULL])                             |
|       LhxAggRel(groupCount=[2], EXPR$0=[SUM($2)])                                                                                                                                                                                                |
|         FennelReshapeRel(projection=[[2, 1, 4]], outputRowType=[RecordType(INTEGER NOT NULL D_YEAR, VARCHAR(9) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL P_BRAND, BIGINT LO_REVENUE) NOT NULL])                     |
|           LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                          |
|             FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[7])                                                                                                                                                                 |
|               LcsRowScanRel(table=[[LOCALDB, SSB, PART]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$PART$P_BRAND, SYS$CLUSTERED_INDEX$PART$P_PARTKEY]])                                                                       |
|                 LcsIndexSearchRel(table=[[LOCALDB, SSB, PART]], index=[P_CATEGORY_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                            |
|                   FennelValuesRel(tuples=[[{ '[', 'MFGR#2239', ']', 'MFGR#2239' }]])                                                                                                                                                             |
|             FennelReshapeRel(projection=[[1, 2, 4]], outputRowType=[RecordType(INTEGER NOT NULL D_YEAR, INTEGER NOT NULL LO_PARTKEY, BIGINT LO_REVENUE) NOT NULL])                                                                               |
|               LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                      |
|                 LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_DATEKEY, SYS$CLUSTERED_INDEX$DATES$D_YEAR]])                                                                   |
|                 LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[3, 5, 12]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_ORDERDATE, SYS$CLUSTERED_INDEX$LINEORDER$LO_PARTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_REVENUE]])  |
|                   LcsIndexIntersectRel(startRidParamId=[2], rowLimitParamId=[3])                                                                                                                                                                 |
|                     LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[4])                                                                                                                                      |
|                       LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_PARTKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                          |
|                         FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                      |
|                           FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL P_PARTKEY) NOT NULL])                                                                                                                    |
|                             FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[7])                                                                                                                                                 |
|                               LcsRowScanRel(table=[[LOCALDB, SSB, PART]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$PART$P_BRAND, SYS$CLUSTERED_INDEX$PART$P_PARTKEY]])                                                       |
|                                 LcsIndexSearchRel(table=[[LOCALDB, SSB, PART]], index=[P_CATEGORY_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                            |
|                                   FennelValuesRel(tuples=[[{ '[', 'MFGR#2239', ']', 'MFGR#2239' }]])                                                                                                                                             |
|                     LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[1])                                                                                                                                      |
|                       LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                        |
|                         FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                      |
|                           LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]])                                                                                              |
|                     LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[5])                                                                                                                                      |
|                       LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_SUPPKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                          |
|                         FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                      |
|                           LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_REGION, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]], residual columns=[[5]])                         |
|                             FennelValuesRel(tuples=[[{ '[', 'EUROPE', ']', 'EUROPE' }]])                                                                                                                                                         |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q3.1
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     c_nation, s_nation, d_year,
. . . . . . . . >     sum(lo_revenue) as revenue
. . . . . . . . > from 
. . . . . . . . >     customer, lineorder, supplier, dates
. . . . . . . . > where 
. . . . . . . . >     lo_custkey = c_custkey
. . . . . . . . >     and lo_suppkey = s_suppkey
. . . . . . . . >     and lo_orderdate = d_datekey
. . . . . . . . >     and c_region = 'ASIA'
. . . . . . . . >     and s_region = 'ASIA'
. . . . . . . . >     and d_year >= 1992 and d_year <= 1997
. . . . . . . . > group by 
. . . . . . . . >     c_nation, s_nation, d_year
. . . . . . . . > order by 
. . . . . . . . >     d_year asc, revenue desc;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                            column0                                                                                                                                                            |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                                                                                                     |
|   FennelSortRel(key=[[2, 3 Descending]], discardDuplicates=[false])                                                                                                                                                                                                                                                           |
|     LhxAggRel(groupCount=[3], REVENUE=[SUM($3)])                                                                                                                                                                                                                                                                              |
|       FennelReshapeRel(projection=[[3, 1, 2, 5]], outputRowType=[RecordType(VARCHAR(15) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_NATION, VARCHAR(15) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL S_NATION, INTEGER NOT NULL D_YEAR, BIGINT LO_REVENUE) NOT NULL])  |
|         LhxJoinRel(leftKeys=[[0]], rightKeys=[[2]], joinType=[INNER])                                                                                                                                                                                                                                                         |
|           LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_REGION, SYS$CLUSTERED_INDEX$SUPPLIER$S_NATION, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]], residual columns=[[5]])                                                                            |
|             FennelValuesRel(tuples=[[{ '[', 'ASIA', ']', 'ASIA' }]])                                                                                                                                                                                                                                                          |
|           FennelReshapeRel(projection=[[1, 2, 3, 5]], outputRowType=[RecordType(INTEGER NOT NULL D_YEAR, VARCHAR(15) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_NATION, INTEGER NOT NULL LO_SUPPKEY, BIGINT LO_REVENUE) NOT NULL])                                                              |
|             LhxJoinRel(leftKeys=[[0]], rightKeys=[[2]], joinType=[INNER])                                                                                                                                                                                                                                                     |
|               LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                                                                          |
|                 FennelValuesRel(tuples=[[{ '[', 1992, ']', 1997 }]])                                                                                                                                                                                                                                                          |
|               FennelReshapeRel(projection=[[1, 3, 4, 5]], outputRowType=[RecordType(VARCHAR(15) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_NATION, INTEGER NOT NULL LO_SUPPKEY, INTEGER NOT NULL LO_ORDERDATE, BIGINT LO_REVENUE) NOT NULL])                                                    |
|                 LhxJoinRel(leftKeys=[[0]], rightKeys=[[0]], joinType=[INNER])                                                                                                                                                                                                                                                 |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, CUSTOMER]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$CUSTOMER$C_CUSTKEY, SYS$CLUSTERED_INDEX$CUSTOMER$C_NATION]])                                                                                                                                   |
|                     LcsIndexSearchRel(table=[[LOCALDB, SSB, CUSTOMER]], index=[C_REGION_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                   |
|                       FennelValuesRel(tuples=[[{ '[', 'ASIA', ']', 'ASIA' }]])                                                                                                                                                                                                                                                |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[2, 4, 5, 12]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_CUSTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_ORDERDATE, SYS$CLUSTERED_INDEX$LINEORDER$LO_REVENUE, SYS$CLUSTERED_INDEX$LINEORDER$LO_SUPPKEY]])                                |
|                     LcsIndexIntersectRel(startRidParamId=[2], rowLimitParamId=[3])                                                                                                                                                                                                                                            |
|                       LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[1])                                                                                                                                                                                                                 |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                   |
|                           FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                 |
|                             LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                                                               |
|                               FennelValuesRel(tuples=[[{ '[', 1992, ']', 1997 }]])                                                                                                                                                                                                                                            |
|                       LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[4])                                                                                                                                                                                                                 |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_SUPPKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                     |
|                           FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                 |
|                             LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_REGION, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]], residual columns=[[5]])                                                                                                    |
|                               FennelValuesRel(tuples=[[{ '[', 'ASIA', ']', 'ASIA' }]])                                                                                                                                                                                                                                        |
|                       LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[5])                                                                                                                                                                                                                 |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_CUSTKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                     |
|                           FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                 |
|                             LcsRowScanRel(table=[[LOCALDB, SSB, CUSTOMER]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$CUSTOMER$C_CUSTKEY]])                                                                                                                                                                   |
|                               LcsIndexSearchRel(table=[[LOCALDB, SSB, CUSTOMER]], index=[C_REGION_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                         |
|                                 FennelValuesRel(tuples=[[{ '[', 'ASIA', ']', 'ASIA' }]])                                                                                                                                                                                                                                      |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q3.2
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     c_city, s_city, d_year, sum(lo_revenue) as revenue
. . . . . . . . > from 
. . . . . . . . >     customer, lineorder, supplier, dates
. . . . . . . . > where 
. . . . . . . . >     lo_custkey = c_custkey
. . . . . . . . >     and lo_suppkey = s_suppkey
. . . . . . . . >     and lo_orderdate = d_datekey
. . . . . . . . >     and c_nation = 'UNITED STATES'
. . . . . . . . >     and s_nation = 'UNITED STATES'
. . . . . . . . >     and d_year >= 1992 and d_year <= 1997
. . . . . . . . > group by 
. . . . . . . . >     c_city, s_city, d_year
. . . . . . . . > order by 
. . . . . . . . >     d_year asc, revenue desc;
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                          column0                                                                                                                                                          |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                                                                                                 |
|   FennelSortRel(key=[[2, 3 Descending]], discardDuplicates=[false])                                                                                                                                                                                                                                                       |
|     LhxAggRel(groupCount=[3], REVENUE=[SUM($3)])                                                                                                                                                                                                                                                                          |
|       FennelReshapeRel(projection=[[3, 1, 2, 5]], outputRowType=[RecordType(VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_CITY, VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL S_CITY, INTEGER NOT NULL D_YEAR, BIGINT LO_REVENUE) NOT NULL])  |
|         LhxJoinRel(leftKeys=[[0]], rightKeys=[[2]], joinType=[INNER])                                                                                                                                                                                                                                                     |
|           FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[10])                                                                                                                                                                                                                                           |
|             LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_CITY, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]])                                                                                                                                       |
|               LcsIndexSearchRel(table=[[LOCALDB, SSB, SUPPLIER]], index=[S_NAITON_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                     |
|                 FennelValuesRel(tuples=[[{ '[', 'UNITED STATES', ']', 'UNITED STATES' }]])                                                                                                                                                                                                                                |
|           FennelReshapeRel(projection=[[1, 2, 3, 5]], outputRowType=[RecordType(INTEGER NOT NULL D_YEAR, VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_CITY, INTEGER NOT NULL LO_SUPPKEY, BIGINT LO_REVENUE) NOT NULL])                                                            |
|             LhxJoinRel(leftKeys=[[0]], rightKeys=[[2]], joinType=[INNER])                                                                                                                                                                                                                                                 |
|               LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                                                                      |
|                 FennelValuesRel(tuples=[[{ '[', 1992, ']', 1997 }]])                                                                                                                                                                                                                                                      |
|               FennelReshapeRel(projection=[[1, 3, 4, 5]], outputRowType=[RecordType(VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_CITY, INTEGER NOT NULL LO_SUPPKEY, INTEGER NOT NULL LO_ORDERDATE, BIGINT LO_REVENUE) NOT NULL])                                                  |
|                 LhxJoinRel(leftKeys=[[0]], rightKeys=[[0]], joinType=[INNER])                                                                                                                                                                                                                                             |
|                   FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[6])                                                                                                                                                                                                                                    |
|                     LcsRowScanRel(table=[[LOCALDB, SSB, CUSTOMER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$CUSTOMER$C_CITY, SYS$CLUSTERED_INDEX$CUSTOMER$C_CUSTKEY]])                                                                                                                               |
|                       LcsIndexSearchRel(table=[[LOCALDB, SSB, CUSTOMER]], index=[C_NAITON_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                             |
|                         FennelValuesRel(tuples=[[{ '[', 'UNITED STATES', ']', 'UNITED STATES' }]])                                                                                                                                                                                                                        |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[2, 4, 5, 12]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_CUSTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_ORDERDATE, SYS$CLUSTERED_INDEX$LINEORDER$LO_REVENUE, SYS$CLUSTERED_INDEX$LINEORDER$LO_SUPPKEY]])                            |
|                     LcsIndexIntersectRel(startRidParamId=[2], rowLimitParamId=[3])                                                                                                                                                                                                                                        |
|                       LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[1])                                                                                                                                                                                                             |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_SUPPKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                 |
|                           FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                             |
|                             FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL S_SUPPKEY) NOT NULL])                                                                                                                                                                                           |
|                               FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[10])                                                                                                                                                                                                                       |
|                                 LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_CITY, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]])                                                                                                                   |
|                                   LcsIndexSearchRel(table=[[LOCALDB, SSB, SUPPLIER]], index=[S_NAITON_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                 |
|                                     FennelValuesRel(tuples=[[{ '[', 'UNITED STATES', ']', 'UNITED STATES' }]])                                                                                                                                                                                                            |
|                       LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[4])                                                                                                                                                                                                             |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                               |
|                           FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                             |
|                             LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                                                           |
|                               FennelValuesRel(tuples=[[{ '[', 1992, ']', 1997 }]])                                                                                                                                                                                                                                        |
|                       LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[5])                                                                                                                                                                                                             |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_CUSTKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                 |
|                           FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                             |
|                             FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL C_CUSTKEY) NOT NULL])                                                                                                                                                                                           |
|                               FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[6])                                                                                                                                                                                                                        |
|                                 LcsRowScanRel(table=[[LOCALDB, SSB, CUSTOMER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$CUSTOMER$C_CITY, SYS$CLUSTERED_INDEX$CUSTOMER$C_CUSTKEY]])                                                                                                                   |
|                                   LcsIndexSearchRel(table=[[LOCALDB, SSB, CUSTOMER]], index=[C_NAITON_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                 |
|                                     FennelValuesRel(tuples=[[{ '[', 'UNITED STATES', ']', 'UNITED STATES' }]])                                                                                                                                                                                                            |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q3.3
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     c_city, s_city, d_year, sum(lo_revenue) as revenue
. . . . . . . . > from 
. . . . . . . . >     customer, lineorder, supplier, dates
. . . . . . . . > where 
. . . . . . . . >     lo_custkey = c_custkey
. . . . . . . . >     and lo_suppkey = s_suppkey
. . . . . . . . >     and lo_orderdate = d_datekey
. . . . . . . . >     and (c_city='UNITED KI1' or c_city='UNITED KI5')
. . . . . . . . >     and (s_city='UNITED KI1' or s_city='UNITED KI5')
. . . . . . . . >     and d_year >= 1992 and d_year <= 1997
. . . . . . . . > group by 
. . . . . . . . >     c_city, s_city, d_year
. . . . . . . . > order by 
. . . . . . . . >     d_year asc, revenue desc;
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                          column0                                                                                                                                                          |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                                                                                                 |
|   FennelSortRel(key=[[2, 3 Descending]], discardDuplicates=[false])                                                                                                                                                                                                                                                       |
|     LhxAggRel(groupCount=[3], REVENUE=[SUM($3)])                                                                                                                                                                                                                                                                          |
|       FennelReshapeRel(projection=[[3, 1, 2, 5]], outputRowType=[RecordType(VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_CITY, VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL S_CITY, INTEGER NOT NULL D_YEAR, BIGINT LO_REVENUE) NOT NULL])  |
|         LhxJoinRel(leftKeys=[[0]], rightKeys=[[2]], joinType=[INNER])                                                                                                                                                                                                                                                     |
|           FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[13])                                                                                                                                                                                                                                           |
|             LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_CITY, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]])                                                                                                                                       |
|               LcsIndexMergeRel(consumerSridParamId=[0], segmentLimitParamId=[0], ridLimitParamId=[7])                                                                                                                                                                                                                     |
|                 LcsIndexSearchRel(table=[[LOCALDB, SSB, SUPPLIER]], index=[S_CITY_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                     |
|                   FennelValuesRel(tuples=[[{ '[', 'UNITED KI1', ']', 'UNITED KI1' }, { '[', 'UNITED KI5', ']', 'UNITED KI5' }]])                                                                                                                                                                                          |
|           FennelReshapeRel(projection=[[1, 2, 3, 5]], outputRowType=[RecordType(INTEGER NOT NULL D_YEAR, VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_CITY, INTEGER NOT NULL LO_SUPPKEY, BIGINT LO_REVENUE) NOT NULL])                                                            |
|             LhxJoinRel(leftKeys=[[0]], rightKeys=[[2]], joinType=[INNER])                                                                                                                                                                                                                                                 |
|               LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                                                                      |
|                 FennelValuesRel(tuples=[[{ '[', 1992, ']', 1997 }]])                                                                                                                                                                                                                                                      |
|               FennelReshapeRel(projection=[[1, 3, 4, 5]], outputRowType=[RecordType(VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_CITY, INTEGER NOT NULL LO_SUPPKEY, INTEGER NOT NULL LO_ORDERDATE, BIGINT LO_REVENUE) NOT NULL])                                                  |
|                 LhxJoinRel(leftKeys=[[0]], rightKeys=[[0]], joinType=[INNER])                                                                                                                                                                                                                                             |
|                   FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[9])                                                                                                                                                                                                                                    |
|                     LcsRowScanRel(table=[[LOCALDB, SSB, CUSTOMER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$CUSTOMER$C_CITY, SYS$CLUSTERED_INDEX$CUSTOMER$C_CUSTKEY]])                                                                                                                               |
|                       LcsIndexMergeRel(consumerSridParamId=[0], segmentLimitParamId=[0], ridLimitParamId=[6])                                                                                                                                                                                                             |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, CUSTOMER]], index=[C_CITY_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                             |
|                           FennelValuesRel(tuples=[[{ '[', 'UNITED KI1', ']', 'UNITED KI1' }, { '[', 'UNITED KI5', ']', 'UNITED KI5' }]])                                                                                                                                                                                  |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[2, 4, 5, 12]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_CUSTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_ORDERDATE, SYS$CLUSTERED_INDEX$LINEORDER$LO_REVENUE, SYS$CLUSTERED_INDEX$LINEORDER$LO_SUPPKEY]])                            |
|                     LcsIndexIntersectRel(startRidParamId=[2], rowLimitParamId=[3])                                                                                                                                                                                                                                        |
|                       LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[1])                                                                                                                                                                                                             |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_SUPPKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                 |
|                           FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                             |
|                             FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL S_SUPPKEY) NOT NULL])                                                                                                                                                                                           |
|                               FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[13])                                                                                                                                                                                                                       |
|                                 LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_CITY, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]])                                                                                                                   |
|                                   LcsIndexMergeRel(consumerSridParamId=[0], segmentLimitParamId=[0], ridLimitParamId=[7])                                                                                                                                                                                                 |
|                                     LcsIndexSearchRel(table=[[LOCALDB, SSB, SUPPLIER]], index=[S_CITY_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                 |
|                                       FennelValuesRel(tuples=[[{ '[', 'UNITED KI1', ']', 'UNITED KI1' }, { '[', 'UNITED KI5', ']', 'UNITED KI5' }]])                                                                                                                                                                      |
|                       LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[5])                                                                                                                                                                                                             |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_CUSTKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                 |
|                           FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                             |
|                             FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL C_CUSTKEY) NOT NULL])                                                                                                                                                                                           |
|                               FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[9])                                                                                                                                                                                                                        |
|                                 LcsRowScanRel(table=[[LOCALDB, SSB, CUSTOMER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$CUSTOMER$C_CITY, SYS$CLUSTERED_INDEX$CUSTOMER$C_CUSTKEY]])                                                                                                                   |
|                                   LcsIndexMergeRel(consumerSridParamId=[0], segmentLimitParamId=[0], ridLimitParamId=[6])                                                                                                                                                                                                 |
|                                     LcsIndexSearchRel(table=[[LOCALDB, SSB, CUSTOMER]], index=[C_CITY_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                 |
|                                       FennelValuesRel(tuples=[[{ '[', 'UNITED KI1', ']', 'UNITED KI1' }, { '[', 'UNITED KI5', ']', 'UNITED KI5' }]])                                                                                                                                                                      |
|                       LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[4])                                                                                                                                                                                                             |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                               |
|                           FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                             |
|                             LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                                                           |
|                               FennelValuesRel(tuples=[[{ '[', 1992, ']', 1997 }]])                                                                                                                                                                                                                                        |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q3.4
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     c_city, s_city, d_year, sum(lo_revenue) as revenue
. . . . . . . . > from 
. . . . . . . . >     customer, lineorder, supplier, dates
. . . . . . . . > where 
. . . . . . . . >     lo_custkey = c_custkey
. . . . . . . . >     and lo_suppkey = s_suppkey
. . . . . . . . >     and lo_orderdate = d_datekey
. . . . . . . . >     and (c_city='UNITED KI1' or c_city='UNITED KI5')
. . . . . . . . >     and (s_city='UNITED KI1' or s_city='UNITED KI5')
. . . . . . . . >     and d_yearmonth = 'Dec1997'
. . . . . . . . > group by 
. . . . . . . . >     c_city, s_city, d_year
. . . . . . . . > order by 
. . . . . . . . >     d_year asc, revenue desc;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                               column0                                                                                                                                                               |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                                                                                                           |
|   FennelSortRel(key=[[2, 3 Descending]], discardDuplicates=[false])                                                                                                                                                                                                                                                                 |
|     LhxAggRel(groupCount=[3], REVENUE=[SUM($3)])                                                                                                                                                                                                                                                                                    |
|       FennelReshapeRel(projection=[[3, 2, 1, 5]], outputRowType=[RecordType(VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_CITY, VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL S_CITY, INTEGER NOT NULL D_YEAR, BIGINT LO_REVENUE) NOT NULL])            |
|         LhxJoinRel(leftKeys=[[0]], rightKeys=[[2]], joinType=[INNER])                                                                                                                                                                                                                                                               |
|           FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[10])                                                                                                                                                                                                                                                     |
|             LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_DATEKEY, SYS$CLUSTERED_INDEX$DATES$D_YEAR]])                                                                                                                                                          |
|               LcsIndexSearchRel(table=[[LOCALDB, SSB, DATES]], index=[D_YEARMONTH_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                               |
|                 FennelValuesRel(tuples=[[{ '[', 'Dec1997', ']', 'Dec1997' }]])                                                                                                                                                                                                                                                      |
|           FennelReshapeRel(projection=[[1, 2, 4, 5]], outputRowType=[RecordType(VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL S_CITY, VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_CITY, INTEGER NOT NULL LO_ORDERDATE, BIGINT LO_REVENUE) NOT NULL])  |
|             LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                                                                                                           |
|               FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[7])                                                                                                                                                                                                                                                  |
|                 LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_CITY, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]])                                                                                                                                             |
|                   LcsIndexMergeRel(consumerSridParamId=[0], segmentLimitParamId=[0], ridLimitParamId=[5])                                                                                                                                                                                                                           |
|                     LcsIndexSearchRel(table=[[LOCALDB, SSB, SUPPLIER]], index=[S_CITY_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                           |
|                       FennelValuesRel(tuples=[[{ '[', 'UNITED KI1', ']', 'UNITED KI1' }, { '[', 'UNITED KI5', ']', 'UNITED KI5' }]])                                                                                                                                                                                                |
|               FennelReshapeRel(projection=[[1, 3, 4, 5]], outputRowType=[RecordType(VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL C_CITY, INTEGER NOT NULL LO_SUPPKEY, INTEGER NOT NULL LO_ORDERDATE, BIGINT LO_REVENUE) NOT NULL])                                                            |
|                 LhxJoinRel(leftKeys=[[0]], rightKeys=[[0]], joinType=[INNER])                                                                                                                                                                                                                                                       |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, CUSTOMER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$CUSTOMER$C_CITY, SYS$CLUSTERED_INDEX$CUSTOMER$C_CUSTKEY]])                                                                                                                                           |
|                     LcsIndexMergeRel(consumerSridParamId=[0], segmentLimitParamId=[0], ridLimitParamId=[6])                                                                                                                                                                                                                         |
|                       LcsIndexSearchRel(table=[[LOCALDB, SSB, CUSTOMER]], index=[C_CITY_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                         |
|                         FennelValuesRel(tuples=[[{ '[', 'UNITED KI1', ']', 'UNITED KI1' }, { '[', 'UNITED KI5', ']', 'UNITED KI5' }]])                                                                                                                                                                                              |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[2, 4, 5, 12]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_CUSTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_ORDERDATE, SYS$CLUSTERED_INDEX$LINEORDER$LO_REVENUE, SYS$CLUSTERED_INDEX$LINEORDER$LO_SUPPKEY]])                                      |
|                     LcsIndexIntersectRel(startRidParamId=[2], rowLimitParamId=[3])                                                                                                                                                                                                                                                  |
|                       LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[1])                                                                                                                                                                                                                       |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                         |
|                           FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                       |
|                             FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL D_DATEKEY) NOT NULL])                                                                                                                                                                                                     |
|                               FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[10])                                                                                                                                                                                                                                 |
|                                 LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_DATEKEY, SYS$CLUSTERED_INDEX$DATES$D_YEAR]])                                                                                                                                      |
|                                   LcsIndexSearchRel(table=[[LOCALDB, SSB, DATES]], index=[D_YEARMONTH_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                           |
|                                     FennelValuesRel(tuples=[[{ '[', 'Dec1997', ']', 'Dec1997' }]])                                                                                                                                                                                                                                  |
|                       LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[4])                                                                                                                                                                                                                       |
|                         LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_SUPPKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                           |
|                           FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                       |
|                             FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL S_SUPPKEY) NOT NULL])                                                                                                                                                                                                     |
|                               FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[7])                                                                                                                                                                                                                                  |
|                                 LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_CITY, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]])                                                                                                                             |
|                                   LcsIndexMergeRel(consumerSridParamId=[0], segmentLimitParamId=[0], ridLimitParamId=[5])                                                                                                                                                                                                           |
|                                     LcsIndexSearchRel(table=[[LOCALDB, SSB, SUPPLIER]], index=[S_CITY_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                           |
|                                       FennelValuesRel(tuples=[[{ '[', 'UNITED KI1', ']', 'UNITED KI1' }, { '[', 'UNITED KI5', ']', 'UNITED KI5' }]])                                                                                                                                                                                |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q4.1
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     d_year, c_nation,
. . . . . . . . >     sum(lo_revenue - lo_supplycost) as profit
. . . . . . . . > from 
. . . . . . . . >     dates, customer, supplier, part, lineorder
. . . . . . . . > where 
. . . . . . . . >     lo_custkey = c_custkey
. . . . . . . . >     and lo_suppkey = s_suppkey
. . . . . . . . >     and lo_partkey = p_partkey
. . . . . . . . >     and lo_orderdate = d_datekey
. . . . . . . . >     and c_region = 'AMERICA'
. . . . . . . . >     and s_region = 'AMERICA'
. . . . . . . . >     and (p_mfgr = 'MFGR#1' or p_mfgr = 'MFGR#2')
. . . . . . . . > group by 
. . . . . . . . >     d_year, c_nation
. . . . . . . . > order by 
. . . . . . . . >     d_year, c_nation;
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                       column0                                                                                                                                                                        |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                                                                                                                            |
|   FennelSortRel(key=[[0, 1]], discardDuplicates=[false])                                                                                                                                                                                                                                                                                             |
|     LhxAggRel(groupCount=[2], PROFIT=[SUM($2)])                                                                                                                                                                                                                                                                                                      |
|       IteratorToFennelConverter                                                                                                                                                                                                                                                                                                                      |
|         IterCalcRel(expr#0..5=[{inputs}], expr#6=[-($t4, $t5)], D_YEAR=[$t2], C_NATION=[$t1], $f2=[$t6])                                                                                                                                                                                                                                             |
|           FennelToIteratorConverter                                                                                                                                                                                                                                                                                                                  |
|             LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                                                                                                                            |
|               LcsRowScanRel(table=[[LOCALDB, SSB, CUSTOMER]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$CUSTOMER$C_CUSTKEY, SYS$CLUSTERED_INDEX$CUSTOMER$C_NATION]])                                                                                                                                                              |
|                 LcsIndexSearchRel(table=[[LOCALDB, SSB, CUSTOMER]], index=[C_REGION_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                                              |
|                   FennelValuesRel(tuples=[[{ '[', 'AMERICA', ']', 'AMERICA' }]])                                                                                                                                                                                                                                                                     |
|               FennelReshapeRel(projection=[[1, 2, 4, 5]], outputRowType=[RecordType(INTEGER NOT NULL D_YEAR, INTEGER NOT NULL LO_CUSTKEY, BIGINT LO_REVENUE, BIGINT LO_SUPPLYCOST) NOT NULL])                                                                                                                                                        |
|                 LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                                                                                                                        |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_DATEKEY, SYS$CLUSTERED_INDEX$DATES$D_YEAR]])                                                                                                                                                                     |
|                   FennelReshapeRel(projection=[[1, 3, 4, 5]], outputRowType=[RecordType(INTEGER NOT NULL LO_CUSTKEY, INTEGER NOT NULL LO_ORDERDATE, BIGINT LO_REVENUE, BIGINT LO_SUPPLYCOST) NOT NULL])                                                                                                                                              |
|                     LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                                                                                                                    |
|                       LcsRowScanRel(table=[[LOCALDB, SSB, PART]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$PART$P_MFGR, SYS$CLUSTERED_INDEX$PART$P_PARTKEY]], residual columns=[[2]])                                                                                                                                               |
|                         FennelValuesRel(tuples=[[{ '[', 'MFGR#1', ']', 'MFGR#1' }, { '[', 'MFGR#2', ']', 'MFGR#2' }]])                                                                                                                                                                                                                               |
|                       LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[2, 3, 5, 12, 13]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_CUSTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_ORDERDATE, SYS$CLUSTERED_INDEX$LINEORDER$LO_PARTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_REVENUE, SYS$CLUSTERED_INDEX$LINEORDER$LO_SUPPLYCOST]])  |
|                         LcsIndexIntersectRel(startRidParamId=[2], rowLimitParamId=[3])                                                                                                                                                                                                                                                               |
|                           LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[1])                                                                                                                                                                                                                                    |
|                             LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                                      |
|                               FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                                    |
|                                 LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]])                                                                                                                                                                                            |
|                           LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[4])                                                                                                                                                                                                                                    |
|                             LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_SUPPKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                                        |
|                               FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                                    |
|                                 LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_REGION, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]], residual columns=[[5]])                                                                                                                       |
|                                   FennelValuesRel(tuples=[[{ '[', 'AMERICA', ']', 'AMERICA' }]])                                                                                                                                                                                                                                                     |
|                           LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[5])                                                                                                                                                                                                                                    |
|                             LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_CUSTKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                                        |
|                               FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                                    |
|                                 LcsRowScanRel(table=[[LOCALDB, SSB, CUSTOMER]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$CUSTOMER$C_CUSTKEY]])                                                                                                                                                                                      |
|                                   LcsIndexSearchRel(table=[[LOCALDB, SSB, CUSTOMER]], index=[C_REGION_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                            |
|                                     FennelValuesRel(tuples=[[{ '[', 'AMERICA', ']', 'AMERICA' }]])                                                                                                                                                                                                                                                   |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q4.2
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     d_year, s_nation, p_category,
. . . . . . . . >     sum(lo_revenue - lo_supplycost) as profit
. . . . . . . . > from 
. . . . . . . . >     dates, customer, supplier, part, lineorder
. . . . . . . . > where 
. . . . . . . . >     lo_custkey = c_custkey
. . . . . . . . >     and lo_suppkey = s_suppkey
. . . . . . . . >     and lo_partkey = p_partkey
. . . . . . . . >     and lo_orderdate = d_datekey
. . . . . . . . >     and c_region = 'AMERICA'
. . . . . . . . >     and s_region = 'AMERICA'
. . . . . . . . >     and (d_year = 1997 or d_year = 1998)
. . . . . . . . >     and (p_mfgr = 'MFGR#1' or p_mfgr = 'MFGR#2')
. . . . . . . . > group by 
. . . . . . . . >     d_year, s_nation, p_category
. . . . . . . . > order by 
. . . . . . . . >     d_year, s_nation, p_category;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                column0                                                                                                                                                                                                |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                                                                                                                                                                             |
|   FennelSortRel(key=[[0, 1, 2]], discardDuplicates=[false])                                                                                                                                                                                                                                                                                                                                           |
|     LhxAggRel(groupCount=[3], PROFIT=[SUM($3)])                                                                                                                                                                                                                                                                                                                                                       |
|       IteratorToFennelConverter                                                                                                                                                                                                                                                                                                                                                                       |
|         IterCalcRel(expr#0..6=[{inputs}], expr#7=[-($t5, $t6)], D_YEAR=[$t3], S_NATION=[$t1], P_CATEGORY=[$t2], $f3=[$t7])                                                                                                                                                                                                                                                                            |
|           FennelToIteratorConverter                                                                                                                                                                                                                                                                                                                                                                   |
|             LhxJoinRel(leftKeys=[[0]], rightKeys=[[2]], joinType=[INNER])                                                                                                                                                                                                                                                                                                                             |
|               LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_REGION, SYS$CLUSTERED_INDEX$SUPPLIER$S_NATION, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]], residual columns=[[5]])                                                                                                                                                |
|                 FennelValuesRel(tuples=[[{ '[', 'AMERICA', ']', 'AMERICA' }]])                                                                                                                                                                                                                                                                                                                        |
|               FennelReshapeRel(projection=[[1, 2, 4, 5, 6]], outputRowType=[RecordType(VARCHAR(7) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL P_CATEGORY, INTEGER NOT NULL D_YEAR, INTEGER NOT NULL LO_SUPPKEY, BIGINT LO_REVENUE, BIGINT LO_SUPPLYCOST) NOT NULL])                                                                                                        |
|                 LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                                                                                                                                                                         |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, PART]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$PART$P_MFGR, SYS$CLUSTERED_INDEX$PART$P_CATEGORY, SYS$CLUSTERED_INDEX$PART$P_PARTKEY]], residual columns=[[2]])                                                                                                                                                            |
|                     FennelValuesRel(tuples=[[{ '[', 'MFGR#1', ']', 'MFGR#1' }, { '[', 'MFGR#2', ']', 'MFGR#2' }]])                                                                                                                                                                                                                                                                                    |
|                   FennelReshapeRel(projection=[[1, 2, 3, 5, 6]], outputRowType=[RecordType(INTEGER NOT NULL D_YEAR, INTEGER NOT NULL LO_PARTKEY, INTEGER NOT NULL LO_SUPPKEY, BIGINT LO_REVENUE, BIGINT LO_SUPPLYCOST) NOT NULL])                                                                                                                                                                     |
|                     LhxJoinRel(leftKeys=[[0]], rightKeys=[[2]], joinType=[INNER])                                                                                                                                                                                                                                                                                                                     |
|                       FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[7])                                                                                                                                                                                                                                                                                                            |
|                         LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                                                                                                                                        |
|                           FennelValuesRel(tuples=[[{ '[', 1997, ']', 1997 }, { '[', 1998, ']', 1998 }]])                                                                                                                                                                                                                                                                                              |
|                       FennelReshapeRel(projection=[[2, 3, 4, 5, 6]], outputRowType=[RecordType(INTEGER NOT NULL LO_PARTKEY, INTEGER NOT NULL LO_SUPPKEY, INTEGER NOT NULL LO_ORDERDATE, BIGINT LO_REVENUE, BIGINT LO_SUPPLYCOST) NOT NULL])                                                                                                                                                           |
|                         LhxJoinRel(leftKeys=[[0]], rightKeys=[[0]], joinType=[INNER])                                                                                                                                                                                                                                                                                                                 |
|                           LcsRowScanRel(table=[[LOCALDB, SSB, CUSTOMER]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$CUSTOMER$C_CUSTKEY]])                                                                                                                                                                                                                                             |
|                             LcsIndexSearchRel(table=[[LOCALDB, SSB, CUSTOMER]], index=[C_REGION_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                                                                                   |
|                               FennelValuesRel(tuples=[[{ '[', 'AMERICA', ']', 'AMERICA' }]])                                                                                                                                                                                                                                                                                                          |
|                           LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[2, 3, 4, 5, 12, 13]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_CUSTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_ORDERDATE, SYS$CLUSTERED_INDEX$LINEORDER$LO_PARTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_REVENUE, SYS$CLUSTERED_INDEX$LINEORDER$LO_SUPPKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_SUPPLYCOST]])  |
|                             LcsIndexIntersectRel(startRidParamId=[2], rowLimitParamId=[3])                                                                                                                                                                                                                                                                                                            |
|                               LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[1])                                                                                                                                                                                                                                                                                 |
|                                 LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                                                                                   |
|                                   FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                                                                                 |
|                                     FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL D_DATEKEY) NOT NULL])                                                                                                                                                                                                                                                               |
|                                       FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[7])                                                                                                                                                                                                                                                                                            |
|                                         LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                                                                                                                        |
|                                           FennelValuesRel(tuples=[[{ '[', 1997, ']', 1997 }, { '[', 1998, ']', 1998 }]])                                                                                                                                                                                                                                                                              |
|                               LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[4])                                                                                                                                                                                                                                                                                 |
|                                 LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_SUPPKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                                                                                     |
|                                   FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                                                                                 |
|                                     LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_REGION, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]], residual columns=[[5]])                                                                                                                                                                    |
|                                       FennelValuesRel(tuples=[[{ '[', 'AMERICA', ']', 'AMERICA' }]])                                                                                                                                                                                                                                                                                                  |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> 
0: jdbc:luciddb:> --Q4.3
0: jdbc:luciddb:> explain plan for
. . . . . . . . > select 
. . . . . . . . >     d_year, s_city, p_brand,
. . . . . . . . >     sum(lo_revenue - lo_supplycost) as profit
. . . . . . . . > from 
. . . . . . . . >     dates, customer, supplier, part, lineorder
. . . . . . . . > where 
. . . . . . . . >     lo_custkey = c_custkey
. . . . . . . . >     and lo_suppkey = s_suppkey
. . . . . . . . >     and lo_partkey = p_partkey
. . . . . . . . >     and lo_orderdate = d_datekey
. . . . . . . . >     and s_nation = 'UNITED STATES'
. . . . . . . . >     and (d_year = 1997 or d_year = 1998)
. . . . . . . . >     and p_category = 'MFGR#14'
. . . . . . . . > group by 
. . . . . . . . >     d_year, s_city, p_brand
. . . . . . . . > order by 
. . . . . . . . >     d_year, s_city, p_brand;
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                column0                                                                                                                                                                                                |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FennelToIteratorConverter                                                                                                                                                                                                                                                                                                                                                                             |
|   FennelSortRel(key=[[0, 1, 2]], discardDuplicates=[false])                                                                                                                                                                                                                                                                                                                                           |
|     LhxAggRel(groupCount=[3], PROFIT=[SUM($3)])                                                                                                                                                                                                                                                                                                                                                       |
|       IteratorToFennelConverter                                                                                                                                                                                                                                                                                                                                                                       |
|         IterCalcRel(expr#0..6=[{inputs}], expr#7=[-($t5, $t6)], D_YEAR=[$t1], S_CITY=[$t3], P_BRAND=[$t2], $f3=[$t7])                                                                                                                                                                                                                                                                                 |
|           FennelToIteratorConverter                                                                                                                                                                                                                                                                                                                                                                   |
|             LhxJoinRel(leftKeys=[[0]], rightKeys=[[2]], joinType=[INNER])                                                                                                                                                                                                                                                                                                                             |
|               FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[6])                                                                                                                                                                                                                                                                                                                    |
|                 LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                                                                                                                                                |
|                   FennelValuesRel(tuples=[[{ '[', 1997, ']', 1997 }, { '[', 1998, ']', 1998 }]])                                                                                                                                                                                                                                                                                                      |
|               FennelReshapeRel(projection=[[1, 2, 4, 5, 6]], outputRowType=[RecordType(VARCHAR(9) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL P_BRAND, VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL S_CITY, INTEGER NOT NULL LO_ORDERDATE, BIGINT LO_REVENUE, BIGINT LO_SUPPLYCOST) NOT NULL])                                       |
|                 LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                                                                                                                                                                         |
|                   LcsRowScanRel(table=[[LOCALDB, SSB, PART]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$PART$P_CATEGORY, SYS$CLUSTERED_INDEX$PART$P_BRAND, SYS$CLUSTERED_INDEX$PART$P_PARTKEY]], residual columns=[[3]])                                                                                                                                                           |
|                     FennelValuesRel(tuples=[[{ '[', 'MFGR#14', ']', 'MFGR#14' }]])                                                                                                                                                                                                                                                                                                                    |
|                   FennelReshapeRel(projection=[[1, 2, 4, 5, 6]], outputRowType=[RecordType(VARCHAR(10) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL S_CITY, INTEGER NOT NULL LO_PARTKEY, INTEGER NOT NULL LO_ORDERDATE, BIGINT LO_REVENUE, BIGINT LO_SUPPLYCOST) NOT NULL])                                                                                                 |
|                     LhxJoinRel(leftKeys=[[0]], rightKeys=[[1]], joinType=[INNER])                                                                                                                                                                                                                                                                                                                     |
|                       FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[5])                                                                                                                                                                                                                                                                                                            |
|                         LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_CITY, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]])                                                                                                                                                                                                       |
|                           LcsIndexSearchRel(table=[[LOCALDB, SSB, SUPPLIER]], index=[S_NAITON_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                                                                                     |
|                             FennelValuesRel(tuples=[[{ '[', 'UNITED STATES', ']', 'UNITED STATES' }]])                                                                                                                                                                                                                                                                                                |
|                       FennelReshapeRel(projection=[[2, 3, 4, 5, 6]], outputRowType=[RecordType(INTEGER NOT NULL LO_PARTKEY, INTEGER NOT NULL LO_SUPPKEY, INTEGER NOT NULL LO_ORDERDATE, BIGINT LO_REVENUE, BIGINT LO_SUPPLYCOST) NOT NULL])                                                                                                                                                           |
|                         LhxJoinRel(leftKeys=[[0]], rightKeys=[[0]], joinType=[INNER])                                                                                                                                                                                                                                                                                                                 |
|                           LcsRowScanRel(table=[[LOCALDB, SSB, CUSTOMER]], projection=[[0]], clustered indexes=[[SYS$CLUSTERED_INDEX$CUSTOMER$C_CUSTKEY]])                                                                                                                                                                                                                                             |
|                           LcsRowScanRel(table=[[LOCALDB, SSB, LINEORDER]], projection=[[2, 3, 4, 5, 12, 13]], clustered indexes=[[SYS$CLUSTERED_INDEX$LINEORDER$LO_CUSTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_ORDERDATE, SYS$CLUSTERED_INDEX$LINEORDER$LO_PARTKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_REVENUE, SYS$CLUSTERED_INDEX$LINEORDER$LO_SUPPKEY, SYS$CLUSTERED_INDEX$LINEORDER$LO_SUPPLYCOST]])  |
|                             LcsIndexIntersectRel(startRidParamId=[2], rowLimitParamId=[3])                                                                                                                                                                                                                                                                                                            |
|                               LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[1])                                                                                                                                                                                                                                                                                 |
|                                 LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_ORDERDATE_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                                                                                   |
|                                   FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                                                                                 |
|                                     FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL D_DATEKEY) NOT NULL])                                                                                                                                                                                                                                                               |
|                                       FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[6])                                                                                                                                                                                                                                                                                            |
|                                         LcsRowScanRel(table=[[LOCALDB, SSB, DATES]], projection=[[0, 4]], clustered indexes=[[SYS$CLUSTERED_INDEX$DATES$D_YEAR, SYS$CLUSTERED_INDEX$DATES$D_DATEKEY]], residual columns=[[4]])                                                                                                                                                                        |
|                                           FennelValuesRel(tuples=[[{ '[', 1997, ']', 1997 }, { '[', 1998, ']', 1998 }]])                                                                                                                                                                                                                                                                              |
|                               LcsIndexMergeRel(consumerSridParamId=[2], segmentLimitParamId=[3], ridLimitParamId=[4])                                                                                                                                                                                                                                                                                 |
|                                 LcsIndexSearchRel(table=[[LOCALDB, SSB, LINEORDER]], index=[LO_SUPPKEY_IDX], projection=[*], inputKeyProj=[*], inputDirectiveProj=[[]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                                                                                     |
|                                   FennelSortRel(key=[[0]], discardDuplicates=[false])                                                                                                                                                                                                                                                                                                                 |
|                                     FennelReshapeRel(projection=[[0]], outputRowType=[RecordType(INTEGER NOT NULL S_SUPPKEY) NOT NULL])                                                                                                                                                                                                                                                               |
|                                       FennelMultiUseBufferRel(inMemory=[false], readerRefCountParamId=[5])                                                                                                                                                                                                                                                                                            |
|                                         LcsRowScanRel(table=[[LOCALDB, SSB, SUPPLIER]], projection=[[0, 3]], clustered indexes=[[SYS$CLUSTERED_INDEX$SUPPLIER$S_CITY, SYS$CLUSTERED_INDEX$SUPPLIER$S_SUPPKEY]])                                                                                                                                                                                       |
|                                           LcsIndexSearchRel(table=[[LOCALDB, SSB, SUPPLIER]], index=[S_NAITON_IDX], projection=[*], inputKeyProj=[[1, 3]], inputDirectiveProj=[[0, 2]], startRidParamId=[0], rowLimitParamId=[0])                                                                                                                                                                     |
|                                             FennelValuesRel(tuples=[[{ '[', 'UNITED STATES', ']', 'UNITED STATES' }]])                                                                                                                                                                                                                                                                                |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> !quit
