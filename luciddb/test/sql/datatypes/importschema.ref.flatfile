0: jdbc:luciddb:> set schema 's';
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- Import with Limit to qualification
0: jdbc:luciddb:> import foreign schema "BCP"
. . . . . . . . > LIMIT TO TABLE_NAME like 'typ%' 
. . . . . . . . > from server FF_SERVER 
. . . . . . . . > into FF_is_schema;
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- Check import of column names and datatypes
0: jdbc:luciddb:> !metadata getColumns LOCALDB FF_IS_SCHEMA % null
+------------+---------------+-------------+--------------+------------+------------+--------------+-------------+-------------+-----------------+-----------+----------+-------------+----------------+-------------------+--------------------+-------------------+--------------+----------------+---------------+--------------+-------------------+
| TABLE_CAT  |  TABLE_SCHEM  | TABLE_NAME  | COLUMN_NAME  | DATA_TYPE  | TYPE_NAME  | COLUMN_SIZE  | BUFFER_LEN  | DEC_DIGITS  | NUM_PREC_RADIX  | NULLABLE  | REMARKS  | COLUMN_DEF  | SQL_DATA_TYPE  | SQL_DATETIME_SUB  | CHAR_OCTET_LENGTH  | ORDINAL_POSITION  | IS_NULLABLE  | SCOPE_CATALOG  | SCOPE_SCHEMA  | SCOPE_TABLE  | SOURCE_DATA_TYPE  |
+------------+---------------+-------------+--------------+------------+------------+--------------+-------------+-------------+-----------------+-----------+----------+-------------+----------------+-------------------+--------------------+-------------------+--------------+----------------+---------------+--------------+-------------------+
| LOCALDB    | FF_IS_SCHEMA  | types       | c_char       | 1          | CHAR       | 10           | 0           |             |                 | 1         |          |             | 0              | 0                 | 10                 | 1                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_varchar    | 12         | VARCHAR    | 10           | 0           |             |                 | 1         |          |             | 0              | 0                 | 10                 | 2                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_decimal    | 3          | DECIMAL    | 10           | 0           | 0           |                 | 1         |          |             | 0              | 0                 |                    | 3                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_tinyint    | -6         | TINYINT    |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 4                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_smallint   | 5          | SMALLINT   |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 5                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_integer    | 4          | INTEGER    |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 6                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_bigint     | -5         | BIGINT     |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 7                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_real       | 7          | REAL       |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 8                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_double     | 8          | DOUBLE     |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 9                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_boolean    | 16         | BOOLEAN    |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 10                | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_date       | 93         | TIMESTAMP  | 0            | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 11                | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_time       | 93         | TIMESTAMP  | 0            | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 12                | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_timestamp  | 93         | TIMESTAMP  | 0            | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 13                | YES          |                |               |              |                   |
+------------+---------------+-------------+--------------+------------+------------+--------------+-------------+-------------+-----------------+-----------+----------+-------------+----------------+-------------------+--------------------+-------------------+--------------+----------------+---------------+--------------+-------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- 2nd select should fail
0: jdbc:luciddb:> select * from FF_is_schema."types";
Error: FennelResource.en_US.noRowsReturned(/home/elin/open/luciddb/test/sql/datatypes/types.csv, could not calculate results for the following row:
[ 'thisChar05', 'varchar-05', '123.123', '127', '32767', '2147483647', '9223372036854775807', '2.78', '3.1415161718', 'TRUE', '2005-10-12', '12:00:00', '2005-10-12 12:00:00' ]
Messages:
[0]:PC=14 Code=22007 ) (state=,code=0)
0: jdbc:luciddb:> select * from FF_is_schema."blob"; 
Error: From line 1, column 15 to line 1, column 26: Table 'FF_IS_SCHEMA.blob' not found (state=,code=0)
0: jdbc:luciddb:> 
0: jdbc:luciddb:> drop schema FF_is_schema cascade;
0: jdbc:luciddb:> create schema FF_is_schema;
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- Import with Except qualification
0: jdbc:luciddb:> import foreign schema "BCP"
. . . . . . . . > EXCEPT TABLE_NAME like 'blob'
. . . . . . . . > from server FF_SERVER
. . . . . . . . > into FF_is_schema;
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- Check import of tables
0: jdbc:luciddb:> !metadata getTables LOCALDB FF_IS_SCHEMA % null
+------------+---------------+-------------+----------------+----------+-----------+-------------+------------+----------------------------+-----------------+
| TABLE_CAT  |  TABLE_SCHEM  | TABLE_NAME  |   TABLE_TYPE   | REMARKS  | TYPE_CAT  | TYPE_SCHEM  | TYPE_NAME  | SELF_REFERENCING_COL_NAME  | REF_GENERATION  |
+------------+---------------+-------------+----------------+----------+-----------+-------------+------------+----------------------------+-----------------+
| LOCALDB    | FF_IS_SCHEMA  | types       | FOREIGN TABLE  |          |           |             |            |                            |                 |
+------------+---------------+-------------+----------------+----------+-----------+-------------+------------+----------------------------+-----------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- Check import of column names and data types for types table
0: jdbc:luciddb:> !metadata getColumns LOCALDB FF_IS_SCHEMA "types" null
+------------+---------------+-------------+--------------+------------+------------+--------------+-------------+-------------+-----------------+-----------+----------+-------------+----------------+-------------------+--------------------+-------------------+--------------+----------------+---------------+--------------+-------------------+
| TABLE_CAT  |  TABLE_SCHEM  | TABLE_NAME  | COLUMN_NAME  | DATA_TYPE  | TYPE_NAME  | COLUMN_SIZE  | BUFFER_LEN  | DEC_DIGITS  | NUM_PREC_RADIX  | NULLABLE  | REMARKS  | COLUMN_DEF  | SQL_DATA_TYPE  | SQL_DATETIME_SUB  | CHAR_OCTET_LENGTH  | ORDINAL_POSITION  | IS_NULLABLE  | SCOPE_CATALOG  | SCOPE_SCHEMA  | SCOPE_TABLE  | SOURCE_DATA_TYPE  |
+------------+---------------+-------------+--------------+------------+------------+--------------+-------------+-------------+-----------------+-----------+----------+-------------+----------------+-------------------+--------------------+-------------------+--------------+----------------+---------------+--------------+-------------------+
| LOCALDB    | FF_IS_SCHEMA  | types       | c_char       | 1          | CHAR       | 10           | 0           |             |                 | 1         |          |             | 0              | 0                 | 10                 | 1                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_varchar    | 12         | VARCHAR    | 10           | 0           |             |                 | 1         |          |             | 0              | 0                 | 10                 | 2                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_decimal    | 3          | DECIMAL    | 10           | 0           | 0           |                 | 1         |          |             | 0              | 0                 |                    | 3                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_tinyint    | -6         | TINYINT    |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 4                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_smallint   | 5          | SMALLINT   |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 5                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_integer    | 4          | INTEGER    |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 6                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_bigint     | -5         | BIGINT     |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 7                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_real       | 7          | REAL       |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 8                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_double     | 8          | DOUBLE     |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 9                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_boolean    | 16         | BOOLEAN    |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 10                | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_date       | 93         | TIMESTAMP  | 0            | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 11                | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_time       | 93         | TIMESTAMP  | 0            | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 12                | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_timestamp  | 93         | TIMESTAMP  | 0            | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 13                | YES          |                |               |              |                   |
+------------+---------------+-------------+--------------+------------+------------+--------------+-------------+-------------+-----------------+-----------+----------+-------------+----------------+-------------------+--------------------+-------------------+--------------+----------------+---------------+--------------+-------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- 2nd select should fail
0: jdbc:luciddb:> select * from FF_is_schema."types";
Error: FennelResource.en_US.noRowsReturned(/home/elin/open/luciddb/test/sql/datatypes/types.csv, could not calculate results for the following row:
[ 'thisChar05', 'varchar-05', '123.123', '127', '32767', '2147483647', '9223372036854775807', '2.78', '3.1415161718', 'TRUE', '2005-10-12', '12:00:00', '2005-10-12 12:00:00' ]
Messages:
[0]:PC=14 Code=22007 ) (state=,code=0)
0: jdbc:luciddb:> select * from FF_is_schema."blob";
Error: From line 1, column 15 to line 1, column 26: Table 'FF_IS_SCHEMA.blob' not found (state=,code=0)
0: jdbc:luciddb:> 
0: jdbc:luciddb:> drop schema FF_is_schema cascade;
0: jdbc:luciddb:> create schema FF_is_schema;
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- Import with explicit list of tables
0: jdbc:luciddb:> import foreign schema "BCP"
. . . . . . . . > LIMIT to ("blob", "types")
. . . . . . . . > from server FF_SERVER
. . . . . . . . > into FF_is_schema;
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- Check import of table names, column names and data types
0: jdbc:luciddb:> !metadata getColumns LOCALDB FF_IS_SCHEMA % null
+------------+---------------+-------------+--------------+------------+------------+--------------+-------------+-------------+-----------------+-----------+----------+-------------+----------------+-------------------+--------------------+-------------------+--------------+----------------+---------------+--------------+-------------------+
| TABLE_CAT  |  TABLE_SCHEM  | TABLE_NAME  | COLUMN_NAME  | DATA_TYPE  | TYPE_NAME  | COLUMN_SIZE  | BUFFER_LEN  | DEC_DIGITS  | NUM_PREC_RADIX  | NULLABLE  | REMARKS  | COLUMN_DEF  | SQL_DATA_TYPE  | SQL_DATETIME_SUB  | CHAR_OCTET_LENGTH  | ORDINAL_POSITION  | IS_NULLABLE  | SCOPE_CATALOG  | SCOPE_SCHEMA  | SCOPE_TABLE  | SOURCE_DATA_TYPE  |
+------------+---------------+-------------+--------------+------------+------------+--------------+-------------+-------------+-----------------+-----------+----------+-------------+----------------+-------------------+--------------------+-------------------+--------------+----------------+---------------+--------------+-------------------+
| LOCALDB    | FF_IS_SCHEMA  | blob        | c_binary     | -2         | BINARY     | 21           | 0           |             |                 | 1         |          |             | 0              | 0                 | 21                 | 1                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | blob        | c_varbinary  | -3         | VARBINARY  | 21           | 0           |             |                 | 1         |          |             | 0              | 0                 | 21                 | 2                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_char       | 1          | CHAR       | 10           | 0           |             |                 | 1         |          |             | 0              | 0                 | 10                 | 1                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_varchar    | 12         | VARCHAR    | 10           | 0           |             |                 | 1         |          |             | 0              | 0                 | 10                 | 2                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_decimal    | 3          | DECIMAL    | 10           | 0           | 0           |                 | 1         |          |             | 0              | 0                 |                    | 3                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_tinyint    | -6         | TINYINT    |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 4                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_smallint   | 5          | SMALLINT   |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 5                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_integer    | 4          | INTEGER    |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 6                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_bigint     | -5         | BIGINT     |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 7                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_real       | 7          | REAL       |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 8                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_double     | 8          | DOUBLE     |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 9                 | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_boolean    | 16         | BOOLEAN    |              | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 10                | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_date       | 93         | TIMESTAMP  | 0            | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 11                | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_time       | 93         | TIMESTAMP  | 0            | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 12                | YES          |                |               |              |                   |
| LOCALDB    | FF_IS_SCHEMA  | types       | c_timestamp  | 93         | TIMESTAMP  | 0            | 0           |             |                 | 1         |          |             | 0              | 0                 |                    | 13                | YES          |                |               |              |                   |
+------------+---------------+-------------+--------------+------------+------------+--------------+-------------+-------------+-----------------+-----------+----------+-------------+----------------+-------------------+--------------------+-------------------+--------------+----------------+---------------+--------------+-------------------+
0: jdbc:luciddb:> 
0: jdbc:luciddb:> select * from FF_is_schema."types";
Error: FennelResource.en_US.noRowsReturned(/home/elin/open/luciddb/test/sql/datatypes/types.csv, could not calculate results for the following row:
[ 'thisChar05', 'varchar-05', '123.123', '127', '32767', '2147483647', '9223372036854775807', '2.78', '3.1415161718', 'TRUE', '2005-10-12', '12:00:00', '2005-10-12 12:00:00' ]
Messages:
[0]:PC=14 Code=22007 ) (state=,code=0)
0: jdbc:luciddb:> select * from FF_is_schema."blob";
Error: java.lang.UnsupportedOperationException: class java.lang.String: Cast from 'VARCHAR(255)' to 'BINARY(21)' (state=,code=0)
0: jdbc:luciddb:> 
0: jdbc:luciddb:> -- failure
0: jdbc:luciddb:> import foreign schema "BCP"
. . . . . . . . > LIMIT to ("types", "nonexistanttable")
. . . . . . . . > from server FF_SERVER
. . . . . . . . > into FF_is_schema;
Error: One or more tables not found while importing foreign schema "BCP":  [nonexistanttable] (state=,code=0)
0: jdbc:luciddb:> !quit
