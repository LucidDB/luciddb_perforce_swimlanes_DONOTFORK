-- setup
> set schema 'rwconcur';
0 rows affected.
> alter system set "expectedConcurrentStatements" = 5;
0 rows affected.
> alter system deallocate old;
0 rows affected.
> insert into nation select * from "nation";
25 rows affected.
> insert into region select * from "region";
5 rows affected.
> insert into part select * from "part";
20000 rows affected.
> insert into supplier select * from "supplier";
1000 rows affected.
> insert into customer select * from "customer";
15000 rows affected.
> insert into partsupp select * from "partsupp";
80000 rows affected.
> insert into orders select * from "orders";
150000 rows affected.
> insert into lineitem select * from "lineitem";
600572 rows affected.
> insert into ordersu1 select * from "ordersu1";
150 rows affected.
> insert into ordersu2 select * from "ordersu2";
150 rows affected.
> insert into lineitemu1 select * from "lineitemu1";
592 rows affected.
> insert into lineitemu2 select * from "lineitemu2";
618 rows affected.
> insert into delete1 select * from "delete1";
150 rows affected.
> insert into delete2 select * from "delete2";
150 rows affected.
> analyze table nation estimate statistics for all columns;
0 rows affected.
> analyze table region estimate statistics for all columns;
0 rows affected.
> analyze table part estimate statistics for all columns;
0 rows affected.
> analyze table supplier estimate statistics for all columns;
0 rows affected.
> analyze table customer estimate statistics for all columns;
0 rows affected.
> analyze table partsupp estimate statistics for all columns;
0 rows affected.
> analyze table orders estimate statistics for all columns;
0 rows affected.
> analyze table lineitem estimate statistics for all columns;
0 rows affected.
> CREATE VIEW REVENUE0 (SUPPLIER_NO, TOTAL_REVENUE) AS
> SELECT L_SUPPKEY, SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT))
> FROM LINEITEM
> WHERE
> L_SHIPDATE >= DATE'1996-01-01' AND
> L_SHIPDATE < DATE'1996-04-01'
> GROUP BY L_SUPPKEY;
0 rows affected.
> create label beforeUpdates;
0 rows affected.
> call applib.create_var('RWCONCUR', null, 'rwconcur context');
0 rows affected.
> call applib.create_var(
> 'RWCONCUR', 'origPageCount', 'page count after initial load');
0 rows affected.
> call applib.set_var(
> 'RWCONCUR',
> 'origPageCount',
> (select counter_value from sys_root.dba_performance_counters
> where counter_name = 'DatabasePagesAllocated'));
0 rows affected.
> call applib.create_var(
> 'RWCONCUR', 'tempPageCount', 'intermediate page counter');
0 rows affected.
-- end of setup

-- thread cleanup
> set schema 'rwconcur';
0 rows affected.
> select t."name", st."rowCount", st."deletedRowCount", st."analyzeRowCount"
> from
> sys_fem.med."StoredTable" t
> inner join
> sys_fem.med."RowCountStatistics" st
> on
> t."mofId" = st."ColumnSet"
> where
> t."name" in ('LINEITEM', 'ORDERS')
> order by t."name", st."rowCount";
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+---------------------+---------------------+
| name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | rowCount            | deletedRowCount     | analyzeRowCount     |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+---------------------+---------------------+
| LINEITEM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 600572              | 0                   | 600572              |
| LINEITEM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 600578              | 586                 | 600578              |
| LINEITEM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 600595              | 1187                | 600595              |
| ORDERS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 150000              | 0                   | 150000              |
| ORDERS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 150000              | 150                 | 150000              |
| ORDERS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 150000              | 300                 | 150000              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+---------------------+---------------------+

> select table_name, count(*) from
> sys_boot.jdbc_metadata.columns_view_internal c
> inner join
> sys_fem.med."ColumnHistogram" h
> on c."mofId" = h."Column"
> where c.table_name in ('LINEITEM', 'ORDERS')
> group by table_name, "barCount"
> order by table_name;
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+
| TABLE_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | EXPR$1              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+
| LINEITEM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 48                  |
| ORDERS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 27                  |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+

> select "name", count(*) from
> sys_fem.med."LocalIndex" i inner join sys_fem.med."IndexStatistics" s
> on i."mofId" = s."LocalIndex"
> where "name" like '%LINEITEM%' or "name" like '%ORDERS%' group by "name";
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+
| name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | EXPR$1              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+
| SYS$CONSTRAINT_INDEX$SYS$PRIMARY_KEY$ORDERS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 3                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_ORDERKEY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 3                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_CUSTKEY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 3                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_ORDERSTATUS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 3                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_TOTALPRICE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 3                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_ORDERDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 3                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_ORDERPRIORITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 3                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_CLERK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 3                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_SHIPPRIORITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 3                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_COMMENT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 3                   |
| SYS$DELETION_INDEX$ORDERS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 3                   |
| SYS$CONSTRAINT_INDEX$SYS$PRIMARY_KEY$LINEITEM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_ORDERKEY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_PARTKEY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_SUPPKEY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_LINENUMBER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_QUANTITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_EXTENDEDPRICE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_DISCOUNT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_TAX                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_RETURNFLAG                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_LINESTATUS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_SHIPDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_COMMITDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_RECEIPTDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_SHIPINSTRUCT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_SHIPMODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 3                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_COMMENT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 3                   |
| SYS$DELETION_INDEX$LINEITEM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 3                   |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+

> truncate table Nation;
0 rows affected.
> truncate table Region;
0 rows affected.
> truncate table Part;
0 rows affected.
> truncate table Supplier;
0 rows affected.
> truncate table Customer;
0 rows affected.
> truncate table PartSupp;
0 rows affected.
> truncate table Orders;
0 rows affected.
> truncate table LineItem;
0 rows affected.
> truncate table ordersu1;
0 rows affected.
> truncate table ordersu2;
0 rows affected.
> truncate table lineitemu1;
0 rows affected.
> truncate table lineitemu2;
0 rows affected.
> truncate table delete1;
0 rows affected.
> truncate table delete2;
0 rows affected.
> drop view revenue0;
0 rows affected.
> alter system deallocate old;
0 rows affected.
> select sys_boot.mgmt.sleep(1000) from "delete1" where f1 = 1;
+------------+
| EXPR$0     |
+------------+
| 0          |
+------------+

> select
> (cast(counter_value as bigint) >
> cast(applib.get_var('RWCONCUR', 'tempPageCount') as bigint))
> from sys_root.dba_performance_counters
> where counter_name = 'DatabasePagesAllocated';
+--------+
| EXPR$0 |
+--------+
| true   |
+--------+

> drop label beforeUpdates;
0 rows affected.
> drop label afterUpdate1;
0 rows affected.
> drop label afterUpdate2;
0 rows affected.
> alter system deallocate old;
0 rows affected.
> select sys_boot.mgmt.sleep(1000) from "delete1" where f1 = 1;
+------------+
| EXPR$0     |
+------------+
| 0          |
+------------+

> select
> (cast(counter_value as bigint) <
> cast(applib.get_var('RWCONCUR', 'origPageCount') as bigint))
> from sys_root.dba_performance_counters
> where counter_name = 'DatabasePagesAllocated';
+--------+
| EXPR$0 |
+--------+
| true   |
+--------+

> select t."name", st."rowCount", st."deletedRowCount", st."analyzeRowCount"
> from
> sys_fem.med."StoredTable" t
> inner join
> sys_fem.med."RowCountStatistics" st
> on
> t."mofId" = st."ColumnSet"
> where
> t."name" in ('LINEITEM', 'ORDERS')
> order by t."name", st."rowCount";
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+---------------------+---------------------+
| name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | rowCount            | deletedRowCount     | analyzeRowCount     |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+---------------------+---------------------+
| LINEITEM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 0                   | 0                   | 600595              |
| ORDERS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 0                   | 0                   | 150000              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+---------------------+---------------------+

> select table_name, count(*) from
> sys_boot.jdbc_metadata.columns_view_internal c
> inner join
> sys_fem.med."ColumnHistogram" h
> on c."mofId" = h."Column"
> where c.table_name in ('LINEITEM', 'ORDERS')
> group by table_name, "barCount"
> order by table_name;
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+
| TABLE_NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | EXPR$1              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+
| LINEITEM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 16                  |
| ORDERS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 9                   |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+

> select "name", count(*) from
> sys_fem.med."LocalIndex" i inner join sys_fem.med."IndexStatistics" s
> on i."mofId" = s."LocalIndex"
> where "name" like '%LINEITEM%' or "name" like '%ORDERS%' group by "name";
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+
| name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | EXPR$1              |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+
| SYS$CONSTRAINT_INDEX$SYS$PRIMARY_KEY$ORDERS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 1                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_ORDERKEY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 1                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_CUSTKEY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 1                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_ORDERSTATUS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 1                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_TOTALPRICE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 1                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_ORDERDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 1                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_ORDERPRIORITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 1                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_CLERK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 1                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_SHIPPRIORITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 1                   |
| SYS$CLUSTERED_INDEX$ORDERS$O_COMMENT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 1                   |
| SYS$DELETION_INDEX$ORDERS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 1                   |
| SYS$CONSTRAINT_INDEX$SYS$PRIMARY_KEY$LINEITEM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_ORDERKEY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_PARTKEY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_SUPPKEY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_LINENUMBER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_QUANTITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_EXTENDEDPRICE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_DISCOUNT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_TAX                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_RETURNFLAG                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_LINESTATUS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_SHIPDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_COMMITDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_RECEIPTDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_SHIPINSTRUCT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_SHIPMODE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 1                   |
| SYS$CLUSTERED_INDEX$LINEITEM$L_COMMENT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 1                   |
| SYS$DELETION_INDEX$LINEITEM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 1                   |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+

> call applib.delete_var('RWCONCUR', 'origPageCount');
0 rows affected.
> call applib.delete_var('RWCONCUR', 'tempPageCount');
0 rows affected.
> alter system set "expectedConcurrentStatements" = 4;
0 rows affected.
-- end of thread cleanup

-- thread RF1A
> set schema 'rwconcur';
0 rows affected.
> insert into orders select * from ordersu1;
150 rows affected.
> delete from orders where o_orderkey in (select * from delete1);
150 rows affected.
> analyze table orders estimate statistics for all columns;
0 rows affected.
> alter system deallocate old;
0 rows affected.
> select sys_boot.mgmt.sleep(1000) from "delete1" where f1 = 1;
+------------+
| EXPR$0     |
+------------+
| 0          |
+------------+

> select
> (cast(counter_value as bigint) >
> cast(applib.get_var('RWCONCUR', 'origPageCount') as bigint))
> from sys_root.dba_performance_counters
> where counter_name = 'DatabasePagesAllocated';
+--------+
| EXPR$0 |
+--------+
| true   |
+--------+

> call applib.set_var(
> 'RWCONCUR',
> 'tempPageCount',
> (select counter_value from sys_root.dba_performance_counters
> where counter_name = 'DatabasePagesAllocated'));
0 rows affected.
> create label afterUpdate1;
0 rows affected.
> insert into orders select * from ordersu2;
150 rows affected.
> delete from orders where o_orderkey in (select * from delete2);
150 rows affected.
> analyze table orders estimate statistics for all columns;
0 rows affected.
> alter system deallocate old;
0 rows affected.
> select sys_boot.mgmt.sleep(1000) from "delete1" where f1 = 1;
+------------+
| EXPR$0     |
+------------+
| 0          |
+------------+

> select
> (cast(counter_value as bigint) >
> cast(applib.get_var('RWCONCUR', 'tempPageCount') as bigint))
> from sys_root.dba_performance_counters
> where counter_name = 'DatabasePagesAllocated';
+--------+
| EXPR$0 |
+--------+
| true   |
+--------+

> call applib.set_var(
> 'RWCONCUR',
> 'tempPageCount',
> (select counter_value from sys_root.dba_performance_counters
> where counter_name = 'DatabasePagesAllocated'));
0 rows affected.
> create label afterUpdate2;
0 rows affected.
-- end of thread RF1A

-- thread RF2A
> set schema 'rwconcur';
0 rows affected.
> insert into lineitem select * from lineitemu1;
592 rows affected.
> delete from lineitem where l_orderkey in (select * from delete1);
586 rows affected.
> analyze table lineitem estimate statistics for all columns;
0 rows affected.
> alter system deallocate old;
0 rows affected.
> insert into lineitem select * from lineitemu2;
618 rows affected.
> delete from lineitem where l_orderkey in (select * from delete2);
601 rows affected.
> analyze table lineitem estimate statistics for all columns;
0 rows affected.
> alter system deallocate old;
0 rows affected.
-- end of thread RF2A

-- thread queries1
> set schema 'rwconcur';
0 rows affected.
> alter session set "label" = 'BEFOREUPDATES';
0 rows affected.
> SELECT
> L_ORDERKEY,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> O_ORDERDATE,
> O_SHIPPRIORITY
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> C_MKTSEGMENT = 'BUILDING' AND
> C_CUSTKEY = O_CUSTKEY AND
> L_ORDERKEY = O_ORDERKEY AND
> O_ORDERDATE < DATE '1995-03-15' AND
> L_SHIPDATE > DATE '1995-03-15'
> GROUP BY
> L_ORDERKEY,
> O_ORDERDATE,
> O_SHIPPRIORITY
> ORDER BY
> REVENUE DESC,
> O_ORDERDATE;
+------------+---------------------+-------------+----------------+
| L_ORDERKEY | REVENUE             | O_ORDERDATE | O_SHIPPRIORITY |
+------------+---------------------+-------------+----------------+
| 223140     | 355369.0698         | 1995-03-14  | 0              |
| 584291     | 354494.7318         | 1995-02-21  | 0              |
| 405063     | 353125.4577         | 1995-03-03  | 0              |
| 573861     | 351238.2770         | 1995-03-09  | 0              |
| 554757     | 349181.7426         | 1995-03-14  | 0              |
| 506021     | 321075.5810         | 1995-03-10  | 0              |
| 121604     | 318576.4154         | 1995-03-07  | 0              |
| 108514     | 314967.0754         | 1995-02-20  | 0              |
| 462502     | 312604.5420         | 1995-03-08  | 0              |
| 178727     | 309728.9306         | 1995-02-25  | 0              |
+------------+---------------------+-------------+----------------+

> SELECT
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE,
> SUM(L_QUANTITY)
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> O_ORDERKEY IN (
> SELECT
> L_ORDERKEY
> FROM
> LINEITEM
> GROUP BY
> L_ORDERKEY
> HAVING
> SUM(L_QUANTITY) > 300
> )
> AND C_CUSTKEY = O_CUSTKEY
> AND O_ORDERKEY = L_ORDERKEY
> GROUP BY
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE
> ORDER BY
> O_TOTALPRICE DESC,
> O_ORDERDATE;
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| C_NAME                    | C_CUSTKEY  | O_ORDERKEY | O_ORDERDATE | O_TOTALPRICE    | EXPR$5          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| Customer#000001639        | 1639       | 502886     | 1994-04-12  | 456423.88       | 312.00          |
| Customer#000006655        | 6655       | 29158      | 1995-10-21  | 452805.02       | 305.00          |
| Customer#000014110        | 14110      | 565574     | 1995-09-24  | 425099.85       | 301.00          |
| Customer#000001775        | 1775       | 6882       | 1997-04-09  | 408368.10       | 303.00          |
| Customer#000011459        | 11459      | 551136     | 1993-05-19  | 386812.74       | 308.00          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+

> SELECT
> N_NAME,
> SUM(L_EXTENDEDPRICE * ( 1 - L_DISCOUNT)) AS REVENUE
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> SUPPLIER,
> NATION,
> REGION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND L_SUPPKEY = S_SUPPKEY
> AND C_NATIONKEY = S_NATIONKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'ASIA'
> AND O_ORDERDATE >=  date '1994-01-01'
> AND O_ORDERDATE < DATE '1995-01-01'
> GROUP BY
> N_NAME
> ORDER BY
> REVENUE DESC;
+---------------------------+---------------------+
| N_NAME                    | REVENUE             |
+---------------------------+---------------------+
| CHINA                     | 7822103.0000        |
| INDIA                     | 6376121.5085        |
| JAPAN                     | 6000077.2184        |
| INDONESIA                 | 5580475.4027        |
| VIETNAM                   | 4497840.5466        |
+---------------------------+---------------------+

> SELECT
> PS_PARTKEY,
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) AS VAL
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> GROUP BY
> PS_PARTKEY HAVING
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) > (
> SELECT
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) * (0.0001 / 0.1)
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> )
> ORDER BY
> VAL DESC;
+------------+---------------------+
| PS_PARTKEY | VAL                 |
+------------+---------------------+
| 12098      | 16227681.21         |
| 5134       | 15709338.52         |
| 13334      | 15023662.41         |
| 17052      | 14351644.20         |
| 3452       | 14070870.14         |
| 12552      | 13332469.18         |
| 1084       | 13170428.29         |
| 5797       | 13038622.72         |
| 12633      | 12892561.61         |
| 403        | 12856217.34         |
| 1833       | 12024581.72         |
| 2084       | 11502875.36         |
| 17349      | 11354213.05         |
| 18427      | 11282385.24         |
| 2860       | 11262529.95         |
| 17852      | 10934711.93         |
| 9871       | 10889253.68         |
| 12231      | 10841131.39         |
| 6366       | 10759786.81         |
| 12146      | 10257362.66         |
| 5043       | 10226395.88         |
| 12969      | 10125777.93         |
+------------+---------------------+

> SELECT
> SUPP_NATION,
> CUST_NATION,
> YYEAR,
> SUM(VOLUME) AS REVENUE
> FROM
> (SELECT
> N1.N_NAME AS SUPP_NATION,
> N2.N_NAME AS CUST_NATION,
> APPLIB.DATE_TO_CHAR('yyyy', L_SHIPDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME
> FROM
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND C_CUSTKEY = O_CUSTKEY
> AND S_NATIONKEY = N1.N_NATIONKEY
> AND C_NATIONKEY = N2.N_NATIONKEY
> AND ((N1.N_NAME = 'FRANCE' AND N2.N_NAME = 'GERMANY')
> OR (N1.N_NAME = 'GERMANY' AND N2.N_NAME = 'FRANCE'))
> AND L_SHIPDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> ) AS SHIPPING
> GROUP BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR
> ORDER BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR;
+---------------------------+---------------------------+-------+---------------------+
| SUPP_NATION               | CUST_NATION               | YYEAR | REVENUE             |
+---------------------------+---------------------------+-------+---------------------+
| FRANCE                    | GERMANY                   | 1995  | 4637235.1501        |
| FRANCE                    | GERMANY                   | 1996  | 5224779.5736        |
| GERMANY                   | FRANCE                    | 1995  | 6232818.7037        |
| GERMANY                   | FRANCE                    | 1996  | 5557312.1121        |
+---------------------------+---------------------------+-------+---------------------+

> SELECT SUM(L_EXTENDEDPRICE * L_DISCOUNT) AS REVENUE
> FROM LINEITEM
> WHERE
> L_SHIPDATE >= DATE '1994-01-01' AND
> L_SHIPDATE < date '1995-01-01' AND
> L_DISCOUNT BETWEEN .06 - 0.01 AND .06 + 0.01 AND
> L_QUANTITY <  24;
+---------------------+
| REVENUE             |
+---------------------+
| 11803420.2534       |
+---------------------+

> SELECT
> S_NAME,
> S_ADDRESS
> FROM
> SUPPLIER,
> NATION
> WHERE
> S_SUPPKEY IN (
> SELECT
> PS_SUPPKEY
> FROM
> PARTSUPP
> WHERE
> PS_PARTKEY IN (
> SELECT
> P_PARTKEY
> FROM
> PART
> WHERE
> P_NAME LIKE 'forest%'
> )
> AND PS_AVAILQTY > (
> SELECT
> 0.5 * SUM(L_QUANTITY)
> FROM
> LINEITEM
> WHERE
> L_PARTKEY = PS_PARTKEY
> AND L_SUPPKEY = PS_SUPPKEY
> AND L_SHIPDATE >= DATE '1994-01-01'
> AND L_SHIPDATE < DATE '1995-01-01'
> )
> )
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'CANADA'
> ORDER BY
> S_NAME;
+---------------------------+------------------------------------------+
| S_NAME                    | S_ADDRESS                                |
+---------------------------+------------------------------------------+
| Supplier#000000013        | HK71HQyWoqRWOX8GI FpgAifW,2PoH           |
| Supplier#000000020        | iybAE,RmTymrZVYaFZva2SH,j                |
| Supplier#000000091        | YV45D7TkfdQanOOZ7q9QxkyGUapU1oOWU6q3     |
| Supplier#000000157        | ,mEGorBfVIm                              |
| Supplier#000000197        | YC2Acon6kjY3zj3Fbxs2k4Vdf7X0cd2F         |
| Supplier#000000205        | rF uV8d0JNEk                             |
| Supplier#000000285        | Br7e1nnt1yxrw6ImgpJ7YdhFDjuBf            |
| Supplier#000000287        | 7a9SP7qW5Yku5PvSg                        |
| Supplier#000000358        | V3yxhHhHSXqOoc5UPv5TwkVDGKQsG            |
| Supplier#000000402        | i9Sw4DoyMhzhKXCH9By,AYSgmD               |
| Supplier#000000431        | WoeV,NINojE6hJjauAdrl5fGcdxX5JUPLnrim    |
| Supplier#000000530        | 0qwCMwobKY OcmLyfRXlagA8ukENJv,          |
| Supplier#000000555        | TfB,a5bfl3Ah 3Z 74GqnNs6zKVGM            |
| Supplier#000000557        | jj0wUYh9K3fG5Jhdhrkuy ,4                 |
| Supplier#000000640        | mvvtlQKsTOsJj5Ihk7,cq                    |
| Supplier#000000729        | pqck2ppy758TQpZCUAjPvlU55K3QjfL7Bi       |
| Supplier#000000736        | l6i2nMwVuovfKnuVgaSGK2rDy65DlAFLegiL7    |
| Supplier#000000744        | 5NKuw5W4mFDMQBbUjUO4k kfokG8yvAe         |
| Supplier#000000752        | l cHMtEnodxj3FV                          |
| Supplier#000000848        | tx44JAuF,Jnw1                            |
| Supplier#000000997        | 7eUWMrOCKCp2JYas6P4mL93eaWIOtKKWtTX      |
+---------------------------+------------------------------------------+

> SELECT SUM(L_EXTENDEDPRICE) / 7.0 AS AVG_YEARLY
> FROM LINEITEM L, PART,
> (SELECT L1.L_PARTKEY, (0.2 * AVG(L_QUANTITY)) AS AVGQTY
> FROM LINEITEM L1
> GROUP BY L1.L_PARTKEY) AS TEMP
> WHERE
> P_PARTKEY = L.L_PARTKEY AND
> P_BRAND = 'Brand#23' AND
> P_CONTAINER = 'MED BOX' AND
> P_PARTKEY = TEMP.L_PARTKEY AND
> L.L_QUANTITY < TEMP.AVGQTY;
+---------------------+
| AVG_YEARLY          |
+---------------------+
| 23512.752857        |
+---------------------+

> SELECT
> L_SHIPMODE,
> SUM(CASE WHEN O_ORDERPRIORITY = '1-URGENT'
> OR O_ORDERPRIORITY = '2-HIGH'
> THEN 1
> ELSE 0
> END) AS HIGH_LINE_COUNT,
> SUM(CASE WHEN O_ORDERPRIORITY <> '1-URGENT'
> AND O_ORDERPRIORITY <> '2-HIGH'
> THEN 1
> ELSE 0
> END) AS LOW_LINE_COUNT
> FROM ORDERS, LINEITEM
> WHERE
> O_ORDERKEY = L_ORDERKEY
> AND L_SHIPMODE IN ('MAIL', 'SHIP')
> AND L_COMMITDATE < L_RECEIPTDATE
> AND L_SHIPDATE < L_COMMITDATE
> AND L_RECEIPTDATE >= DATE'1994-01-01'
> AND L_RECEIPTDATE < DATE'1995-01-01'
> GROUP BY L_SHIPMODE
> ORDER BY L_SHIPMODE;
+------------+-----------------+----------------+
| L_SHIPMODE | HIGH_LINE_COUNT | LOW_LINE_COUNT |
+------------+-----------------+----------------+
| MAIL       | 647             | 945            |
| SHIP       | 620             | 943            |
+------------+-----------------+----------------+

> SELECT
> P_BRAND,
> P_TYPE,
> P_SIZE,
> COUNT(DISTINCT PS_SUPPKEY) AS SUPPLIER_CNT
> FROM
> PARTSUPP,
> PART
> WHERE
> P_PARTKEY = PS_PARTKEY
> AND P_BRAND <> 'Brand#45'
> AND P_TYPE NOT LIKE 'MEDIUM POLISHED%'
> AND P_SIZE IN (49, 14, 23, 45, 19, 3, 36, 9)
> AND PS_SUPPKEY NOT IN (
> SELECT
> S_SUPPKEY
> FROM
> SUPPLIER
> WHERE
> S_COMMENT LIKE '%Customer%Complaints%'
> )
> GROUP BY
> P_BRAND,
> P_TYPE,
> P_SIZE
> ORDER BY
> SUPPLIER_CNT DESC,
> P_BRAND,
> P_TYPE,
> P_SIZE;
+------------+---------------------------+------------+---------------------+
| P_BRAND    | P_TYPE                    | P_SIZE     | SUPPLIER_CNT        |
+------------+---------------------------+------------+---------------------+
| Brand#14   | SMALL ANODIZED NICKEL     | 45         | 12                  |
| Brand#22   | SMALL BURNISHED BRASS     | 19         | 12                  |
| Brand#25   | PROMO POLISHED COPPER     | 14         | 12                  |
| Brand#35   | LARGE ANODIZED STEEL      | 45         | 12                  |
| Brand#35   | PROMO BRUSHED COPPER      | 9          | 12                  |
| Brand#51   | ECONOMY ANODIZED STEEL    | 9          | 12                  |
| Brand#53   | LARGE BRUSHED NICKEL      | 45         | 12                  |
| Brand#11   | ECONOMY POLISHED COPPER   | 14         | 8                   |
| Brand#11   | LARGE PLATED STEEL        | 23         | 8                   |
| Brand#11   | PROMO POLISHED STEEL      | 23         | 8                   |
+------------+---------------------------+------------+---------------------+

> SELECT
> S_SUPPKEY,
> S_NAME,
> S_ADDRESS,
> S_PHONE,
> TOTAL_REVENUE
> FROM
> SUPPLIER,
> REVENUE0
> WHERE
> S_SUPPKEY = SUPPLIER_NO
> AND TOTAL_REVENUE = (
> SELECT
> MAX(TOTAL_REVENUE)
> FROM
> REVENUE0
> )
> ORDER BY
> S_SUPPKEY;
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| S_SUPPKEY  | S_NAME                    | S_ADDRESS                                | S_PHONE         | TOTAL_REVENUE       |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| 677        | Supplier#000000677        | 8mhrffG7D2WJBSQbOGstQ                    | 23-290-639-3315 | 1614410.2928        |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+

> SELECT
> C_COUNT, COUNT(*) AS CUSTDIST
> FROM (
> SELECT
> C_CUSTKEY,
> COUNT(O_ORDERKEY)
> FROM
> CUSTOMER LEFT OUTER JOIN ORDERS ON
> C_CUSTKEY = O_CUSTKEY
> AND O_COMMENT NOT LIKE '%special%requests%'
> GROUP BY
> C_CUSTKEY
> )AS C_ORDERS (C_CUSTKEY, C_COUNT)
> GROUP BY
> C_COUNT
> ORDER BY
> CUSTDIST DESC,
> C_COUNT DESC;
+---------------------+---------------------+
| C_COUNT             | CUSTDIST            |
+---------------------+---------------------+
| 0                   | 5000                |
| 10                  | 665                 |
| 9                   | 657                 |
| 11                  | 621                 |
| 12                  | 567                 |
| 8                   | 564                 |
| 13                  | 492                 |
| 18                  | 482                 |
| 7                   | 480                 |
| 20                  | 456                 |
| 14                  | 456                 |
| 16                  | 449                 |
| 19                  | 447                 |
| 15                  | 432                 |
| 17                  | 423                 |
| 21                  | 412                 |
| 22                  | 371                 |
| 6                   | 337                 |
| 23                  | 323                 |
| 24                  | 256                 |
| 25                  | 204                 |
| 5                   | 204                 |
| 26                  | 155                 |
| 27                  | 141                 |
| 28                  | 97                  |
| 4                   | 94                  |
| 29                  | 64                  |
| 3                   | 48                  |
| 30                  | 27                  |
| 31                  | 26                  |
| 32                  | 14                  |
| 33                  | 11                  |
| 2                   | 11                  |
| 34                  | 6                   |
| 35                  | 5                   |
| 1                   | 2                   |
| 36                  | 1                   |
+---------------------+---------------------+

> SELECT
> C_CUSTKEY,
> C_NAME,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> C_ACCTBAL,
> N_NAME,
> C_ADDRESS,
> C_PHONE,
> C_COMMENT
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> NATION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_ORDERDATE >= date '1993-10-01'
> AND O_ORDERDATE < DATE '1994-01-01'
> AND L_RETURNFLAG = 'R'
> AND C_NATIONKEY = N_NATIONKEY
> GROUP BY
> C_CUSTKEY,
> C_NAME,
> C_ACCTBAL,
> C_PHONE,
> N_NAME,
> C_ADDRESS,
> C_COMMENT
> ORDER BY
> REVENUE DESC;
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| C_CUSTKEY  | C_NAME                    | REVENUE             | C_ACCTBAL       | N_NAME                    | C_ADDRESS                                | C_PHONE         | C_COMMENT                                                                                                             |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| 8242       | Customer#000008242        | 622786.7297         | 6322.09         | ETHIOPIA                  | P2n4nJhy,UqSo2s43YfSvYJDZ6lk             | 15-792-676-1184 | slyly regular packages haggle carefully ironic ideas. courts are furiously. furiously unusual theodolites cajole. i   |
| 7714       | Customer#000007714        | 557400.3053         | 9799.98         | IRAN                      | SnnIGB,SkmnWpX3                          | 20-922-418-6024 | arhorses according to the blithely express re                                                                         |
| 11032      | Customer#000011032        | 512500.9641         | 8496.93         | UNITED KINGDOM            | WIKHC7K3Cn7156iNOyfVG3cZ7YqkgsR,Ly       | 33-102-772-3533 | posits-- furiously ironic accounts are again                                                                          |
| 2455       | Customer#000002455        | 481592.4053         | 2070.99         | GERMANY                   | RVn1ZSRtLqPlJLIZxvpmsbgC02               | 17-946-225-9977 | al asymptotes. finally ironic accounts cajole furiously. permanently unusual theodolites aro                          |
| 12106      | Customer#000012106        | 479414.2133         | 5342.11         | UNITED STATES             | wth3twOmu6vy                             | 34-905-346-4472 | ly after the blithely regular foxes. accounts haggle carefully alongside of the blithely even ideas.                  |
| 8530       | Customer#000008530        | 457855.9467         | 9734.95         | MOROCCO                   | GMQyte94oDM7eD7exnkj 4hH9yq3             | 25-736-932-5850 | slyly asymptotes. quickly final deposits in                                                                           |
| 13984      | Customer#000013984        | 446316.5104         | 3482.28         | IRAN                      | qZXwuapCHvxbX                            | 20-981-264-2952 | y unusual courts could wake furiously                                                                                 |
| 1966       | Customer#000001966        | 444059.0382         | 1937.72         | ALGERIA                   | jPv1 UHra5JLALR5Isci5u0636RoAu7t vH      | 10-973-269-8886 | the blithely even accounts. final deposits cajole around the blithely final packages.                                 |
| 11026      | Customer#000011026        | 417913.4142         | 7738.76         | ALGERIA                   | XorIktoJOAEJkpNNMx                       | 10-184-163-4632 | ly even dolphins eat along the blithely even instructions. express attainments cajole slyly. busy dolphins in         |
| 8501       | Customer#000008501        | 412797.5100         | 6906.70         | ARGENTINA                 | 776af4rOa mZ66hczs                       | 11-317-552-5840 | y final deposits after the fluffily even accounts are slyly final, regular                                            |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+

> SELECT S.S_ACCTBAL, S.S_NAME, N_NAME, PS.PS_PARTKEY, P.P_MFGR,
> S.S_ADDRESS, S.S_PHONE, S.S_COMMENT
> FROM PART P, SUPPLIER S, PARTSUPP PS, NATION, REGION,
> (SELECT PS1.PS_PARTKEY, MIN(PS1.PS_SUPPLYCOST) AS MINCOST
> FROM PARTSUPP PS1, SUPPLIER S1, NATION N1, REGION R1
> WHERE PS1.PS_SUPPKEY = S1.S_SUPPKEY AND
> S1.S_NATIONKEY = N1.N_NATIONKEY AND
> N1.N_REGIONKEY = R1.R_REGIONKEY AND
> R1.R_NAME = 'EUROPE'
> GROUP BY PS1.PS_PARTKEY) AS TEMP
> WHERE P.P_PARTKEY = PS.PS_PARTKEY AND
> S.S_SUPPKEY = PS.PS_SUPPKEY AND
> P.P_SIZE = 15 AND
> P.P_TYPE LIKE '%BRASS' AND
> S.S_NATIONKEY = N_NATIONKEY AND
> N_REGIONKEY = R_REGIONKEY AND
> PS.PS_PARTKEY = TEMP.PS_PARTKEY AND
> PS.PS_SUPPLYCOST = TEMP.MINCOST
> ORDER BY S.S_ACCTBAL DESC, N_NAME, S.S_NAME, PS.PS_PARTKEY;
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| S_ACCTBAL       | S_NAME                    | N_NAME                    | PS_PARTKEY | P_MFGR                    | S_ADDRESS                                | S_PHONE         | S_COMMENT                                                                                             |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| 9828.21         | Supplier#000000647        | UNITED KINGDOM            | 13120      | Manufacturer#5            | x5U7MBZmwfG9                             | 33-258-202-4782 | s the slyly even ideas poach fluffily                                                                 |
| 9508.37         | Supplier#000000070        | FRANCE                    | 3563       | Manufacturer#1            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9508.37         | Supplier#000000070        | FRANCE                    | 17268      | Manufacturer#4            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 10021      | Manufacturer#5            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 13275      | Manufacturer#4            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9192.10         | Supplier#000000115        | UNITED KINGDOM            | 13325      | Manufacturer#1            | nJ 2t0f7Ve,wL1,6WzGBJLNBUCKlsV           | 33-597-248-1220 | es across the carefully express accounts boost caref                                                  |
| 9032.15         | Supplier#000000959        | GERMANY                   | 4958       | Manufacturer#4            | 8grA EHBnwOZhO                           | 17-108-642-3106 | nding dependencies nag furiou                                                                         |
| 8702.02         | Supplier#000000333        | RUSSIA                    | 11810      | Manufacturer#3            | MaVf XgwPdkiX4nfJGOis8Uu2zKiIZH          | 32-508-202-6136 | oss the deposits cajole carefully even pinto beans. regular foxes detect alo                          |
| 8615.50         | Supplier#000000812        | FRANCE                    | 10551      | Manufacturer#2            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
| 8615.50         | Supplier#000000812        | FRANCE                    | 13811      | Manufacturer#4            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+

> SELECT
> YYEAR,
> CAST(SUM(CASE WHEN NATION = 'BRAZIL'
> THEN VOLUME
> ELSE 0
> END) AS DECIMAL(19,4))*1.0000 /
> CAST(SUM(VOLUME) AS DECIMAL(19,4)) AS MKT_SHARE
> FROM (SELECT
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME,
> N2.N_NAME AS NATION
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2,
> REGION
> WHERE
> P_PARTKEY = L_PARTKEY
> AND S_SUPPKEY = L_SUPPKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_CUSTKEY = C_CUSTKEY
> AND C_NATIONKEY = N1.N_NATIONKEY
> AND N1.N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'AMERICA'
> AND S_NATIONKEY = N2.N_NATIONKEY
> AND O_ORDERDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> AND P_TYPE = 'ECONOMY ANODIZED STEEL') AS ALL_NATIONS
> GROUP BY YYEAR
> ORDER BY YYEAR;
+-------+---------------------+
| YYEAR | MKT_SHARE           |
+-------+---------------------+
| 1995  | 0.028649            |
| 1996  | 0.018250            |
+-------+---------------------+

> SELECT
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) ) AS REVENUE
> FROM
> LINEITEM,
> PART
> WHERE
> P_PARTKEY = L_PARTKEY
> AND
> ((
> P_BRAND = 'Brand#12'
> AND P_CONTAINER IN ( 'SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
> AND L_QUANTITY >= 1 AND L_QUANTITY <= 1 + 10
> AND P_SIZE BETWEEN 1 AND 5
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#23'
> AND P_CONTAINER IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
> AND L_QUANTITY >= 10 AND L_QUANTITY <= 10 + 10
> AND P_SIZE BETWEEN 1 AND 10
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#34'
> AND P_CONTAINER IN ( 'LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
> AND L_QUANTITY >= 20 AND L_QUANTITY <= 20 + 10
> AND P_SIZE BETWEEN 1 AND 15
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> ));
+---------------------+
| REVENUE             |
+---------------------+
| 168597.2860         |
+---------------------+

> SELECT
> 100.00 * SUM(CASE WHEN P_TYPE LIKE 'PROMO%'
> THEN L_EXTENDEDPRICE * (1 - L_DISCOUNT)
> ELSE 0
> END) / SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT))
> AS PROMO_REVENUE
> FROM LINEITEM, PART
> WHERE L_PARTKEY = P_PARTKEY
> AND L_SHIPDATE >= DATE'1995-09-01'
> AND L_SHIPDATE < DATE'1995-10-01';
+---------------------+
| PROMO_REVENUE       |
+---------------------+
| 16.283856           |
+---------------------+

> SELECT
> NATION,
> YYEAR,
> SUM(AMOUNT) AS SUM_PROFIT
> FROM (SELECT
> N_NAME AS NATION,
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) - PS_SUPPLYCOST * L_QUANTITY AS AMOUNT
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> PARTSUPP,
> ORDERS,
> NATION
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND PS_SUPPKEY = L_SUPPKEY
> AND PS_PARTKEY = L_PARTKEY
> AND P_PARTKEY = L_PARTKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND P_NAME LIKE '%green%'
> ) AS PROFIT
> GROUP BY
> NATION,
> YYEAR
> ORDER BY
> NATION,
> YYEAR DESC;
+---------------------------+-------+---------------------+
| NATION                    | YYEAR | SUM_PROFIT          |
+---------------------------+-------+---------------------+
| ALGERIA                   | 1998  | 2334804.6272        |
| ALGERIA                   | 1997  | 3885259.7471        |
| ALGERIA                   | 1996  | 4193307.2158        |
| ALGERIA                   | 1995  | 4159170.6827        |
| ALGERIA                   | 1994  | 4642813.9269        |
| ALGERIA                   | 1993  | 3628134.7118        |
| ALGERIA                   | 1992  | 3453838.6906        |
| ARGENTINA                 | 1998  | 3173981.1186        |
| ARGENTINA                 | 1997  | 4648199.7641        |
| ARGENTINA                 | 1996  | 5276848.2215        |
+---------------------------+-------+---------------------+

> SELECT
> L_RETURNFLAG,
> L_LINESTATUS,
> SUM(L_QUANTITY) AS SUM_QTY,
> SUM(L_EXTENDEDPRICE) AS SUM_BASE_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS SUM_DISC_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) * (1 + L_TAX)) AS SUM_CHARGE,
> AVG(L_QUANTITY) AS AVG_QTY,
> AVG(L_EXTENDEDPRICE) AS AVG_PRICE,
> AVG(L_DISCOUNT) AS AVG_DISC,
> COUNT(*) AS COUNT_ORDER
> FROM
> LINEITEM
> WHERE
> L_SHIPDATE <=  APPLIB.ADD_DAYS(DATE '1998-12-01', -90)
> GROUP BY
> L_RETURNFLAG,
> L_LINESTATUS
> ORDER BY
> L_RETURNFLAG,
> L_LINESTATUS;
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| L_RETURNFLAG | L_LINESTATUS | SUM_QTY         | SUM_BASE_PRICE  | SUM_DISC_PRICE      | SUM_CHARGE          | AVG_QTY         | AVG_PRICE       | AVG_DISC        | COUNT_ORDER         |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| A            | F            | 3774200.00      | 5320753880.69   | 5054096266.6828     | 5256751331.449234   | 25.54           | 36002.12        | 0.05            | 147790              |
| N            | F            | 95257.00        | 133737795.84    | 127132372.6512      | 132286291.229445    | 25.30           | 35521.33        | 0.05            | 3765                |
| N            | O            | 7459297.00      | 10512270008.90  | 9986238338.3847     | 10385578376.585467  | 25.55           | 36000.92        | 0.05            | 292000              |
| R            | F            | 3785523.00      | 5337950526.47   | 5071818532.9420     | 5274405503.049367   | 25.53           | 35994.03        | 0.05            | 148301              |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+

> SELECT
> O_ORDERPRIORITY,
> COUNT(*) AS ORDER_COUNT
> FROM ORDERS
> WHERE
> O_ORDERDATE >= DATE '1993-07-01'
> AND O_ORDERDATE < DATE '1993-10-01'
> AND EXISTS (
> SELECT
> *
> FROM
> LINEITEM
> WHERE
> L_ORDERKEY = O_ORDERKEY
> AND L_COMMITDATE < L_RECEIPTDATE
> )
> GROUP BY
> O_ORDERPRIORITY
> ORDER BY
> O_ORDERPRIORITY;
+-----------------+---------------------+
| O_ORDERPRIORITY | ORDER_COUNT         |
+-----------------+---------------------+
| 1-URGENT        | 999                 |
| 2-HIGH          | 997                 |
| 3-MEDIUM        | 1031                |
| 4-NOT SPECIFIED | 989                 |
| 5-LOW           | 1077                |
+-----------------+---------------------+

> SELECT
> CNTRYCODE,
> COUNT(*) AS NUMCUST,
> SUM(C_ACCTBAL) AS TOTACCTBAL
> FROM (
> SELECT
> SUBSTRING(C_PHONE FROM 1 FOR 2) AS CNTRYCODE,
> C_ACCTBAL
> FROM
> CUSTOMER
> WHERE
> SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> AND C_ACCTBAL > (
> SELECT
> AVG(C_ACCTBAL)
> FROM
> CUSTOMER
> WHERE
> C_ACCTBAL > 0.00
> AND SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> )
> AND NOT EXISTS (
> SELECT
> *
> FROM
> ORDERS
> WHERE
> O_CUSTKEY = C_CUSTKEY
> )
> ) AS CUSTSALE
> GROUP BY
> CNTRYCODE
> ORDER BY
> CNTRYCODE;
+-----------------+---------------------+-----------------+
| CNTRYCODE       | NUMCUST             | TOTACCTBAL      |
+-----------------+---------------------+-----------------+
| 13              | 94                  | 714035.05       |
| 17              | 96                  | 722560.15       |
| 18              | 99                  | 738012.52       |
| 23              | 93                  | 708285.25       |
| 29              | 85                  | 632693.46       |
| 30              | 87                  | 646748.02       |
| 31              | 87                  | 647372.50       |
+-----------------+---------------------+-----------------+

> SELECT
> CNTRYCODE,
> COUNT(*) AS NUMCUST,
> SUM(C_ACCTBAL) AS TOTACCTBAL
> FROM (
> SELECT
> SUBSTRING(C_PHONE FROM 1 FOR 2) AS CNTRYCODE,
> C_ACCTBAL
> FROM
> CUSTOMER
> WHERE
> SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> AND C_ACCTBAL > (
> SELECT
> AVG(C_ACCTBAL)
> FROM
> CUSTOMER
> WHERE
> C_ACCTBAL > 0.00
> AND SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> )
> AND NOT EXISTS (
> SELECT
> *
> FROM
> ORDERS
> WHERE
> O_CUSTKEY = C_CUSTKEY
> )
> ) AS CUSTSALE
> GROUP BY
> CNTRYCODE
> ORDER BY
> CNTRYCODE;
+-----------------+---------------------+-----------------+
| CNTRYCODE       | NUMCUST             | TOTACCTBAL      |
+-----------------+---------------------+-----------------+
| 13              | 94                  | 714035.05       |
| 17              | 96                  | 722560.15       |
| 18              | 99                  | 738012.52       |
| 23              | 93                  | 708285.25       |
| 29              | 85                  | 632693.46       |
| 30              | 87                  | 646748.02       |
| 31              | 87                  | 647372.50       |
+-----------------+---------------------+-----------------+

> SELECT SUM(L_EXTENDEDPRICE * L_DISCOUNT) AS REVENUE
> FROM LINEITEM
> WHERE
> L_SHIPDATE >= DATE '1994-01-01' AND
> L_SHIPDATE < date '1995-01-01' AND
> L_DISCOUNT BETWEEN .06 - 0.01 AND .06 + 0.01 AND
> L_QUANTITY <  24;
+---------------------+
| REVENUE             |
+---------------------+
| 11803420.2534       |
+---------------------+

> SELECT SUM(L_EXTENDEDPRICE) / 7.0 AS AVG_YEARLY
> FROM LINEITEM L, PART,
> (SELECT L1.L_PARTKEY, (0.2 * AVG(L_QUANTITY)) AS AVGQTY
> FROM LINEITEM L1
> GROUP BY L1.L_PARTKEY) AS TEMP
> WHERE
> P_PARTKEY = L.L_PARTKEY AND
> P_BRAND = 'Brand#23' AND
> P_CONTAINER = 'MED BOX' AND
> P_PARTKEY = TEMP.L_PARTKEY AND
> L.L_QUANTITY < TEMP.AVGQTY;
+---------------------+
| AVG_YEARLY          |
+---------------------+
| 23512.752857        |
+---------------------+

> SELECT
> 100.00 * SUM(CASE WHEN P_TYPE LIKE 'PROMO%'
> THEN L_EXTENDEDPRICE * (1 - L_DISCOUNT)
> ELSE 0
> END) / SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT))
> AS PROMO_REVENUE
> FROM LINEITEM, PART
> WHERE L_PARTKEY = P_PARTKEY
> AND L_SHIPDATE >= DATE'1995-09-01'
> AND L_SHIPDATE < DATE'1995-10-01';
+---------------------+
| PROMO_REVENUE       |
+---------------------+
| 16.283856           |
+---------------------+

> SELECT
> P_BRAND,
> P_TYPE,
> P_SIZE,
> COUNT(DISTINCT PS_SUPPKEY) AS SUPPLIER_CNT
> FROM
> PARTSUPP,
> PART
> WHERE
> P_PARTKEY = PS_PARTKEY
> AND P_BRAND <> 'Brand#45'
> AND P_TYPE NOT LIKE 'MEDIUM POLISHED%'
> AND P_SIZE IN (49, 14, 23, 45, 19, 3, 36, 9)
> AND PS_SUPPKEY NOT IN (
> SELECT
> S_SUPPKEY
> FROM
> SUPPLIER
> WHERE
> S_COMMENT LIKE '%Customer%Complaints%'
> )
> GROUP BY
> P_BRAND,
> P_TYPE,
> P_SIZE
> ORDER BY
> SUPPLIER_CNT DESC,
> P_BRAND,
> P_TYPE,
> P_SIZE;
+------------+---------------------------+------------+---------------------+
| P_BRAND    | P_TYPE                    | P_SIZE     | SUPPLIER_CNT        |
+------------+---------------------------+------------+---------------------+
| Brand#14   | SMALL ANODIZED NICKEL     | 45         | 12                  |
| Brand#22   | SMALL BURNISHED BRASS     | 19         | 12                  |
| Brand#25   | PROMO POLISHED COPPER     | 14         | 12                  |
| Brand#35   | LARGE ANODIZED STEEL      | 45         | 12                  |
| Brand#35   | PROMO BRUSHED COPPER      | 9          | 12                  |
| Brand#51   | ECONOMY ANODIZED STEEL    | 9          | 12                  |
| Brand#53   | LARGE BRUSHED NICKEL      | 45         | 12                  |
| Brand#11   | ECONOMY POLISHED COPPER   | 14         | 8                   |
| Brand#11   | LARGE PLATED STEEL        | 23         | 8                   |
| Brand#11   | PROMO POLISHED STEEL      | 23         | 8                   |
+------------+---------------------------+------------+---------------------+

> SELECT
> C_CUSTKEY,
> C_NAME,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> C_ACCTBAL,
> N_NAME,
> C_ADDRESS,
> C_PHONE,
> C_COMMENT
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> NATION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_ORDERDATE >= date '1993-10-01'
> AND O_ORDERDATE < DATE '1994-01-01'
> AND L_RETURNFLAG = 'R'
> AND C_NATIONKEY = N_NATIONKEY
> GROUP BY
> C_CUSTKEY,
> C_NAME,
> C_ACCTBAL,
> C_PHONE,
> N_NAME,
> C_ADDRESS,
> C_COMMENT
> ORDER BY
> REVENUE DESC;
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| C_CUSTKEY  | C_NAME                    | REVENUE             | C_ACCTBAL       | N_NAME                    | C_ADDRESS                                | C_PHONE         | C_COMMENT                                                                                                             |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| 8242       | Customer#000008242        | 622786.7297         | 6322.09         | ETHIOPIA                  | P2n4nJhy,UqSo2s43YfSvYJDZ6lk             | 15-792-676-1184 | slyly regular packages haggle carefully ironic ideas. courts are furiously. furiously unusual theodolites cajole. i   |
| 7714       | Customer#000007714        | 557400.3053         | 9799.98         | IRAN                      | SnnIGB,SkmnWpX3                          | 20-922-418-6024 | arhorses according to the blithely express re                                                                         |
| 11032      | Customer#000011032        | 512500.9641         | 8496.93         | UNITED KINGDOM            | WIKHC7K3Cn7156iNOyfVG3cZ7YqkgsR,Ly       | 33-102-772-3533 | posits-- furiously ironic accounts are again                                                                          |
| 2455       | Customer#000002455        | 481592.4053         | 2070.99         | GERMANY                   | RVn1ZSRtLqPlJLIZxvpmsbgC02               | 17-946-225-9977 | al asymptotes. finally ironic accounts cajole furiously. permanently unusual theodolites aro                          |
| 12106      | Customer#000012106        | 479414.2133         | 5342.11         | UNITED STATES             | wth3twOmu6vy                             | 34-905-346-4472 | ly after the blithely regular foxes. accounts haggle carefully alongside of the blithely even ideas.                  |
| 8530       | Customer#000008530        | 457855.9467         | 9734.95         | MOROCCO                   | GMQyte94oDM7eD7exnkj 4hH9yq3             | 25-736-932-5850 | slyly asymptotes. quickly final deposits in                                                                           |
| 13984      | Customer#000013984        | 446316.5104         | 3482.28         | IRAN                      | qZXwuapCHvxbX                            | 20-981-264-2952 | y unusual courts could wake furiously                                                                                 |
| 1966       | Customer#000001966        | 444059.0382         | 1937.72         | ALGERIA                   | jPv1 UHra5JLALR5Isci5u0636RoAu7t vH      | 10-973-269-8886 | the blithely even accounts. final deposits cajole around the blithely final packages.                                 |
| 11026      | Customer#000011026        | 417913.4142         | 7738.76         | ALGERIA                   | XorIktoJOAEJkpNNMx                       | 10-184-163-4632 | ly even dolphins eat along the blithely even instructions. express attainments cajole slyly. busy dolphins in         |
| 8501       | Customer#000008501        | 412797.5100         | 6906.70         | ARGENTINA                 | 776af4rOa mZ66hczs                       | 11-317-552-5840 | y final deposits after the fluffily even accounts are slyly final, regular                                            |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+

> SELECT
> NATION,
> YYEAR,
> SUM(AMOUNT) AS SUM_PROFIT
> FROM (SELECT
> N_NAME AS NATION,
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) - PS_SUPPLYCOST * L_QUANTITY AS AMOUNT
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> PARTSUPP,
> ORDERS,
> NATION
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND PS_SUPPKEY = L_SUPPKEY
> AND PS_PARTKEY = L_PARTKEY
> AND P_PARTKEY = L_PARTKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND P_NAME LIKE '%green%'
> ) AS PROFIT
> GROUP BY
> NATION,
> YYEAR
> ORDER BY
> NATION,
> YYEAR DESC;
+---------------------------+-------+---------------------+
| NATION                    | YYEAR | SUM_PROFIT          |
+---------------------------+-------+---------------------+
| ALGERIA                   | 1998  | 2334804.6272        |
| ALGERIA                   | 1997  | 3885259.7471        |
| ALGERIA                   | 1996  | 4193307.2158        |
| ALGERIA                   | 1995  | 4159170.6827        |
| ALGERIA                   | 1994  | 4642813.9269        |
| ALGERIA                   | 1993  | 3628134.7118        |
| ALGERIA                   | 1992  | 3453838.6906        |
| ARGENTINA                 | 1998  | 3173981.1186        |
| ARGENTINA                 | 1997  | 4648199.7641        |
| ARGENTINA                 | 1996  | 5276848.2215        |
+---------------------------+-------+---------------------+

> SELECT S.S_ACCTBAL, S.S_NAME, N_NAME, PS.PS_PARTKEY, P.P_MFGR,
> S.S_ADDRESS, S.S_PHONE, S.S_COMMENT
> FROM PART P, SUPPLIER S, PARTSUPP PS, NATION, REGION,
> (SELECT PS1.PS_PARTKEY, MIN(PS1.PS_SUPPLYCOST) AS MINCOST
> FROM PARTSUPP PS1, SUPPLIER S1, NATION N1, REGION R1
> WHERE PS1.PS_SUPPKEY = S1.S_SUPPKEY AND
> S1.S_NATIONKEY = N1.N_NATIONKEY AND
> N1.N_REGIONKEY = R1.R_REGIONKEY AND
> R1.R_NAME = 'EUROPE'
> GROUP BY PS1.PS_PARTKEY) AS TEMP
> WHERE P.P_PARTKEY = PS.PS_PARTKEY AND
> S.S_SUPPKEY = PS.PS_SUPPKEY AND
> P.P_SIZE = 15 AND
> P.P_TYPE LIKE '%BRASS' AND
> S.S_NATIONKEY = N_NATIONKEY AND
> N_REGIONKEY = R_REGIONKEY AND
> PS.PS_PARTKEY = TEMP.PS_PARTKEY AND
> PS.PS_SUPPLYCOST = TEMP.MINCOST
> ORDER BY S.S_ACCTBAL DESC, N_NAME, S.S_NAME, PS.PS_PARTKEY;
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| S_ACCTBAL       | S_NAME                    | N_NAME                    | PS_PARTKEY | P_MFGR                    | S_ADDRESS                                | S_PHONE         | S_COMMENT                                                                                             |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| 9828.21         | Supplier#000000647        | UNITED KINGDOM            | 13120      | Manufacturer#5            | x5U7MBZmwfG9                             | 33-258-202-4782 | s the slyly even ideas poach fluffily                                                                 |
| 9508.37         | Supplier#000000070        | FRANCE                    | 3563       | Manufacturer#1            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9508.37         | Supplier#000000070        | FRANCE                    | 17268      | Manufacturer#4            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 10021      | Manufacturer#5            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 13275      | Manufacturer#4            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9192.10         | Supplier#000000115        | UNITED KINGDOM            | 13325      | Manufacturer#1            | nJ 2t0f7Ve,wL1,6WzGBJLNBUCKlsV           | 33-597-248-1220 | es across the carefully express accounts boost caref                                                  |
| 9032.15         | Supplier#000000959        | GERMANY                   | 4958       | Manufacturer#4            | 8grA EHBnwOZhO                           | 17-108-642-3106 | nding dependencies nag furiou                                                                         |
| 8702.02         | Supplier#000000333        | RUSSIA                    | 11810      | Manufacturer#3            | MaVf XgwPdkiX4nfJGOis8Uu2zKiIZH          | 32-508-202-6136 | oss the deposits cajole carefully even pinto beans. regular foxes detect alo                          |
| 8615.50         | Supplier#000000812        | FRANCE                    | 10551      | Manufacturer#2            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
| 8615.50         | Supplier#000000812        | FRANCE                    | 13811      | Manufacturer#4            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+

> SELECT
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) ) AS REVENUE
> FROM
> LINEITEM,
> PART
> WHERE
> P_PARTKEY = L_PARTKEY
> AND
> ((
> P_BRAND = 'Brand#12'
> AND P_CONTAINER IN ( 'SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
> AND L_QUANTITY >= 1 AND L_QUANTITY <= 1 + 10
> AND P_SIZE BETWEEN 1 AND 5
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#23'
> AND P_CONTAINER IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
> AND L_QUANTITY >= 10 AND L_QUANTITY <= 10 + 10
> AND P_SIZE BETWEEN 1 AND 10
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#34'
> AND P_CONTAINER IN ( 'LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
> AND L_QUANTITY >= 20 AND L_QUANTITY <= 20 + 10
> AND P_SIZE BETWEEN 1 AND 15
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> ));
+---------------------+
| REVENUE             |
+---------------------+
| 168597.2860         |
+---------------------+

> SELECT
> S_SUPPKEY,
> S_NAME,
> S_ADDRESS,
> S_PHONE,
> TOTAL_REVENUE
> FROM
> SUPPLIER,
> REVENUE0
> WHERE
> S_SUPPKEY = SUPPLIER_NO
> AND TOTAL_REVENUE = (
> SELECT
> MAX(TOTAL_REVENUE)
> FROM
> REVENUE0
> )
> ORDER BY
> S_SUPPKEY;
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| S_SUPPKEY  | S_NAME                    | S_ADDRESS                                | S_PHONE         | TOTAL_REVENUE       |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| 677        | Supplier#000000677        | 8mhrffG7D2WJBSQbOGstQ                    | 23-290-639-3315 | 1614410.2928        |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+

> SELECT
> YYEAR,
> CAST(SUM(CASE WHEN NATION = 'BRAZIL'
> THEN VOLUME
> ELSE 0
> END) AS DECIMAL(19,4))*1.0000 /
> CAST(SUM(VOLUME) AS DECIMAL(19,4)) AS MKT_SHARE
> FROM (SELECT
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME,
> N2.N_NAME AS NATION
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2,
> REGION
> WHERE
> P_PARTKEY = L_PARTKEY
> AND S_SUPPKEY = L_SUPPKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_CUSTKEY = C_CUSTKEY
> AND C_NATIONKEY = N1.N_NATIONKEY
> AND N1.N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'AMERICA'
> AND S_NATIONKEY = N2.N_NATIONKEY
> AND O_ORDERDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> AND P_TYPE = 'ECONOMY ANODIZED STEEL') AS ALL_NATIONS
> GROUP BY YYEAR
> ORDER BY YYEAR;
+-------+---------------------+
| YYEAR | MKT_SHARE           |
+-------+---------------------+
| 1995  | 0.028649            |
| 1996  | 0.018250            |
+-------+---------------------+

> SELECT
> N_NAME,
> SUM(L_EXTENDEDPRICE * ( 1 - L_DISCOUNT)) AS REVENUE
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> SUPPLIER,
> NATION,
> REGION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND L_SUPPKEY = S_SUPPKEY
> AND C_NATIONKEY = S_NATIONKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'ASIA'
> AND O_ORDERDATE >=  date '1994-01-01'
> AND O_ORDERDATE < DATE '1995-01-01'
> GROUP BY
> N_NAME
> ORDER BY
> REVENUE DESC;
+---------------------------+---------------------+
| N_NAME                    | REVENUE             |
+---------------------------+---------------------+
| CHINA                     | 7822103.0000        |
| INDIA                     | 6376121.5085        |
| JAPAN                     | 6000077.2184        |
| INDONESIA                 | 5580475.4027        |
| VIETNAM                   | 4497840.5466        |
+---------------------------+---------------------+

> SELECT
> L_SHIPMODE,
> SUM(CASE WHEN O_ORDERPRIORITY = '1-URGENT'
> OR O_ORDERPRIORITY = '2-HIGH'
> THEN 1
> ELSE 0
> END) AS HIGH_LINE_COUNT,
> SUM(CASE WHEN O_ORDERPRIORITY <> '1-URGENT'
> AND O_ORDERPRIORITY <> '2-HIGH'
> THEN 1
> ELSE 0
> END) AS LOW_LINE_COUNT
> FROM ORDERS, LINEITEM
> WHERE
> O_ORDERKEY = L_ORDERKEY
> AND L_SHIPMODE IN ('MAIL', 'SHIP')
> AND L_COMMITDATE < L_RECEIPTDATE
> AND L_SHIPDATE < L_COMMITDATE
> AND L_RECEIPTDATE >= DATE'1994-01-01'
> AND L_RECEIPTDATE < DATE'1995-01-01'
> GROUP BY L_SHIPMODE
> ORDER BY L_SHIPMODE;
+------------+-----------------+----------------+
| L_SHIPMODE | HIGH_LINE_COUNT | LOW_LINE_COUNT |
+------------+-----------------+----------------+
| MAIL       | 647             | 945            |
| SHIP       | 620             | 943            |
+------------+-----------------+----------------+

> SELECT
> SUPP_NATION,
> CUST_NATION,
> YYEAR,
> SUM(VOLUME) AS REVENUE
> FROM
> (SELECT
> N1.N_NAME AS SUPP_NATION,
> N2.N_NAME AS CUST_NATION,
> APPLIB.DATE_TO_CHAR('yyyy', L_SHIPDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME
> FROM
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND C_CUSTKEY = O_CUSTKEY
> AND S_NATIONKEY = N1.N_NATIONKEY
> AND C_NATIONKEY = N2.N_NATIONKEY
> AND ((N1.N_NAME = 'FRANCE' AND N2.N_NAME = 'GERMANY')
> OR (N1.N_NAME = 'GERMANY' AND N2.N_NAME = 'FRANCE'))
> AND L_SHIPDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> ) AS SHIPPING
> GROUP BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR
> ORDER BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR;
+---------------------------+---------------------------+-------+---------------------+
| SUPP_NATION               | CUST_NATION               | YYEAR | REVENUE             |
+---------------------------+---------------------------+-------+---------------------+
| FRANCE                    | GERMANY                   | 1995  | 4637235.1501        |
| FRANCE                    | GERMANY                   | 1996  | 5224779.5736        |
| GERMANY                   | FRANCE                    | 1995  | 6232818.7037        |
| GERMANY                   | FRANCE                    | 1996  | 5557312.1121        |
+---------------------------+---------------------------+-------+---------------------+

> SELECT
> C_COUNT, COUNT(*) AS CUSTDIST
> FROM (
> SELECT
> C_CUSTKEY,
> COUNT(O_ORDERKEY)
> FROM
> CUSTOMER LEFT OUTER JOIN ORDERS ON
> C_CUSTKEY = O_CUSTKEY
> AND O_COMMENT NOT LIKE '%special%requests%'
> GROUP BY
> C_CUSTKEY
> )AS C_ORDERS (C_CUSTKEY, C_COUNT)
> GROUP BY
> C_COUNT
> ORDER BY
> CUSTDIST DESC,
> C_COUNT DESC;
+---------------------+---------------------+
| C_COUNT             | CUSTDIST            |
+---------------------+---------------------+
| 0                   | 5000                |
| 10                  | 665                 |
| 9                   | 657                 |
| 11                  | 621                 |
| 12                  | 567                 |
| 8                   | 564                 |
| 13                  | 492                 |
| 18                  | 482                 |
| 7                   | 480                 |
| 20                  | 456                 |
| 14                  | 456                 |
| 16                  | 449                 |
| 19                  | 447                 |
| 15                  | 432                 |
| 17                  | 423                 |
| 21                  | 412                 |
| 22                  | 371                 |
| 6                   | 337                 |
| 23                  | 323                 |
| 24                  | 256                 |
| 25                  | 204                 |
| 5                   | 204                 |
| 26                  | 155                 |
| 27                  | 141                 |
| 28                  | 97                  |
| 4                   | 94                  |
| 29                  | 64                  |
| 3                   | 48                  |
| 30                  | 27                  |
| 31                  | 26                  |
| 32                  | 14                  |
| 33                  | 11                  |
| 2                   | 11                  |
| 34                  | 6                   |
| 35                  | 5                   |
| 1                   | 2                   |
| 36                  | 1                   |
+---------------------+---------------------+

> SELECT
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE,
> SUM(L_QUANTITY)
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> O_ORDERKEY IN (
> SELECT
> L_ORDERKEY
> FROM
> LINEITEM
> GROUP BY
> L_ORDERKEY
> HAVING
> SUM(L_QUANTITY) > 300
> )
> AND C_CUSTKEY = O_CUSTKEY
> AND O_ORDERKEY = L_ORDERKEY
> GROUP BY
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE
> ORDER BY
> O_TOTALPRICE DESC,
> O_ORDERDATE;
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| C_NAME                    | C_CUSTKEY  | O_ORDERKEY | O_ORDERDATE | O_TOTALPRICE    | EXPR$5          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| Customer#000001639        | 1639       | 502886     | 1994-04-12  | 456423.88       | 312.00          |
| Customer#000006655        | 6655       | 29158      | 1995-10-21  | 452805.02       | 305.00          |
| Customer#000014110        | 14110      | 565574     | 1995-09-24  | 425099.85       | 301.00          |
| Customer#000001775        | 1775       | 6882       | 1997-04-09  | 408368.10       | 303.00          |
| Customer#000011459        | 11459      | 551136     | 1993-05-19  | 386812.74       | 308.00          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+

> SELECT
> L_RETURNFLAG,
> L_LINESTATUS,
> SUM(L_QUANTITY) AS SUM_QTY,
> SUM(L_EXTENDEDPRICE) AS SUM_BASE_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS SUM_DISC_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) * (1 + L_TAX)) AS SUM_CHARGE,
> AVG(L_QUANTITY) AS AVG_QTY,
> AVG(L_EXTENDEDPRICE) AS AVG_PRICE,
> AVG(L_DISCOUNT) AS AVG_DISC,
> COUNT(*) AS COUNT_ORDER
> FROM
> LINEITEM
> WHERE
> L_SHIPDATE <=  APPLIB.ADD_DAYS(DATE '1998-12-01', -90)
> GROUP BY
> L_RETURNFLAG,
> L_LINESTATUS
> ORDER BY
> L_RETURNFLAG,
> L_LINESTATUS;
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| L_RETURNFLAG | L_LINESTATUS | SUM_QTY         | SUM_BASE_PRICE  | SUM_DISC_PRICE      | SUM_CHARGE          | AVG_QTY         | AVG_PRICE       | AVG_DISC        | COUNT_ORDER         |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| A            | F            | 3774200.00      | 5320753880.69   | 5054096266.6828     | 5256751331.449234   | 25.54           | 36002.12        | 0.05            | 147790              |
| N            | F            | 95257.00        | 133737795.84    | 127132372.6512      | 132286291.229445    | 25.30           | 35521.33        | 0.05            | 3765                |
| N            | O            | 7459297.00      | 10512270008.90  | 9986238338.3847     | 10385578376.585467  | 25.55           | 36000.92        | 0.05            | 292000              |
| R            | F            | 3785523.00      | 5337950526.47   | 5071818532.9420     | 5274405503.049367   | 25.53           | 35994.03        | 0.05            | 148301              |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+

> SELECT
> O_ORDERPRIORITY,
> COUNT(*) AS ORDER_COUNT
> FROM ORDERS
> WHERE
> O_ORDERDATE >= DATE '1993-07-01'
> AND O_ORDERDATE < DATE '1993-10-01'
> AND EXISTS (
> SELECT
> *
> FROM
> LINEITEM
> WHERE
> L_ORDERKEY = O_ORDERKEY
> AND L_COMMITDATE < L_RECEIPTDATE
> )
> GROUP BY
> O_ORDERPRIORITY
> ORDER BY
> O_ORDERPRIORITY;
+-----------------+---------------------+
| O_ORDERPRIORITY | ORDER_COUNT         |
+-----------------+---------------------+
| 1-URGENT        | 999                 |
| 2-HIGH          | 997                 |
| 3-MEDIUM        | 1031                |
| 4-NOT SPECIFIED | 989                 |
| 5-LOW           | 1077                |
+-----------------+---------------------+

> SELECT
> S_NAME,
> S_ADDRESS
> FROM
> SUPPLIER,
> NATION
> WHERE
> S_SUPPKEY IN (
> SELECT
> PS_SUPPKEY
> FROM
> PARTSUPP
> WHERE
> PS_PARTKEY IN (
> SELECT
> P_PARTKEY
> FROM
> PART
> WHERE
> P_NAME LIKE 'forest%'
> )
> AND PS_AVAILQTY > (
> SELECT
> 0.5 * SUM(L_QUANTITY)
> FROM
> LINEITEM
> WHERE
> L_PARTKEY = PS_PARTKEY
> AND L_SUPPKEY = PS_SUPPKEY
> AND L_SHIPDATE >= DATE '1994-01-01'
> AND L_SHIPDATE < DATE '1995-01-01'
> )
> )
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'CANADA'
> ORDER BY
> S_NAME;
+---------------------------+------------------------------------------+
| S_NAME                    | S_ADDRESS                                |
+---------------------------+------------------------------------------+
| Supplier#000000013        | HK71HQyWoqRWOX8GI FpgAifW,2PoH           |
| Supplier#000000020        | iybAE,RmTymrZVYaFZva2SH,j                |
| Supplier#000000091        | YV45D7TkfdQanOOZ7q9QxkyGUapU1oOWU6q3     |
| Supplier#000000157        | ,mEGorBfVIm                              |
| Supplier#000000197        | YC2Acon6kjY3zj3Fbxs2k4Vdf7X0cd2F         |
| Supplier#000000205        | rF uV8d0JNEk                             |
| Supplier#000000285        | Br7e1nnt1yxrw6ImgpJ7YdhFDjuBf            |
| Supplier#000000287        | 7a9SP7qW5Yku5PvSg                        |
| Supplier#000000358        | V3yxhHhHSXqOoc5UPv5TwkVDGKQsG            |
| Supplier#000000402        | i9Sw4DoyMhzhKXCH9By,AYSgmD               |
| Supplier#000000431        | WoeV,NINojE6hJjauAdrl5fGcdxX5JUPLnrim    |
| Supplier#000000530        | 0qwCMwobKY OcmLyfRXlagA8ukENJv,          |
| Supplier#000000555        | TfB,a5bfl3Ah 3Z 74GqnNs6zKVGM            |
| Supplier#000000557        | jj0wUYh9K3fG5Jhdhrkuy ,4                 |
| Supplier#000000640        | mvvtlQKsTOsJj5Ihk7,cq                    |
| Supplier#000000729        | pqck2ppy758TQpZCUAjPvlU55K3QjfL7Bi       |
| Supplier#000000736        | l6i2nMwVuovfKnuVgaSGK2rDy65DlAFLegiL7    |
| Supplier#000000744        | 5NKuw5W4mFDMQBbUjUO4k kfokG8yvAe         |
| Supplier#000000752        | l cHMtEnodxj3FV                          |
| Supplier#000000848        | tx44JAuF,Jnw1                            |
| Supplier#000000997        | 7eUWMrOCKCp2JYas6P4mL93eaWIOtKKWtTX      |
+---------------------------+------------------------------------------+

> SELECT
> L_ORDERKEY,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> O_ORDERDATE,
> O_SHIPPRIORITY
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> C_MKTSEGMENT = 'BUILDING' AND
> C_CUSTKEY = O_CUSTKEY AND
> L_ORDERKEY = O_ORDERKEY AND
> O_ORDERDATE < DATE '1995-03-15' AND
> L_SHIPDATE > DATE '1995-03-15'
> GROUP BY
> L_ORDERKEY,
> O_ORDERDATE,
> O_SHIPPRIORITY
> ORDER BY
> REVENUE DESC,
> O_ORDERDATE;
+------------+---------------------+-------------+----------------+
| L_ORDERKEY | REVENUE             | O_ORDERDATE | O_SHIPPRIORITY |
+------------+---------------------+-------------+----------------+
| 223140     | 355369.0698         | 1995-03-14  | 0              |
| 584291     | 354494.7318         | 1995-02-21  | 0              |
| 405063     | 353125.4577         | 1995-03-03  | 0              |
| 573861     | 351238.2770         | 1995-03-09  | 0              |
| 554757     | 349181.7426         | 1995-03-14  | 0              |
| 506021     | 321075.5810         | 1995-03-10  | 0              |
| 121604     | 318576.4154         | 1995-03-07  | 0              |
| 108514     | 314967.0754         | 1995-02-20  | 0              |
| 462502     | 312604.5420         | 1995-03-08  | 0              |
| 178727     | 309728.9306         | 1995-02-25  | 0              |
+------------+---------------------+-------------+----------------+

> SELECT
> PS_PARTKEY,
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) AS VAL
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> GROUP BY
> PS_PARTKEY HAVING
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) > (
> SELECT
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) * (0.0001 / 0.1)
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> )
> ORDER BY
> VAL DESC;
+------------+---------------------+
| PS_PARTKEY | VAL                 |
+------------+---------------------+
| 12098      | 16227681.21         |
| 5134       | 15709338.52         |
| 13334      | 15023662.41         |
| 17052      | 14351644.20         |
| 3452       | 14070870.14         |
| 12552      | 13332469.18         |
| 1084       | 13170428.29         |
| 5797       | 13038622.72         |
| 12633      | 12892561.61         |
| 403        | 12856217.34         |
| 1833       | 12024581.72         |
| 2084       | 11502875.36         |
| 17349      | 11354213.05         |
| 18427      | 11282385.24         |
| 2860       | 11262529.95         |
| 17852      | 10934711.93         |
| 9871       | 10889253.68         |
| 12231      | 10841131.39         |
| 6366       | 10759786.81         |
| 12146      | 10257362.66         |
| 5043       | 10226395.88         |
| 12969      | 10125777.93         |
+------------+---------------------+

> SELECT
> YYEAR,
> CAST(SUM(CASE WHEN NATION = 'BRAZIL'
> THEN VOLUME
> ELSE 0
> END) AS DECIMAL(19,4))*1.0000 /
> CAST(SUM(VOLUME) AS DECIMAL(19,4)) AS MKT_SHARE
> FROM (SELECT
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME,
> N2.N_NAME AS NATION
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2,
> REGION
> WHERE
> P_PARTKEY = L_PARTKEY
> AND S_SUPPKEY = L_SUPPKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_CUSTKEY = C_CUSTKEY
> AND C_NATIONKEY = N1.N_NATIONKEY
> AND N1.N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'AMERICA'
> AND S_NATIONKEY = N2.N_NATIONKEY
> AND O_ORDERDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> AND P_TYPE = 'ECONOMY ANODIZED STEEL') AS ALL_NATIONS
> GROUP BY YYEAR
> ORDER BY YYEAR;
+-------+---------------------+
| YYEAR | MKT_SHARE           |
+-------+---------------------+
| 1995  | 0.028649            |
| 1996  | 0.018250            |
+-------+---------------------+

> SELECT
> N_NAME,
> SUM(L_EXTENDEDPRICE * ( 1 - L_DISCOUNT)) AS REVENUE
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> SUPPLIER,
> NATION,
> REGION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND L_SUPPKEY = S_SUPPKEY
> AND C_NATIONKEY = S_NATIONKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'ASIA'
> AND O_ORDERDATE >=  date '1994-01-01'
> AND O_ORDERDATE < DATE '1995-01-01'
> GROUP BY
> N_NAME
> ORDER BY
> REVENUE DESC;
+---------------------------+---------------------+
| N_NAME                    | REVENUE             |
+---------------------------+---------------------+
| CHINA                     | 7822103.0000        |
| INDIA                     | 6376121.5085        |
| JAPAN                     | 6000077.2184        |
| INDONESIA                 | 5580475.4027        |
| VIETNAM                   | 4497840.5466        |
+---------------------------+---------------------+

> SELECT
> O_ORDERPRIORITY,
> COUNT(*) AS ORDER_COUNT
> FROM ORDERS
> WHERE
> O_ORDERDATE >= DATE '1993-07-01'
> AND O_ORDERDATE < DATE '1993-10-01'
> AND EXISTS (
> SELECT
> *
> FROM
> LINEITEM
> WHERE
> L_ORDERKEY = O_ORDERKEY
> AND L_COMMITDATE < L_RECEIPTDATE
> )
> GROUP BY
> O_ORDERPRIORITY
> ORDER BY
> O_ORDERPRIORITY;
+-----------------+---------------------+
| O_ORDERPRIORITY | ORDER_COUNT         |
+-----------------+---------------------+
| 1-URGENT        | 999                 |
| 2-HIGH          | 997                 |
| 3-MEDIUM        | 1031                |
| 4-NOT SPECIFIED | 989                 |
| 5-LOW           | 1077                |
+-----------------+---------------------+

> SELECT SUM(L_EXTENDEDPRICE * L_DISCOUNT) AS REVENUE
> FROM LINEITEM
> WHERE
> L_SHIPDATE >= DATE '1994-01-01' AND
> L_SHIPDATE < date '1995-01-01' AND
> L_DISCOUNT BETWEEN .06 - 0.01 AND .06 + 0.01 AND
> L_QUANTITY <  24;
+---------------------+
| REVENUE             |
+---------------------+
| 11803420.2534       |
+---------------------+

> SELECT SUM(L_EXTENDEDPRICE) / 7.0 AS AVG_YEARLY
> FROM LINEITEM L, PART,
> (SELECT L1.L_PARTKEY, (0.2 * AVG(L_QUANTITY)) AS AVGQTY
> FROM LINEITEM L1
> GROUP BY L1.L_PARTKEY) AS TEMP
> WHERE
> P_PARTKEY = L.L_PARTKEY AND
> P_BRAND = 'Brand#23' AND
> P_CONTAINER = 'MED BOX' AND
> P_PARTKEY = TEMP.L_PARTKEY AND
> L.L_QUANTITY < TEMP.AVGQTY;
+---------------------+
| AVG_YEARLY          |
+---------------------+
| 23512.752857        |
+---------------------+

> SELECT
> SUPP_NATION,
> CUST_NATION,
> YYEAR,
> SUM(VOLUME) AS REVENUE
> FROM
> (SELECT
> N1.N_NAME AS SUPP_NATION,
> N2.N_NAME AS CUST_NATION,
> APPLIB.DATE_TO_CHAR('yyyy', L_SHIPDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME
> FROM
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND C_CUSTKEY = O_CUSTKEY
> AND S_NATIONKEY = N1.N_NATIONKEY
> AND C_NATIONKEY = N2.N_NATIONKEY
> AND ((N1.N_NAME = 'FRANCE' AND N2.N_NAME = 'GERMANY')
> OR (N1.N_NAME = 'GERMANY' AND N2.N_NAME = 'FRANCE'))
> AND L_SHIPDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> ) AS SHIPPING
> GROUP BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR
> ORDER BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR;
+---------------------------+---------------------------+-------+---------------------+
| SUPP_NATION               | CUST_NATION               | YYEAR | REVENUE             |
+---------------------------+---------------------------+-------+---------------------+
| FRANCE                    | GERMANY                   | 1995  | 4637235.1501        |
| FRANCE                    | GERMANY                   | 1996  | 5224779.5736        |
| GERMANY                   | FRANCE                    | 1995  | 6232818.7037        |
| GERMANY                   | FRANCE                    | 1996  | 5557312.1121        |
+---------------------------+---------------------------+-------+---------------------+

> SELECT
> L_RETURNFLAG,
> L_LINESTATUS,
> SUM(L_QUANTITY) AS SUM_QTY,
> SUM(L_EXTENDEDPRICE) AS SUM_BASE_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS SUM_DISC_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) * (1 + L_TAX)) AS SUM_CHARGE,
> AVG(L_QUANTITY) AS AVG_QTY,
> AVG(L_EXTENDEDPRICE) AS AVG_PRICE,
> AVG(L_DISCOUNT) AS AVG_DISC,
> COUNT(*) AS COUNT_ORDER
> FROM
> LINEITEM
> WHERE
> L_SHIPDATE <=  APPLIB.ADD_DAYS(DATE '1998-12-01', -90)
> GROUP BY
> L_RETURNFLAG,
> L_LINESTATUS
> ORDER BY
> L_RETURNFLAG,
> L_LINESTATUS;
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| L_RETURNFLAG | L_LINESTATUS | SUM_QTY         | SUM_BASE_PRICE  | SUM_DISC_PRICE      | SUM_CHARGE          | AVG_QTY         | AVG_PRICE       | AVG_DISC        | COUNT_ORDER         |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| A            | F            | 3774200.00      | 5320753880.69   | 5054096266.6828     | 5256751331.449234   | 25.54           | 36002.12        | 0.05            | 147790              |
| N            | F            | 95257.00        | 133737795.84    | 127132372.6512      | 132286291.229445    | 25.30           | 35521.33        | 0.05            | 3765                |
| N            | O            | 7459297.00      | 10512270008.90  | 9986238338.3847     | 10385578376.585467  | 25.55           | 36000.92        | 0.05            | 292000              |
| R            | F            | 3785523.00      | 5337950526.47   | 5071818532.9420     | 5274405503.049367   | 25.53           | 35994.03        | 0.05            | 148301              |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+

> SELECT
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE,
> SUM(L_QUANTITY)
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> O_ORDERKEY IN (
> SELECT
> L_ORDERKEY
> FROM
> LINEITEM
> GROUP BY
> L_ORDERKEY
> HAVING
> SUM(L_QUANTITY) > 300
> )
> AND C_CUSTKEY = O_CUSTKEY
> AND O_ORDERKEY = L_ORDERKEY
> GROUP BY
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE
> ORDER BY
> O_TOTALPRICE DESC,
> O_ORDERDATE;
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| C_NAME                    | C_CUSTKEY  | O_ORDERKEY | O_ORDERDATE | O_TOTALPRICE    | EXPR$5          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| Customer#000001639        | 1639       | 502886     | 1994-04-12  | 456423.88       | 312.00          |
| Customer#000006655        | 6655       | 29158      | 1995-10-21  | 452805.02       | 305.00          |
| Customer#000014110        | 14110      | 565574     | 1995-09-24  | 425099.85       | 301.00          |
| Customer#000001775        | 1775       | 6882       | 1997-04-09  | 408368.10       | 303.00          |
| Customer#000011459        | 11459      | 551136     | 1993-05-19  | 386812.74       | 308.00          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+

> SELECT
> 100.00 * SUM(CASE WHEN P_TYPE LIKE 'PROMO%'
> THEN L_EXTENDEDPRICE * (1 - L_DISCOUNT)
> ELSE 0
> END) / SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT))
> AS PROMO_REVENUE
> FROM LINEITEM, PART
> WHERE L_PARTKEY = P_PARTKEY
> AND L_SHIPDATE >= DATE'1995-09-01'
> AND L_SHIPDATE < DATE'1995-10-01';
+---------------------+
| PROMO_REVENUE       |
+---------------------+
| 16.283856           |
+---------------------+

> SELECT
> NATION,
> YYEAR,
> SUM(AMOUNT) AS SUM_PROFIT
> FROM (SELECT
> N_NAME AS NATION,
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) - PS_SUPPLYCOST * L_QUANTITY AS AMOUNT
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> PARTSUPP,
> ORDERS,
> NATION
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND PS_SUPPKEY = L_SUPPKEY
> AND PS_PARTKEY = L_PARTKEY
> AND P_PARTKEY = L_PARTKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND P_NAME LIKE '%green%'
> ) AS PROFIT
> GROUP BY
> NATION,
> YYEAR
> ORDER BY
> NATION,
> YYEAR DESC;
+---------------------------+-------+---------------------+
| NATION                    | YYEAR | SUM_PROFIT          |
+---------------------------+-------+---------------------+
| ALGERIA                   | 1998  | 2334804.6272        |
| ALGERIA                   | 1997  | 3885259.7471        |
| ALGERIA                   | 1996  | 4193307.2158        |
| ALGERIA                   | 1995  | 4159170.6827        |
| ALGERIA                   | 1994  | 4642813.9269        |
| ALGERIA                   | 1993  | 3628134.7118        |
| ALGERIA                   | 1992  | 3453838.6906        |
| ARGENTINA                 | 1998  | 3173981.1186        |
| ARGENTINA                 | 1997  | 4648199.7641        |
| ARGENTINA                 | 1996  | 5276848.2215        |
+---------------------------+-------+---------------------+

> SELECT
> C_CUSTKEY,
> C_NAME,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> C_ACCTBAL,
> N_NAME,
> C_ADDRESS,
> C_PHONE,
> C_COMMENT
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> NATION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_ORDERDATE >= date '1993-10-01'
> AND O_ORDERDATE < DATE '1994-01-01'
> AND L_RETURNFLAG = 'R'
> AND C_NATIONKEY = N_NATIONKEY
> GROUP BY
> C_CUSTKEY,
> C_NAME,
> C_ACCTBAL,
> C_PHONE,
> N_NAME,
> C_ADDRESS,
> C_COMMENT
> ORDER BY
> REVENUE DESC;
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| C_CUSTKEY  | C_NAME                    | REVENUE             | C_ACCTBAL       | N_NAME                    | C_ADDRESS                                | C_PHONE         | C_COMMENT                                                                                                             |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| 8242       | Customer#000008242        | 622786.7297         | 6322.09         | ETHIOPIA                  | P2n4nJhy,UqSo2s43YfSvYJDZ6lk             | 15-792-676-1184 | slyly regular packages haggle carefully ironic ideas. courts are furiously. furiously unusual theodolites cajole. i   |
| 7714       | Customer#000007714        | 557400.3053         | 9799.98         | IRAN                      | SnnIGB,SkmnWpX3                          | 20-922-418-6024 | arhorses according to the blithely express re                                                                         |
| 11032      | Customer#000011032        | 512500.9641         | 8496.93         | UNITED KINGDOM            | WIKHC7K3Cn7156iNOyfVG3cZ7YqkgsR,Ly       | 33-102-772-3533 | posits-- furiously ironic accounts are again                                                                          |
| 2455       | Customer#000002455        | 481592.4053         | 2070.99         | GERMANY                   | RVn1ZSRtLqPlJLIZxvpmsbgC02               | 17-946-225-9977 | al asymptotes. finally ironic accounts cajole furiously. permanently unusual theodolites aro                          |
| 12106      | Customer#000012106        | 479414.2133         | 5342.11         | UNITED STATES             | wth3twOmu6vy                             | 34-905-346-4472 | ly after the blithely regular foxes. accounts haggle carefully alongside of the blithely even ideas.                  |
| 8530       | Customer#000008530        | 457855.9467         | 9734.95         | MOROCCO                   | GMQyte94oDM7eD7exnkj 4hH9yq3             | 25-736-932-5850 | slyly asymptotes. quickly final deposits in                                                                           |
| 13984      | Customer#000013984        | 446316.5104         | 3482.28         | IRAN                      | qZXwuapCHvxbX                            | 20-981-264-2952 | y unusual courts could wake furiously                                                                                 |
| 1966       | Customer#000001966        | 444059.0382         | 1937.72         | ALGERIA                   | jPv1 UHra5JLALR5Isci5u0636RoAu7t vH      | 10-973-269-8886 | the blithely even accounts. final deposits cajole around the blithely final packages.                                 |
| 11026      | Customer#000011026        | 417913.4142         | 7738.76         | ALGERIA                   | XorIktoJOAEJkpNNMx                       | 10-184-163-4632 | ly even dolphins eat along the blithely even instructions. express attainments cajole slyly. busy dolphins in         |
| 8501       | Customer#000008501        | 412797.5100         | 6906.70         | ARGENTINA                 | 776af4rOa mZ66hczs                       | 11-317-552-5840 | y final deposits after the fluffily even accounts are slyly final, regular                                            |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+

> SELECT
> S_SUPPKEY,
> S_NAME,
> S_ADDRESS,
> S_PHONE,
> TOTAL_REVENUE
> FROM
> SUPPLIER,
> REVENUE0
> WHERE
> S_SUPPKEY = SUPPLIER_NO
> AND TOTAL_REVENUE = (
> SELECT
> MAX(TOTAL_REVENUE)
> FROM
> REVENUE0
> )
> ORDER BY
> S_SUPPKEY;
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| S_SUPPKEY  | S_NAME                    | S_ADDRESS                                | S_PHONE         | TOTAL_REVENUE       |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| 677        | Supplier#000000677        | 8mhrffG7D2WJBSQbOGstQ                    | 23-290-639-3315 | 1614410.2928        |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+

> SELECT
> PS_PARTKEY,
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) AS VAL
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> GROUP BY
> PS_PARTKEY HAVING
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) > (
> SELECT
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) * (0.0001 / 0.1)
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> )
> ORDER BY
> VAL DESC;
+------------+---------------------+
| PS_PARTKEY | VAL                 |
+------------+---------------------+
| 12098      | 16227681.21         |
| 5134       | 15709338.52         |
| 13334      | 15023662.41         |
| 17052      | 14351644.20         |
| 3452       | 14070870.14         |
| 12552      | 13332469.18         |
| 1084       | 13170428.29         |
| 5797       | 13038622.72         |
| 12633      | 12892561.61         |
| 403        | 12856217.34         |
| 1833       | 12024581.72         |
| 2084       | 11502875.36         |
| 17349      | 11354213.05         |
| 18427      | 11282385.24         |
| 2860       | 11262529.95         |
| 17852      | 10934711.93         |
| 9871       | 10889253.68         |
| 12231      | 10841131.39         |
| 6366       | 10759786.81         |
| 12146      | 10257362.66         |
| 5043       | 10226395.88         |
| 12969      | 10125777.93         |
+------------+---------------------+

> SELECT
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) ) AS REVENUE
> FROM
> LINEITEM,
> PART
> WHERE
> P_PARTKEY = L_PARTKEY
> AND
> ((
> P_BRAND = 'Brand#12'
> AND P_CONTAINER IN ( 'SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
> AND L_QUANTITY >= 1 AND L_QUANTITY <= 1 + 10
> AND P_SIZE BETWEEN 1 AND 5
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#23'
> AND P_CONTAINER IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
> AND L_QUANTITY >= 10 AND L_QUANTITY <= 10 + 10
> AND P_SIZE BETWEEN 1 AND 10
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#34'
> AND P_CONTAINER IN ( 'LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
> AND L_QUANTITY >= 20 AND L_QUANTITY <= 20 + 10
> AND P_SIZE BETWEEN 1 AND 15
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> ));
+---------------------+
| REVENUE             |
+---------------------+
| 168597.2860         |
+---------------------+

> SELECT
> CNTRYCODE,
> COUNT(*) AS NUMCUST,
> SUM(C_ACCTBAL) AS TOTACCTBAL
> FROM (
> SELECT
> SUBSTRING(C_PHONE FROM 1 FOR 2) AS CNTRYCODE,
> C_ACCTBAL
> FROM
> CUSTOMER
> WHERE
> SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> AND C_ACCTBAL > (
> SELECT
> AVG(C_ACCTBAL)
> FROM
> CUSTOMER
> WHERE
> C_ACCTBAL > 0.00
> AND SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> )
> AND NOT EXISTS (
> SELECT
> *
> FROM
> ORDERS
> WHERE
> O_CUSTKEY = C_CUSTKEY
> )
> ) AS CUSTSALE
> GROUP BY
> CNTRYCODE
> ORDER BY
> CNTRYCODE;
+-----------------+---------------------+-----------------+
| CNTRYCODE       | NUMCUST             | TOTACCTBAL      |
+-----------------+---------------------+-----------------+
| 13              | 94                  | 714035.05       |
| 17              | 96                  | 722560.15       |
| 18              | 99                  | 738012.52       |
| 23              | 93                  | 708285.25       |
| 29              | 85                  | 632693.46       |
| 30              | 87                  | 646748.02       |
| 31              | 87                  | 647372.50       |
+-----------------+---------------------+-----------------+

> SELECT
> S_NAME,
> S_ADDRESS
> FROM
> SUPPLIER,
> NATION
> WHERE
> S_SUPPKEY IN (
> SELECT
> PS_SUPPKEY
> FROM
> PARTSUPP
> WHERE
> PS_PARTKEY IN (
> SELECT
> P_PARTKEY
> FROM
> PART
> WHERE
> P_NAME LIKE 'forest%'
> )
> AND PS_AVAILQTY > (
> SELECT
> 0.5 * SUM(L_QUANTITY)
> FROM
> LINEITEM
> WHERE
> L_PARTKEY = PS_PARTKEY
> AND L_SUPPKEY = PS_SUPPKEY
> AND L_SHIPDATE >= DATE '1994-01-01'
> AND L_SHIPDATE < DATE '1995-01-01'
> )
> )
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'CANADA'
> ORDER BY
> S_NAME;
+---------------------------+------------------------------------------+
| S_NAME                    | S_ADDRESS                                |
+---------------------------+------------------------------------------+
| Supplier#000000013        | HK71HQyWoqRWOX8GI FpgAifW,2PoH           |
| Supplier#000000020        | iybAE,RmTymrZVYaFZva2SH,j                |
| Supplier#000000091        | YV45D7TkfdQanOOZ7q9QxkyGUapU1oOWU6q3     |
| Supplier#000000157        | ,mEGorBfVIm                              |
| Supplier#000000197        | YC2Acon6kjY3zj3Fbxs2k4Vdf7X0cd2F         |
| Supplier#000000205        | rF uV8d0JNEk                             |
| Supplier#000000285        | Br7e1nnt1yxrw6ImgpJ7YdhFDjuBf            |
| Supplier#000000287        | 7a9SP7qW5Yku5PvSg                        |
| Supplier#000000358        | V3yxhHhHSXqOoc5UPv5TwkVDGKQsG            |
| Supplier#000000402        | i9Sw4DoyMhzhKXCH9By,AYSgmD               |
| Supplier#000000431        | WoeV,NINojE6hJjauAdrl5fGcdxX5JUPLnrim    |
| Supplier#000000530        | 0qwCMwobKY OcmLyfRXlagA8ukENJv,          |
| Supplier#000000555        | TfB,a5bfl3Ah 3Z 74GqnNs6zKVGM            |
| Supplier#000000557        | jj0wUYh9K3fG5Jhdhrkuy ,4                 |
| Supplier#000000640        | mvvtlQKsTOsJj5Ihk7,cq                    |
| Supplier#000000729        | pqck2ppy758TQpZCUAjPvlU55K3QjfL7Bi       |
| Supplier#000000736        | l6i2nMwVuovfKnuVgaSGK2rDy65DlAFLegiL7    |
| Supplier#000000744        | 5NKuw5W4mFDMQBbUjUO4k kfokG8yvAe         |
| Supplier#000000752        | l cHMtEnodxj3FV                          |
| Supplier#000000848        | tx44JAuF,Jnw1                            |
| Supplier#000000997        | 7eUWMrOCKCp2JYas6P4mL93eaWIOtKKWtTX      |
+---------------------------+------------------------------------------+

> SELECT S.S_ACCTBAL, S.S_NAME, N_NAME, PS.PS_PARTKEY, P.P_MFGR,
> S.S_ADDRESS, S.S_PHONE, S.S_COMMENT
> FROM PART P, SUPPLIER S, PARTSUPP PS, NATION, REGION,
> (SELECT PS1.PS_PARTKEY, MIN(PS1.PS_SUPPLYCOST) AS MINCOST
> FROM PARTSUPP PS1, SUPPLIER S1, NATION N1, REGION R1
> WHERE PS1.PS_SUPPKEY = S1.S_SUPPKEY AND
> S1.S_NATIONKEY = N1.N_NATIONKEY AND
> N1.N_REGIONKEY = R1.R_REGIONKEY AND
> R1.R_NAME = 'EUROPE'
> GROUP BY PS1.PS_PARTKEY) AS TEMP
> WHERE P.P_PARTKEY = PS.PS_PARTKEY AND
> S.S_SUPPKEY = PS.PS_SUPPKEY AND
> P.P_SIZE = 15 AND
> P.P_TYPE LIKE '%BRASS' AND
> S.S_NATIONKEY = N_NATIONKEY AND
> N_REGIONKEY = R_REGIONKEY AND
> PS.PS_PARTKEY = TEMP.PS_PARTKEY AND
> PS.PS_SUPPLYCOST = TEMP.MINCOST
> ORDER BY S.S_ACCTBAL DESC, N_NAME, S.S_NAME, PS.PS_PARTKEY;
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| S_ACCTBAL       | S_NAME                    | N_NAME                    | PS_PARTKEY | P_MFGR                    | S_ADDRESS                                | S_PHONE         | S_COMMENT                                                                                             |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| 9828.21         | Supplier#000000647        | UNITED KINGDOM            | 13120      | Manufacturer#5            | x5U7MBZmwfG9                             | 33-258-202-4782 | s the slyly even ideas poach fluffily                                                                 |
| 9508.37         | Supplier#000000070        | FRANCE                    | 3563       | Manufacturer#1            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9508.37         | Supplier#000000070        | FRANCE                    | 17268      | Manufacturer#4            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 10021      | Manufacturer#5            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 13275      | Manufacturer#4            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9192.10         | Supplier#000000115        | UNITED KINGDOM            | 13325      | Manufacturer#1            | nJ 2t0f7Ve,wL1,6WzGBJLNBUCKlsV           | 33-597-248-1220 | es across the carefully express accounts boost caref                                                  |
| 9032.15         | Supplier#000000959        | GERMANY                   | 4958       | Manufacturer#4            | 8grA EHBnwOZhO                           | 17-108-642-3106 | nding dependencies nag furiou                                                                         |
| 8702.02         | Supplier#000000333        | RUSSIA                    | 11810      | Manufacturer#3            | MaVf XgwPdkiX4nfJGOis8Uu2zKiIZH          | 32-508-202-6136 | oss the deposits cajole carefully even pinto beans. regular foxes detect alo                          |
| 8615.50         | Supplier#000000812        | FRANCE                    | 10551      | Manufacturer#2            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
| 8615.50         | Supplier#000000812        | FRANCE                    | 13811      | Manufacturer#4            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+

> SELECT
> C_COUNT, COUNT(*) AS CUSTDIST
> FROM (
> SELECT
> C_CUSTKEY,
> COUNT(O_ORDERKEY)
> FROM
> CUSTOMER LEFT OUTER JOIN ORDERS ON
> C_CUSTKEY = O_CUSTKEY
> AND O_COMMENT NOT LIKE '%special%requests%'
> GROUP BY
> C_CUSTKEY
> )AS C_ORDERS (C_CUSTKEY, C_COUNT)
> GROUP BY
> C_COUNT
> ORDER BY
> CUSTDIST DESC,
> C_COUNT DESC;
+---------------------+---------------------+
| C_COUNT             | CUSTDIST            |
+---------------------+---------------------+
| 0                   | 5000                |
| 10                  | 665                 |
| 9                   | 657                 |
| 11                  | 621                 |
| 12                  | 567                 |
| 8                   | 564                 |
| 13                  | 492                 |
| 18                  | 482                 |
| 7                   | 480                 |
| 20                  | 456                 |
| 14                  | 456                 |
| 16                  | 449                 |
| 19                  | 447                 |
| 15                  | 432                 |
| 17                  | 423                 |
| 21                  | 412                 |
| 22                  | 371                 |
| 6                   | 337                 |
| 23                  | 323                 |
| 24                  | 256                 |
| 25                  | 204                 |
| 5                   | 204                 |
| 26                  | 155                 |
| 27                  | 141                 |
| 28                  | 97                  |
| 4                   | 94                  |
| 29                  | 64                  |
| 3                   | 48                  |
| 30                  | 27                  |
| 31                  | 26                  |
| 32                  | 14                  |
| 33                  | 11                  |
| 2                   | 11                  |
| 34                  | 6                   |
| 35                  | 5                   |
| 1                   | 2                   |
| 36                  | 1                   |
+---------------------+---------------------+

> SELECT
> P_BRAND,
> P_TYPE,
> P_SIZE,
> COUNT(DISTINCT PS_SUPPKEY) AS SUPPLIER_CNT
> FROM
> PARTSUPP,
> PART
> WHERE
> P_PARTKEY = PS_PARTKEY
> AND P_BRAND <> 'Brand#45'
> AND P_TYPE NOT LIKE 'MEDIUM POLISHED%'
> AND P_SIZE IN (49, 14, 23, 45, 19, 3, 36, 9)
> AND PS_SUPPKEY NOT IN (
> SELECT
> S_SUPPKEY
> FROM
> SUPPLIER
> WHERE
> S_COMMENT LIKE '%Customer%Complaints%'
> )
> GROUP BY
> P_BRAND,
> P_TYPE,
> P_SIZE
> ORDER BY
> SUPPLIER_CNT DESC,
> P_BRAND,
> P_TYPE,
> P_SIZE;
+------------+---------------------------+------------+---------------------+
| P_BRAND    | P_TYPE                    | P_SIZE     | SUPPLIER_CNT        |
+------------+---------------------------+------------+---------------------+
| Brand#14   | SMALL ANODIZED NICKEL     | 45         | 12                  |
| Brand#22   | SMALL BURNISHED BRASS     | 19         | 12                  |
| Brand#25   | PROMO POLISHED COPPER     | 14         | 12                  |
| Brand#35   | LARGE ANODIZED STEEL      | 45         | 12                  |
| Brand#35   | PROMO BRUSHED COPPER      | 9          | 12                  |
| Brand#51   | ECONOMY ANODIZED STEEL    | 9          | 12                  |
| Brand#53   | LARGE BRUSHED NICKEL      | 45         | 12                  |
| Brand#11   | ECONOMY POLISHED COPPER   | 14         | 8                   |
| Brand#11   | LARGE PLATED STEEL        | 23         | 8                   |
| Brand#11   | PROMO POLISHED STEEL      | 23         | 8                   |
+------------+---------------------------+------------+---------------------+

> SELECT
> L_SHIPMODE,
> SUM(CASE WHEN O_ORDERPRIORITY = '1-URGENT'
> OR O_ORDERPRIORITY = '2-HIGH'
> THEN 1
> ELSE 0
> END) AS HIGH_LINE_COUNT,
> SUM(CASE WHEN O_ORDERPRIORITY <> '1-URGENT'
> AND O_ORDERPRIORITY <> '2-HIGH'
> THEN 1
> ELSE 0
> END) AS LOW_LINE_COUNT
> FROM ORDERS, LINEITEM
> WHERE
> O_ORDERKEY = L_ORDERKEY
> AND L_SHIPMODE IN ('MAIL', 'SHIP')
> AND L_COMMITDATE < L_RECEIPTDATE
> AND L_SHIPDATE < L_COMMITDATE
> AND L_RECEIPTDATE >= DATE'1994-01-01'
> AND L_RECEIPTDATE < DATE'1995-01-01'
> GROUP BY L_SHIPMODE
> ORDER BY L_SHIPMODE;
+------------+-----------------+----------------+
| L_SHIPMODE | HIGH_LINE_COUNT | LOW_LINE_COUNT |
+------------+-----------------+----------------+
| MAIL       | 647             | 945            |
| SHIP       | 620             | 943            |
+------------+-----------------+----------------+

> SELECT
> L_ORDERKEY,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> O_ORDERDATE,
> O_SHIPPRIORITY
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> C_MKTSEGMENT = 'BUILDING' AND
> C_CUSTKEY = O_CUSTKEY AND
> L_ORDERKEY = O_ORDERKEY AND
> O_ORDERDATE < DATE '1995-03-15' AND
> L_SHIPDATE > DATE '1995-03-15'
> GROUP BY
> L_ORDERKEY,
> O_ORDERDATE,
> O_SHIPPRIORITY
> ORDER BY
> REVENUE DESC,
> O_ORDERDATE;
+------------+---------------------+-------------+----------------+
| L_ORDERKEY | REVENUE             | O_ORDERDATE | O_SHIPPRIORITY |
+------------+---------------------+-------------+----------------+
| 223140     | 355369.0698         | 1995-03-14  | 0              |
| 584291     | 354494.7318         | 1995-02-21  | 0              |
| 405063     | 353125.4577         | 1995-03-03  | 0              |
| 573861     | 351238.2770         | 1995-03-09  | 0              |
| 554757     | 349181.7426         | 1995-03-14  | 0              |
| 506021     | 321075.5810         | 1995-03-10  | 0              |
| 121604     | 318576.4154         | 1995-03-07  | 0              |
| 108514     | 314967.0754         | 1995-02-20  | 0              |
| 462502     | 312604.5420         | 1995-03-08  | 0              |
| 178727     | 309728.9306         | 1995-02-25  | 0              |
+------------+---------------------+-------------+----------------+

> alter session set "label" = null;
0 rows affected.
-- end of thread queries1

-- thread queries2
> set schema 'rwconcur';
0 rows affected.
> alter session set "label" = 'AFTERUPDATE1';
0 rows affected.
> SELECT SUM(L_EXTENDEDPRICE * L_DISCOUNT) AS REVENUE
> FROM LINEITEM
> WHERE
> L_SHIPDATE >= DATE '1994-01-01' AND
> L_SHIPDATE < date '1995-01-01' AND
> L_DISCOUNT BETWEEN .06 - 0.01 AND .06 + 0.01 AND
> L_QUANTITY <  24;
+---------------------+
| REVENUE             |
+---------------------+
| 11791456.2302       |
+---------------------+

> SELECT SUM(L_EXTENDEDPRICE) / 7.0 AS AVG_YEARLY
> FROM LINEITEM L, PART,
> (SELECT L1.L_PARTKEY, (0.2 * AVG(L_QUANTITY)) AS AVGQTY
> FROM LINEITEM L1
> GROUP BY L1.L_PARTKEY) AS TEMP
> WHERE
> P_PARTKEY = L.L_PARTKEY AND
> P_BRAND = 'Brand#23' AND
> P_CONTAINER = 'MED BOX' AND
> P_PARTKEY = TEMP.L_PARTKEY AND
> L.L_QUANTITY < TEMP.AVGQTY;
+---------------------+
| AVG_YEARLY          |
+---------------------+
| 23512.752857        |
+---------------------+

> SELECT
> 100.00 * SUM(CASE WHEN P_TYPE LIKE 'PROMO%'
> THEN L_EXTENDEDPRICE * (1 - L_DISCOUNT)
> ELSE 0
> END) / SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT))
> AS PROMO_REVENUE
> FROM LINEITEM, PART
> WHERE L_PARTKEY = P_PARTKEY
> AND L_SHIPDATE >= DATE'1995-09-01'
> AND L_SHIPDATE < DATE'1995-10-01';
+---------------------+
| PROMO_REVENUE       |
+---------------------+
| 16.286673           |
+---------------------+

> SELECT
> P_BRAND,
> P_TYPE,
> P_SIZE,
> COUNT(DISTINCT PS_SUPPKEY) AS SUPPLIER_CNT
> FROM
> PARTSUPP,
> PART
> WHERE
> P_PARTKEY = PS_PARTKEY
> AND P_BRAND <> 'Brand#45'
> AND P_TYPE NOT LIKE 'MEDIUM POLISHED%'
> AND P_SIZE IN (49, 14, 23, 45, 19, 3, 36, 9)
> AND PS_SUPPKEY NOT IN (
> SELECT
> S_SUPPKEY
> FROM
> SUPPLIER
> WHERE
> S_COMMENT LIKE '%Customer%Complaints%'
> )
> GROUP BY
> P_BRAND,
> P_TYPE,
> P_SIZE
> ORDER BY
> SUPPLIER_CNT DESC,
> P_BRAND,
> P_TYPE,
> P_SIZE;
+------------+---------------------------+------------+---------------------+
| P_BRAND    | P_TYPE                    | P_SIZE     | SUPPLIER_CNT        |
+------------+---------------------------+------------+---------------------+
| Brand#14   | SMALL ANODIZED NICKEL     | 45         | 12                  |
| Brand#22   | SMALL BURNISHED BRASS     | 19         | 12                  |
| Brand#25   | PROMO POLISHED COPPER     | 14         | 12                  |
| Brand#35   | LARGE ANODIZED STEEL      | 45         | 12                  |
| Brand#35   | PROMO BRUSHED COPPER      | 9          | 12                  |
| Brand#51   | ECONOMY ANODIZED STEEL    | 9          | 12                  |
| Brand#53   | LARGE BRUSHED NICKEL      | 45         | 12                  |
| Brand#11   | ECONOMY POLISHED COPPER   | 14         | 8                   |
| Brand#11   | LARGE PLATED STEEL        | 23         | 8                   |
| Brand#11   | PROMO POLISHED STEEL      | 23         | 8                   |
+------------+---------------------------+------------+---------------------+

> SELECT
> CNTRYCODE,
> COUNT(*) AS NUMCUST,
> SUM(C_ACCTBAL) AS TOTACCTBAL
> FROM (
> SELECT
> SUBSTRING(C_PHONE FROM 1 FOR 2) AS CNTRYCODE,
> C_ACCTBAL
> FROM
> CUSTOMER
> WHERE
> SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> AND C_ACCTBAL > (
> SELECT
> AVG(C_ACCTBAL)
> FROM
> CUSTOMER
> WHERE
> C_ACCTBAL > 0.00
> AND SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> )
> AND NOT EXISTS (
> SELECT
> *
> FROM
> ORDERS
> WHERE
> O_CUSTKEY = C_CUSTKEY
> )
> ) AS CUSTSALE
> GROUP BY
> CNTRYCODE
> ORDER BY
> CNTRYCODE;
+-----------------+---------------------+-----------------+
| CNTRYCODE       | NUMCUST             | TOTACCTBAL      |
+-----------------+---------------------+-----------------+
| 13              | 94                  | 714035.05       |
| 17              | 96                  | 722560.15       |
| 18              | 99                  | 738012.52       |
| 23              | 93                  | 708285.25       |
| 29              | 85                  | 632693.46       |
| 30              | 87                  | 646748.02       |
| 31              | 87                  | 647372.50       |
+-----------------+---------------------+-----------------+

> SELECT
> NATION,
> YYEAR,
> SUM(AMOUNT) AS SUM_PROFIT
> FROM (SELECT
> N_NAME AS NATION,
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) - PS_SUPPLYCOST * L_QUANTITY AS AMOUNT
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> PARTSUPP,
> ORDERS,
> NATION
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND PS_SUPPKEY = L_SUPPKEY
> AND PS_PARTKEY = L_PARTKEY
> AND P_PARTKEY = L_PARTKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND P_NAME LIKE '%green%'
> ) AS PROFIT
> GROUP BY
> NATION,
> YYEAR
> ORDER BY
> NATION,
> YYEAR DESC;
+---------------------------+-------+---------------------+
| NATION                    | YYEAR | SUM_PROFIT          |
+---------------------------+-------+---------------------+
| ALGERIA                   | 1998  | 2334804.6272        |
| ALGERIA                   | 1997  | 3908009.1819        |
| ALGERIA                   | 1996  | 4193307.2158        |
| ALGERIA                   | 1995  | 4159170.6827        |
| ALGERIA                   | 1994  | 4642813.9269        |
| ALGERIA                   | 1993  | 3628134.7118        |
| ALGERIA                   | 1992  | 3453838.6906        |
| ARGENTINA                 | 1998  | 3173981.1186        |
| ARGENTINA                 | 1997  | 4648199.7641        |
| ARGENTINA                 | 1996  | 5269481.5374        |
+---------------------------+-------+---------------------+

> SELECT S.S_ACCTBAL, S.S_NAME, N_NAME, PS.PS_PARTKEY, P.P_MFGR,
> S.S_ADDRESS, S.S_PHONE, S.S_COMMENT
> FROM PART P, SUPPLIER S, PARTSUPP PS, NATION, REGION,
> (SELECT PS1.PS_PARTKEY, MIN(PS1.PS_SUPPLYCOST) AS MINCOST
> FROM PARTSUPP PS1, SUPPLIER S1, NATION N1, REGION R1
> WHERE PS1.PS_SUPPKEY = S1.S_SUPPKEY AND
> S1.S_NATIONKEY = N1.N_NATIONKEY AND
> N1.N_REGIONKEY = R1.R_REGIONKEY AND
> R1.R_NAME = 'EUROPE'
> GROUP BY PS1.PS_PARTKEY) AS TEMP
> WHERE P.P_PARTKEY = PS.PS_PARTKEY AND
> S.S_SUPPKEY = PS.PS_SUPPKEY AND
> P.P_SIZE = 15 AND
> P.P_TYPE LIKE '%BRASS' AND
> S.S_NATIONKEY = N_NATIONKEY AND
> N_REGIONKEY = R_REGIONKEY AND
> PS.PS_PARTKEY = TEMP.PS_PARTKEY AND
> PS.PS_SUPPLYCOST = TEMP.MINCOST
> ORDER BY S.S_ACCTBAL DESC, N_NAME, S.S_NAME, PS.PS_PARTKEY;
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| S_ACCTBAL       | S_NAME                    | N_NAME                    | PS_PARTKEY | P_MFGR                    | S_ADDRESS                                | S_PHONE         | S_COMMENT                                                                                             |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| 9828.21         | Supplier#000000647        | UNITED KINGDOM            | 13120      | Manufacturer#5            | x5U7MBZmwfG9                             | 33-258-202-4782 | s the slyly even ideas poach fluffily                                                                 |
| 9508.37         | Supplier#000000070        | FRANCE                    | 3563       | Manufacturer#1            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9508.37         | Supplier#000000070        | FRANCE                    | 17268      | Manufacturer#4            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 10021      | Manufacturer#5            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 13275      | Manufacturer#4            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9192.10         | Supplier#000000115        | UNITED KINGDOM            | 13325      | Manufacturer#1            | nJ 2t0f7Ve,wL1,6WzGBJLNBUCKlsV           | 33-597-248-1220 | es across the carefully express accounts boost caref                                                  |
| 9032.15         | Supplier#000000959        | GERMANY                   | 4958       | Manufacturer#4            | 8grA EHBnwOZhO                           | 17-108-642-3106 | nding dependencies nag furiou                                                                         |
| 8702.02         | Supplier#000000333        | RUSSIA                    | 11810      | Manufacturer#3            | MaVf XgwPdkiX4nfJGOis8Uu2zKiIZH          | 32-508-202-6136 | oss the deposits cajole carefully even pinto beans. regular foxes detect alo                          |
| 8615.50         | Supplier#000000812        | FRANCE                    | 10551      | Manufacturer#2            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
| 8615.50         | Supplier#000000812        | FRANCE                    | 13811      | Manufacturer#4            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+

> SELECT
> C_CUSTKEY,
> C_NAME,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> C_ACCTBAL,
> N_NAME,
> C_ADDRESS,
> C_PHONE,
> C_COMMENT
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> NATION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_ORDERDATE >= date '1993-10-01'
> AND O_ORDERDATE < DATE '1994-01-01'
> AND L_RETURNFLAG = 'R'
> AND C_NATIONKEY = N_NATIONKEY
> GROUP BY
> C_CUSTKEY,
> C_NAME,
> C_ACCTBAL,
> C_PHONE,
> N_NAME,
> C_ADDRESS,
> C_COMMENT
> ORDER BY
> REVENUE DESC;
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| C_CUSTKEY  | C_NAME                    | REVENUE             | C_ACCTBAL       | N_NAME                    | C_ADDRESS                                | C_PHONE         | C_COMMENT                                                                                                             |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| 8242       | Customer#000008242        | 622786.7297         | 6322.09         | ETHIOPIA                  | P2n4nJhy,UqSo2s43YfSvYJDZ6lk             | 15-792-676-1184 | slyly regular packages haggle carefully ironic ideas. courts are furiously. furiously unusual theodolites cajole. i   |
| 7714       | Customer#000007714        | 557400.3053         | 9799.98         | IRAN                      | SnnIGB,SkmnWpX3                          | 20-922-418-6024 | arhorses according to the blithely express re                                                                         |
| 11032      | Customer#000011032        | 512500.9641         | 8496.93         | UNITED KINGDOM            | WIKHC7K3Cn7156iNOyfVG3cZ7YqkgsR,Ly       | 33-102-772-3533 | posits-- furiously ironic accounts are again                                                                          |
| 2455       | Customer#000002455        | 481592.4053         | 2070.99         | GERMANY                   | RVn1ZSRtLqPlJLIZxvpmsbgC02               | 17-946-225-9977 | al asymptotes. finally ironic accounts cajole furiously. permanently unusual theodolites aro                          |
| 12106      | Customer#000012106        | 479414.2133         | 5342.11         | UNITED STATES             | wth3twOmu6vy                             | 34-905-346-4472 | ly after the blithely regular foxes. accounts haggle carefully alongside of the blithely even ideas.                  |
| 8530       | Customer#000008530        | 457855.9467         | 9734.95         | MOROCCO                   | GMQyte94oDM7eD7exnkj 4hH9yq3             | 25-736-932-5850 | slyly asymptotes. quickly final deposits in                                                                           |
| 13984      | Customer#000013984        | 446316.5104         | 3482.28         | IRAN                      | qZXwuapCHvxbX                            | 20-981-264-2952 | y unusual courts could wake furiously                                                                                 |
| 1966       | Customer#000001966        | 444059.0382         | 1937.72         | ALGERIA                   | jPv1 UHra5JLALR5Isci5u0636RoAu7t vH      | 10-973-269-8886 | the blithely even accounts. final deposits cajole around the blithely final packages.                                 |
| 11026      | Customer#000011026        | 417913.4142         | 7738.76         | ALGERIA                   | XorIktoJOAEJkpNNMx                       | 10-184-163-4632 | ly even dolphins eat along the blithely even instructions. express attainments cajole slyly. busy dolphins in         |
| 8501       | Customer#000008501        | 412797.5100         | 6906.70         | ARGENTINA                 | 776af4rOa mZ66hczs                       | 11-317-552-5840 | y final deposits after the fluffily even accounts are slyly final, regular                                            |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+

> SELECT
> S_SUPPKEY,
> S_NAME,
> S_ADDRESS,
> S_PHONE,
> TOTAL_REVENUE
> FROM
> SUPPLIER,
> REVENUE0
> WHERE
> S_SUPPKEY = SUPPLIER_NO
> AND TOTAL_REVENUE = (
> SELECT
> MAX(TOTAL_REVENUE)
> FROM
> REVENUE0
> )
> ORDER BY
> S_SUPPKEY;
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| S_SUPPKEY  | S_NAME                    | S_ADDRESS                                | S_PHONE         | TOTAL_REVENUE       |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| 677        | Supplier#000000677        | 8mhrffG7D2WJBSQbOGstQ                    | 23-290-639-3315 | 1614410.2928        |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+

> SELECT
> YYEAR,
> CAST(SUM(CASE WHEN NATION = 'BRAZIL'
> THEN VOLUME
> ELSE 0
> END) AS DECIMAL(19,4))*1.0000 /
> CAST(SUM(VOLUME) AS DECIMAL(19,4)) AS MKT_SHARE
> FROM (SELECT
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME,
> N2.N_NAME AS NATION
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2,
> REGION
> WHERE
> P_PARTKEY = L_PARTKEY
> AND S_SUPPKEY = L_SUPPKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_CUSTKEY = C_CUSTKEY
> AND C_NATIONKEY = N1.N_NATIONKEY
> AND N1.N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'AMERICA'
> AND S_NATIONKEY = N2.N_NATIONKEY
> AND O_ORDERDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> AND P_TYPE = 'ECONOMY ANODIZED STEEL') AS ALL_NATIONS
> GROUP BY YYEAR
> ORDER BY YYEAR;
+-------+---------------------+
| YYEAR | MKT_SHARE           |
+-------+---------------------+
| 1995  | 0.028649            |
| 1996  | 0.018250            |
+-------+---------------------+

> SELECT
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) ) AS REVENUE
> FROM
> LINEITEM,
> PART
> WHERE
> P_PARTKEY = L_PARTKEY
> AND
> ((
> P_BRAND = 'Brand#12'
> AND P_CONTAINER IN ( 'SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
> AND L_QUANTITY >= 1 AND L_QUANTITY <= 1 + 10
> AND P_SIZE BETWEEN 1 AND 5
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#23'
> AND P_CONTAINER IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
> AND L_QUANTITY >= 10 AND L_QUANTITY <= 10 + 10
> AND P_SIZE BETWEEN 1 AND 10
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#34'
> AND P_CONTAINER IN ( 'LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
> AND L_QUANTITY >= 20 AND L_QUANTITY <= 20 + 10
> AND P_SIZE BETWEEN 1 AND 15
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> ));
+---------------------+
| REVENUE             |
+---------------------+
| 168597.2860         |
+---------------------+

> SELECT
> L_SHIPMODE,
> SUM(CASE WHEN O_ORDERPRIORITY = '1-URGENT'
> OR O_ORDERPRIORITY = '2-HIGH'
> THEN 1
> ELSE 0
> END) AS HIGH_LINE_COUNT,
> SUM(CASE WHEN O_ORDERPRIORITY <> '1-URGENT'
> AND O_ORDERPRIORITY <> '2-HIGH'
> THEN 1
> ELSE 0
> END) AS LOW_LINE_COUNT
> FROM ORDERS, LINEITEM
> WHERE
> O_ORDERKEY = L_ORDERKEY
> AND L_SHIPMODE IN ('MAIL', 'SHIP')
> AND L_COMMITDATE < L_RECEIPTDATE
> AND L_SHIPDATE < L_COMMITDATE
> AND L_RECEIPTDATE >= DATE'1994-01-01'
> AND L_RECEIPTDATE < DATE'1995-01-01'
> GROUP BY L_SHIPMODE
> ORDER BY L_SHIPMODE;
+------------+-----------------+----------------+
| L_SHIPMODE | HIGH_LINE_COUNT | LOW_LINE_COUNT |
+------------+-----------------+----------------+
| MAIL       | 647             | 947            |
| SHIP       | 620             | 942            |
+------------+-----------------+----------------+

> SELECT
> SUPP_NATION,
> CUST_NATION,
> YYEAR,
> SUM(VOLUME) AS REVENUE
> FROM
> (SELECT
> N1.N_NAME AS SUPP_NATION,
> N2.N_NAME AS CUST_NATION,
> APPLIB.DATE_TO_CHAR('yyyy', L_SHIPDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME
> FROM
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND C_CUSTKEY = O_CUSTKEY
> AND S_NATIONKEY = N1.N_NATIONKEY
> AND C_NATIONKEY = N2.N_NATIONKEY
> AND ((N1.N_NAME = 'FRANCE' AND N2.N_NAME = 'GERMANY')
> OR (N1.N_NAME = 'GERMANY' AND N2.N_NAME = 'FRANCE'))
> AND L_SHIPDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> ) AS SHIPPING
> GROUP BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR
> ORDER BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR;
+---------------------------+---------------------------+-------+---------------------+
| SUPP_NATION               | CUST_NATION               | YYEAR | REVENUE             |
+---------------------------+---------------------------+-------+---------------------+
| FRANCE                    | GERMANY                   | 1995  | 4637235.1501        |
| FRANCE                    | GERMANY                   | 1996  | 5224779.5736        |
| GERMANY                   | FRANCE                    | 1995  | 6232818.7037        |
| GERMANY                   | FRANCE                    | 1996  | 5557312.1121        |
+---------------------------+---------------------------+-------+---------------------+

> SELECT
> N_NAME,
> SUM(L_EXTENDEDPRICE * ( 1 - L_DISCOUNT)) AS REVENUE
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> SUPPLIER,
> NATION,
> REGION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND L_SUPPKEY = S_SUPPKEY
> AND C_NATIONKEY = S_NATIONKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'ASIA'
> AND O_ORDERDATE >=  date '1994-01-01'
> AND O_ORDERDATE < DATE '1995-01-01'
> GROUP BY
> N_NAME
> ORDER BY
> REVENUE DESC;
+---------------------------+---------------------+
| N_NAME                    | REVENUE             |
+---------------------------+---------------------+
| CHINA                     | 7849559.4460        |
| INDIA                     | 6376121.5085        |
| JAPAN                     | 6000077.2184        |
| INDONESIA                 | 5580475.4027        |
| VIETNAM                   | 4475164.5426        |
+---------------------------+---------------------+

> SELECT
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE,
> SUM(L_QUANTITY)
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> O_ORDERKEY IN (
> SELECT
> L_ORDERKEY
> FROM
> LINEITEM
> GROUP BY
> L_ORDERKEY
> HAVING
> SUM(L_QUANTITY) > 300
> )
> AND C_CUSTKEY = O_CUSTKEY
> AND O_ORDERKEY = L_ORDERKEY
> GROUP BY
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE
> ORDER BY
> O_TOTALPRICE DESC,
> O_ORDERDATE;
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| C_NAME                    | C_CUSTKEY  | O_ORDERKEY | O_ORDERDATE | O_TOTALPRICE    | EXPR$5          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| Customer#000001639        | 1639       | 502886     | 1994-04-12  | 456423.88       | 312.00          |
| Customer#000006655        | 6655       | 29158      | 1995-10-21  | 452805.02       | 305.00          |
| Customer#000014110        | 14110      | 565574     | 1995-09-24  | 425099.85       | 301.00          |
| Customer#000001775        | 1775       | 6882       | 1997-04-09  | 408368.10       | 303.00          |
| Customer#000011459        | 11459      | 551136     | 1993-05-19  | 386812.74       | 308.00          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+

> SELECT
> L_RETURNFLAG,
> L_LINESTATUS,
> SUM(L_QUANTITY) AS SUM_QTY,
> SUM(L_EXTENDEDPRICE) AS SUM_BASE_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS SUM_DISC_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) * (1 + L_TAX)) AS SUM_CHARGE,
> AVG(L_QUANTITY) AS AVG_QTY,
> AVG(L_EXTENDEDPRICE) AS AVG_PRICE,
> AVG(L_DISCOUNT) AS AVG_DISC,
> COUNT(*) AS COUNT_ORDER
> FROM
> LINEITEM
> WHERE
> L_SHIPDATE <=  APPLIB.ADD_DAYS(DATE '1998-12-01', -90)
> GROUP BY
> L_RETURNFLAG,
> L_LINESTATUS
> ORDER BY
> L_RETURNFLAG,
> L_LINESTATUS;
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| L_RETURNFLAG | L_LINESTATUS | SUM_QTY         | SUM_BASE_PRICE  | SUM_DISC_PRICE      | SUM_CHARGE          | AVG_QTY         | AVG_PRICE       | AVG_DISC        | COUNT_ORDER         |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| A            | F            | 3773960.00      | 5320278635.08   | 5053666748.7079     | 5256301578.513396   | 25.54           | 36000.13        | 0.05            | 147785              |
| N            | F            | 95215.00        | 133657862.44    | 127053281.6810      | 132208146.584281    | 25.29           | 35500.10        | 0.05            | 3765                |
| N            | O            | 7458794.00      | 10511801578.00  | 9985781685.1221     | 10385084644.533196  | 25.55           | 36002.16        | 0.05            | 291977              |
| R            | F            | 3786739.00      | 5339840631.39   | 5073617146.0790     | 5276284419.499767   | 25.53           | 35998.04        | 0.05            | 148337              |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+

> SELECT
> C_COUNT, COUNT(*) AS CUSTDIST
> FROM (
> SELECT
> C_CUSTKEY,
> COUNT(O_ORDERKEY)
> FROM
> CUSTOMER LEFT OUTER JOIN ORDERS ON
> C_CUSTKEY = O_CUSTKEY
> AND O_COMMENT NOT LIKE '%special%requests%'
> GROUP BY
> C_CUSTKEY
> )AS C_ORDERS (C_CUSTKEY, C_COUNT)
> GROUP BY
> C_COUNT
> ORDER BY
> CUSTDIST DESC,
> C_COUNT DESC;
+---------------------+---------------------+
| C_COUNT             | CUSTDIST            |
+---------------------+---------------------+
| 0                   | 5000                |
| 10                  | 670                 |
| 9                   | 658                 |
| 11                  | 622                 |
| 8                   | 562                 |
| 12                  | 556                 |
| 13                  | 493                 |
| 7                   | 479                 |
| 18                  | 477                 |
| 14                  | 460                 |
| 20                  | 456                 |
| 19                  | 451                 |
| 16                  | 443                 |
| 15                  | 435                 |
| 17                  | 431                 |
| 21                  | 411                 |
| 22                  | 371                 |
| 6                   | 338                 |
| 23                  | 321                 |
| 24                  | 260                 |
| 5                   | 205                 |
| 25                  | 196                 |
| 26                  | 159                 |
| 27                  | 138                 |
| 28                  | 98                  |
| 4                   | 93                  |
| 29                  | 66                  |
| 3                   | 48                  |
| 30                  | 28                  |
| 31                  | 25                  |
| 33                  | 13                  |
| 32                  | 12                  |
| 2                   | 11                  |
| 35                  | 6                   |
| 34                  | 5                   |
| 1                   | 2                   |
| 36                  | 1                   |
+---------------------+---------------------+

> SELECT
> S_NAME,
> S_ADDRESS
> FROM
> SUPPLIER,
> NATION
> WHERE
> S_SUPPKEY IN (
> SELECT
> PS_SUPPKEY
> FROM
> PARTSUPP
> WHERE
> PS_PARTKEY IN (
> SELECT
> P_PARTKEY
> FROM
> PART
> WHERE
> P_NAME LIKE 'forest%'
> )
> AND PS_AVAILQTY > (
> SELECT
> 0.5 * SUM(L_QUANTITY)
> FROM
> LINEITEM
> WHERE
> L_PARTKEY = PS_PARTKEY
> AND L_SUPPKEY = PS_SUPPKEY
> AND L_SHIPDATE >= DATE '1994-01-01'
> AND L_SHIPDATE < DATE '1995-01-01'
> )
> )
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'CANADA'
> ORDER BY
> S_NAME;
+---------------------------+------------------------------------------+
| S_NAME                    | S_ADDRESS                                |
+---------------------------+------------------------------------------+
| Supplier#000000013        | HK71HQyWoqRWOX8GI FpgAifW,2PoH           |
| Supplier#000000020        | iybAE,RmTymrZVYaFZva2SH,j                |
| Supplier#000000091        | YV45D7TkfdQanOOZ7q9QxkyGUapU1oOWU6q3     |
| Supplier#000000157        | ,mEGorBfVIm                              |
| Supplier#000000197        | YC2Acon6kjY3zj3Fbxs2k4Vdf7X0cd2F         |
| Supplier#000000205        | rF uV8d0JNEk                             |
| Supplier#000000285        | Br7e1nnt1yxrw6ImgpJ7YdhFDjuBf            |
| Supplier#000000287        | 7a9SP7qW5Yku5PvSg                        |
| Supplier#000000358        | V3yxhHhHSXqOoc5UPv5TwkVDGKQsG            |
| Supplier#000000402        | i9Sw4DoyMhzhKXCH9By,AYSgmD               |
| Supplier#000000431        | WoeV,NINojE6hJjauAdrl5fGcdxX5JUPLnrim    |
| Supplier#000000530        | 0qwCMwobKY OcmLyfRXlagA8ukENJv,          |
| Supplier#000000555        | TfB,a5bfl3Ah 3Z 74GqnNs6zKVGM            |
| Supplier#000000557        | jj0wUYh9K3fG5Jhdhrkuy ,4                 |
| Supplier#000000640        | mvvtlQKsTOsJj5Ihk7,cq                    |
| Supplier#000000729        | pqck2ppy758TQpZCUAjPvlU55K3QjfL7Bi       |
| Supplier#000000736        | l6i2nMwVuovfKnuVgaSGK2rDy65DlAFLegiL7    |
| Supplier#000000744        | 5NKuw5W4mFDMQBbUjUO4k kfokG8yvAe         |
| Supplier#000000752        | l cHMtEnodxj3FV                          |
| Supplier#000000848        | tx44JAuF,Jnw1                            |
| Supplier#000000997        | 7eUWMrOCKCp2JYas6P4mL93eaWIOtKKWtTX      |
+---------------------------+------------------------------------------+

> SELECT
> L_ORDERKEY,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> O_ORDERDATE,
> O_SHIPPRIORITY
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> C_MKTSEGMENT = 'BUILDING' AND
> C_CUSTKEY = O_CUSTKEY AND
> L_ORDERKEY = O_ORDERKEY AND
> O_ORDERDATE < DATE '1995-03-15' AND
> L_SHIPDATE > DATE '1995-03-15'
> GROUP BY
> L_ORDERKEY,
> O_ORDERDATE,
> O_SHIPPRIORITY
> ORDER BY
> REVENUE DESC,
> O_ORDERDATE;
+------------+---------------------+-------------+----------------+
| L_ORDERKEY | REVENUE             | O_ORDERDATE | O_SHIPPRIORITY |
+------------+---------------------+-------------+----------------+
| 223140     | 355369.0698         | 1995-03-14  | 0              |
| 584291     | 354494.7318         | 1995-02-21  | 0              |
| 405063     | 353125.4577         | 1995-03-03  | 0              |
| 573861     | 351238.2770         | 1995-03-09  | 0              |
| 554757     | 349181.7426         | 1995-03-14  | 0              |
| 506021     | 321075.5810         | 1995-03-10  | 0              |
| 121604     | 318576.4154         | 1995-03-07  | 0              |
| 108514     | 314967.0754         | 1995-02-20  | 0              |
| 462502     | 312604.5420         | 1995-03-08  | 0              |
| 178727     | 309728.9306         | 1995-02-25  | 0              |
+------------+---------------------+-------------+----------------+

> SELECT
> O_ORDERPRIORITY,
> COUNT(*) AS ORDER_COUNT
> FROM ORDERS
> WHERE
> O_ORDERDATE >= DATE '1993-07-01'
> AND O_ORDERDATE < DATE '1993-10-01'
> AND EXISTS (
> SELECT
> *
> FROM
> LINEITEM
> WHERE
> L_ORDERKEY = O_ORDERKEY
> AND L_COMMITDATE < L_RECEIPTDATE
> )
> GROUP BY
> O_ORDERPRIORITY
> ORDER BY
> O_ORDERPRIORITY;
+-----------------+---------------------+
| O_ORDERPRIORITY | ORDER_COUNT         |
+-----------------+---------------------+
| 1-URGENT        | 998                 |
| 2-HIGH          | 998                 |
| 3-MEDIUM        | 1034                |
| 4-NOT SPECIFIED | 989                 |
| 5-LOW           | 1078                |
+-----------------+---------------------+

> SELECT
> PS_PARTKEY,
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) AS VAL
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> GROUP BY
> PS_PARTKEY HAVING
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) > (
> SELECT
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) * (0.0001 / 0.1)
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> )
> ORDER BY
> VAL DESC;
+------------+---------------------+
| PS_PARTKEY | VAL                 |
+------------+---------------------+
| 12098      | 16227681.21         |
| 5134       | 15709338.52         |
| 13334      | 15023662.41         |
| 17052      | 14351644.20         |
| 3452       | 14070870.14         |
| 12552      | 13332469.18         |
| 1084       | 13170428.29         |
| 5797       | 13038622.72         |
| 12633      | 12892561.61         |
| 403        | 12856217.34         |
| 1833       | 12024581.72         |
| 2084       | 11502875.36         |
| 17349      | 11354213.05         |
| 18427      | 11282385.24         |
| 2860       | 11262529.95         |
| 17852      | 10934711.93         |
| 9871       | 10889253.68         |
| 12231      | 10841131.39         |
| 6366       | 10759786.81         |
| 12146      | 10257362.66         |
| 5043       | 10226395.88         |
| 12969      | 10125777.93         |
+------------+---------------------+

> SELECT
> N_NAME,
> SUM(L_EXTENDEDPRICE * ( 1 - L_DISCOUNT)) AS REVENUE
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> SUPPLIER,
> NATION,
> REGION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND L_SUPPKEY = S_SUPPKEY
> AND C_NATIONKEY = S_NATIONKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'ASIA'
> AND O_ORDERDATE >=  date '1994-01-01'
> AND O_ORDERDATE < DATE '1995-01-01'
> GROUP BY
> N_NAME
> ORDER BY
> REVENUE DESC;
+---------------------------+---------------------+
| N_NAME                    | REVENUE             |
+---------------------------+---------------------+
| CHINA                     | 7849559.4460        |
| INDIA                     | 6376121.5085        |
| JAPAN                     | 6000077.2184        |
| INDONESIA                 | 5580475.4027        |
| VIETNAM                   | 4475164.5426        |
+---------------------------+---------------------+

> SELECT
> O_ORDERPRIORITY,
> COUNT(*) AS ORDER_COUNT
> FROM ORDERS
> WHERE
> O_ORDERDATE >= DATE '1993-07-01'
> AND O_ORDERDATE < DATE '1993-10-01'
> AND EXISTS (
> SELECT
> *
> FROM
> LINEITEM
> WHERE
> L_ORDERKEY = O_ORDERKEY
> AND L_COMMITDATE < L_RECEIPTDATE
> )
> GROUP BY
> O_ORDERPRIORITY
> ORDER BY
> O_ORDERPRIORITY;
+-----------------+---------------------+
| O_ORDERPRIORITY | ORDER_COUNT         |
+-----------------+---------------------+
| 1-URGENT        | 998                 |
| 2-HIGH          | 998                 |
| 3-MEDIUM        | 1034                |
| 4-NOT SPECIFIED | 989                 |
| 5-LOW           | 1078                |
+-----------------+---------------------+

> SELECT
> YYEAR,
> CAST(SUM(CASE WHEN NATION = 'BRAZIL'
> THEN VOLUME
> ELSE 0
> END) AS DECIMAL(19,4))*1.0000 /
> CAST(SUM(VOLUME) AS DECIMAL(19,4)) AS MKT_SHARE
> FROM (SELECT
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME,
> N2.N_NAME AS NATION
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2,
> REGION
> WHERE
> P_PARTKEY = L_PARTKEY
> AND S_SUPPKEY = L_SUPPKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_CUSTKEY = C_CUSTKEY
> AND C_NATIONKEY = N1.N_NATIONKEY
> AND N1.N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'AMERICA'
> AND S_NATIONKEY = N2.N_NATIONKEY
> AND O_ORDERDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> AND P_TYPE = 'ECONOMY ANODIZED STEEL') AS ALL_NATIONS
> GROUP BY YYEAR
> ORDER BY YYEAR;
+-------+---------------------+
| YYEAR | MKT_SHARE           |
+-------+---------------------+
| 1995  | 0.028649            |
| 1996  | 0.018250            |
+-------+---------------------+

> SELECT SUM(L_EXTENDEDPRICE) / 7.0 AS AVG_YEARLY
> FROM LINEITEM L, PART,
> (SELECT L1.L_PARTKEY, (0.2 * AVG(L_QUANTITY)) AS AVGQTY
> FROM LINEITEM L1
> GROUP BY L1.L_PARTKEY) AS TEMP
> WHERE
> P_PARTKEY = L.L_PARTKEY AND
> P_BRAND = 'Brand#23' AND
> P_CONTAINER = 'MED BOX' AND
> P_PARTKEY = TEMP.L_PARTKEY AND
> L.L_QUANTITY < TEMP.AVGQTY;
+---------------------+
| AVG_YEARLY          |
+---------------------+
| 23512.752857        |
+---------------------+

> SELECT
> SUPP_NATION,
> CUST_NATION,
> YYEAR,
> SUM(VOLUME) AS REVENUE
> FROM
> (SELECT
> N1.N_NAME AS SUPP_NATION,
> N2.N_NAME AS CUST_NATION,
> APPLIB.DATE_TO_CHAR('yyyy', L_SHIPDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME
> FROM
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND C_CUSTKEY = O_CUSTKEY
> AND S_NATIONKEY = N1.N_NATIONKEY
> AND C_NATIONKEY = N2.N_NATIONKEY
> AND ((N1.N_NAME = 'FRANCE' AND N2.N_NAME = 'GERMANY')
> OR (N1.N_NAME = 'GERMANY' AND N2.N_NAME = 'FRANCE'))
> AND L_SHIPDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> ) AS SHIPPING
> GROUP BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR
> ORDER BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR;
+---------------------------+---------------------------+-------+---------------------+
| SUPP_NATION               | CUST_NATION               | YYEAR | REVENUE             |
+---------------------------+---------------------------+-------+---------------------+
| FRANCE                    | GERMANY                   | 1995  | 4637235.1501        |
| FRANCE                    | GERMANY                   | 1996  | 5224779.5736        |
| GERMANY                   | FRANCE                    | 1995  | 6232818.7037        |
| GERMANY                   | FRANCE                    | 1996  | 5557312.1121        |
+---------------------------+---------------------------+-------+---------------------+

> SELECT SUM(L_EXTENDEDPRICE * L_DISCOUNT) AS REVENUE
> FROM LINEITEM
> WHERE
> L_SHIPDATE >= DATE '1994-01-01' AND
> L_SHIPDATE < date '1995-01-01' AND
> L_DISCOUNT BETWEEN .06 - 0.01 AND .06 + 0.01 AND
> L_QUANTITY <  24;
+---------------------+
| REVENUE             |
+---------------------+
| 11791456.2302       |
+---------------------+

> SELECT
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE,
> SUM(L_QUANTITY)
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> O_ORDERKEY IN (
> SELECT
> L_ORDERKEY
> FROM
> LINEITEM
> GROUP BY
> L_ORDERKEY
> HAVING
> SUM(L_QUANTITY) > 300
> )
> AND C_CUSTKEY = O_CUSTKEY
> AND O_ORDERKEY = L_ORDERKEY
> GROUP BY
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE
> ORDER BY
> O_TOTALPRICE DESC,
> O_ORDERDATE;
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| C_NAME                    | C_CUSTKEY  | O_ORDERKEY | O_ORDERDATE | O_TOTALPRICE    | EXPR$5          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| Customer#000001639        | 1639       | 502886     | 1994-04-12  | 456423.88       | 312.00          |
| Customer#000006655        | 6655       | 29158      | 1995-10-21  | 452805.02       | 305.00          |
| Customer#000014110        | 14110      | 565574     | 1995-09-24  | 425099.85       | 301.00          |
| Customer#000001775        | 1775       | 6882       | 1997-04-09  | 408368.10       | 303.00          |
| Customer#000011459        | 11459      | 551136     | 1993-05-19  | 386812.74       | 308.00          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+

> SELECT
> 100.00 * SUM(CASE WHEN P_TYPE LIKE 'PROMO%'
> THEN L_EXTENDEDPRICE * (1 - L_DISCOUNT)
> ELSE 0
> END) / SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT))
> AS PROMO_REVENUE
> FROM LINEITEM, PART
> WHERE L_PARTKEY = P_PARTKEY
> AND L_SHIPDATE >= DATE'1995-09-01'
> AND L_SHIPDATE < DATE'1995-10-01';
+---------------------+
| PROMO_REVENUE       |
+---------------------+
| 16.286673           |
+---------------------+

> SELECT
> L_RETURNFLAG,
> L_LINESTATUS,
> SUM(L_QUANTITY) AS SUM_QTY,
> SUM(L_EXTENDEDPRICE) AS SUM_BASE_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS SUM_DISC_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) * (1 + L_TAX)) AS SUM_CHARGE,
> AVG(L_QUANTITY) AS AVG_QTY,
> AVG(L_EXTENDEDPRICE) AS AVG_PRICE,
> AVG(L_DISCOUNT) AS AVG_DISC,
> COUNT(*) AS COUNT_ORDER
> FROM
> LINEITEM
> WHERE
> L_SHIPDATE <=  APPLIB.ADD_DAYS(DATE '1998-12-01', -90)
> GROUP BY
> L_RETURNFLAG,
> L_LINESTATUS
> ORDER BY
> L_RETURNFLAG,
> L_LINESTATUS;
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| L_RETURNFLAG | L_LINESTATUS | SUM_QTY         | SUM_BASE_PRICE  | SUM_DISC_PRICE      | SUM_CHARGE          | AVG_QTY         | AVG_PRICE       | AVG_DISC        | COUNT_ORDER         |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| A            | F            | 3773960.00      | 5320278635.08   | 5053666748.7079     | 5256301578.513396   | 25.54           | 36000.13        | 0.05            | 147785              |
| N            | F            | 95215.00        | 133657862.44    | 127053281.6810      | 132208146.584281    | 25.29           | 35500.10        | 0.05            | 3765                |
| N            | O            | 7458794.00      | 10511801578.00  | 9985781685.1221     | 10385084644.533196  | 25.55           | 36002.16        | 0.05            | 291977              |
| R            | F            | 3786739.00      | 5339840631.39   | 5073617146.0790     | 5276284419.499767   | 25.53           | 35998.04        | 0.05            | 148337              |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+

> SELECT
> C_CUSTKEY,
> C_NAME,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> C_ACCTBAL,
> N_NAME,
> C_ADDRESS,
> C_PHONE,
> C_COMMENT
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> NATION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_ORDERDATE >= date '1993-10-01'
> AND O_ORDERDATE < DATE '1994-01-01'
> AND L_RETURNFLAG = 'R'
> AND C_NATIONKEY = N_NATIONKEY
> GROUP BY
> C_CUSTKEY,
> C_NAME,
> C_ACCTBAL,
> C_PHONE,
> N_NAME,
> C_ADDRESS,
> C_COMMENT
> ORDER BY
> REVENUE DESC;
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| C_CUSTKEY  | C_NAME                    | REVENUE             | C_ACCTBAL       | N_NAME                    | C_ADDRESS                                | C_PHONE         | C_COMMENT                                                                                                             |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| 8242       | Customer#000008242        | 622786.7297         | 6322.09         | ETHIOPIA                  | P2n4nJhy,UqSo2s43YfSvYJDZ6lk             | 15-792-676-1184 | slyly regular packages haggle carefully ironic ideas. courts are furiously. furiously unusual theodolites cajole. i   |
| 7714       | Customer#000007714        | 557400.3053         | 9799.98         | IRAN                      | SnnIGB,SkmnWpX3                          | 20-922-418-6024 | arhorses according to the blithely express re                                                                         |
| 11032      | Customer#000011032        | 512500.9641         | 8496.93         | UNITED KINGDOM            | WIKHC7K3Cn7156iNOyfVG3cZ7YqkgsR,Ly       | 33-102-772-3533 | posits-- furiously ironic accounts are again                                                                          |
| 2455       | Customer#000002455        | 481592.4053         | 2070.99         | GERMANY                   | RVn1ZSRtLqPlJLIZxvpmsbgC02               | 17-946-225-9977 | al asymptotes. finally ironic accounts cajole furiously. permanently unusual theodolites aro                          |
| 12106      | Customer#000012106        | 479414.2133         | 5342.11         | UNITED STATES             | wth3twOmu6vy                             | 34-905-346-4472 | ly after the blithely regular foxes. accounts haggle carefully alongside of the blithely even ideas.                  |
| 8530       | Customer#000008530        | 457855.9467         | 9734.95         | MOROCCO                   | GMQyte94oDM7eD7exnkj 4hH9yq3             | 25-736-932-5850 | slyly asymptotes. quickly final deposits in                                                                           |
| 13984      | Customer#000013984        | 446316.5104         | 3482.28         | IRAN                      | qZXwuapCHvxbX                            | 20-981-264-2952 | y unusual courts could wake furiously                                                                                 |
| 1966       | Customer#000001966        | 444059.0382         | 1937.72         | ALGERIA                   | jPv1 UHra5JLALR5Isci5u0636RoAu7t vH      | 10-973-269-8886 | the blithely even accounts. final deposits cajole around the blithely final packages.                                 |
| 11026      | Customer#000011026        | 417913.4142         | 7738.76         | ALGERIA                   | XorIktoJOAEJkpNNMx                       | 10-184-163-4632 | ly even dolphins eat along the blithely even instructions. express attainments cajole slyly. busy dolphins in         |
| 8501       | Customer#000008501        | 412797.5100         | 6906.70         | ARGENTINA                 | 776af4rOa mZ66hczs                       | 11-317-552-5840 | y final deposits after the fluffily even accounts are slyly final, regular                                            |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+

> SELECT
> S_SUPPKEY,
> S_NAME,
> S_ADDRESS,
> S_PHONE,
> TOTAL_REVENUE
> FROM
> SUPPLIER,
> REVENUE0
> WHERE
> S_SUPPKEY = SUPPLIER_NO
> AND TOTAL_REVENUE = (
> SELECT
> MAX(TOTAL_REVENUE)
> FROM
> REVENUE0
> )
> ORDER BY
> S_SUPPKEY;
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| S_SUPPKEY  | S_NAME                    | S_ADDRESS                                | S_PHONE         | TOTAL_REVENUE       |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| 677        | Supplier#000000677        | 8mhrffG7D2WJBSQbOGstQ                    | 23-290-639-3315 | 1614410.2928        |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+

> SELECT
> NATION,
> YYEAR,
> SUM(AMOUNT) AS SUM_PROFIT
> FROM (SELECT
> N_NAME AS NATION,
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) - PS_SUPPLYCOST * L_QUANTITY AS AMOUNT
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> PARTSUPP,
> ORDERS,
> NATION
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND PS_SUPPKEY = L_SUPPKEY
> AND PS_PARTKEY = L_PARTKEY
> AND P_PARTKEY = L_PARTKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND P_NAME LIKE '%green%'
> ) AS PROFIT
> GROUP BY
> NATION,
> YYEAR
> ORDER BY
> NATION,
> YYEAR DESC;
+---------------------------+-------+---------------------+
| NATION                    | YYEAR | SUM_PROFIT          |
+---------------------------+-------+---------------------+
| ALGERIA                   | 1998  | 2334804.6272        |
| ALGERIA                   | 1997  | 3908009.1819        |
| ALGERIA                   | 1996  | 4193307.2158        |
| ALGERIA                   | 1995  | 4159170.6827        |
| ALGERIA                   | 1994  | 4642813.9269        |
| ALGERIA                   | 1993  | 3628134.7118        |
| ALGERIA                   | 1992  | 3453838.6906        |
| ARGENTINA                 | 1998  | 3173981.1186        |
| ARGENTINA                 | 1997  | 4648199.7641        |
| ARGENTINA                 | 1996  | 5269481.5374        |
+---------------------------+-------+---------------------+

> SELECT
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) ) AS REVENUE
> FROM
> LINEITEM,
> PART
> WHERE
> P_PARTKEY = L_PARTKEY
> AND
> ((
> P_BRAND = 'Brand#12'
> AND P_CONTAINER IN ( 'SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
> AND L_QUANTITY >= 1 AND L_QUANTITY <= 1 + 10
> AND P_SIZE BETWEEN 1 AND 5
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#23'
> AND P_CONTAINER IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
> AND L_QUANTITY >= 10 AND L_QUANTITY <= 10 + 10
> AND P_SIZE BETWEEN 1 AND 10
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#34'
> AND P_CONTAINER IN ( 'LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
> AND L_QUANTITY >= 20 AND L_QUANTITY <= 20 + 10
> AND P_SIZE BETWEEN 1 AND 15
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> ));
+---------------------+
| REVENUE             |
+---------------------+
| 168597.2860         |
+---------------------+

> SELECT
> CNTRYCODE,
> COUNT(*) AS NUMCUST,
> SUM(C_ACCTBAL) AS TOTACCTBAL
> FROM (
> SELECT
> SUBSTRING(C_PHONE FROM 1 FOR 2) AS CNTRYCODE,
> C_ACCTBAL
> FROM
> CUSTOMER
> WHERE
> SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> AND C_ACCTBAL > (
> SELECT
> AVG(C_ACCTBAL)
> FROM
> CUSTOMER
> WHERE
> C_ACCTBAL > 0.00
> AND SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> )
> AND NOT EXISTS (
> SELECT
> *
> FROM
> ORDERS
> WHERE
> O_CUSTKEY = C_CUSTKEY
> )
> ) AS CUSTSALE
> GROUP BY
> CNTRYCODE
> ORDER BY
> CNTRYCODE;
+-----------------+---------------------+-----------------+
| CNTRYCODE       | NUMCUST             | TOTACCTBAL      |
+-----------------+---------------------+-----------------+
| 13              | 94                  | 714035.05       |
| 17              | 96                  | 722560.15       |
| 18              | 99                  | 738012.52       |
| 23              | 93                  | 708285.25       |
| 29              | 85                  | 632693.46       |
| 30              | 87                  | 646748.02       |
| 31              | 87                  | 647372.50       |
+-----------------+---------------------+-----------------+

> SELECT
> PS_PARTKEY,
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) AS VAL
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> GROUP BY
> PS_PARTKEY HAVING
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) > (
> SELECT
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) * (0.0001 / 0.1)
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> )
> ORDER BY
> VAL DESC;
+------------+---------------------+
| PS_PARTKEY | VAL                 |
+------------+---------------------+
| 12098      | 16227681.21         |
| 5134       | 15709338.52         |
| 13334      | 15023662.41         |
| 17052      | 14351644.20         |
| 3452       | 14070870.14         |
| 12552      | 13332469.18         |
| 1084       | 13170428.29         |
| 5797       | 13038622.72         |
| 12633      | 12892561.61         |
| 403        | 12856217.34         |
| 1833       | 12024581.72         |
| 2084       | 11502875.36         |
| 17349      | 11354213.05         |
| 18427      | 11282385.24         |
| 2860       | 11262529.95         |
| 17852      | 10934711.93         |
| 9871       | 10889253.68         |
| 12231      | 10841131.39         |
| 6366       | 10759786.81         |
| 12146      | 10257362.66         |
| 5043       | 10226395.88         |
| 12969      | 10125777.93         |
+------------+---------------------+

> SELECT S.S_ACCTBAL, S.S_NAME, N_NAME, PS.PS_PARTKEY, P.P_MFGR,
> S.S_ADDRESS, S.S_PHONE, S.S_COMMENT
> FROM PART P, SUPPLIER S, PARTSUPP PS, NATION, REGION,
> (SELECT PS1.PS_PARTKEY, MIN(PS1.PS_SUPPLYCOST) AS MINCOST
> FROM PARTSUPP PS1, SUPPLIER S1, NATION N1, REGION R1
> WHERE PS1.PS_SUPPKEY = S1.S_SUPPKEY AND
> S1.S_NATIONKEY = N1.N_NATIONKEY AND
> N1.N_REGIONKEY = R1.R_REGIONKEY AND
> R1.R_NAME = 'EUROPE'
> GROUP BY PS1.PS_PARTKEY) AS TEMP
> WHERE P.P_PARTKEY = PS.PS_PARTKEY AND
> S.S_SUPPKEY = PS.PS_SUPPKEY AND
> P.P_SIZE = 15 AND
> P.P_TYPE LIKE '%BRASS' AND
> S.S_NATIONKEY = N_NATIONKEY AND
> N_REGIONKEY = R_REGIONKEY AND
> PS.PS_PARTKEY = TEMP.PS_PARTKEY AND
> PS.PS_SUPPLYCOST = TEMP.MINCOST
> ORDER BY S.S_ACCTBAL DESC, N_NAME, S.S_NAME, PS.PS_PARTKEY;
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| S_ACCTBAL       | S_NAME                    | N_NAME                    | PS_PARTKEY | P_MFGR                    | S_ADDRESS                                | S_PHONE         | S_COMMENT                                                                                             |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| 9828.21         | Supplier#000000647        | UNITED KINGDOM            | 13120      | Manufacturer#5            | x5U7MBZmwfG9                             | 33-258-202-4782 | s the slyly even ideas poach fluffily                                                                 |
| 9508.37         | Supplier#000000070        | FRANCE                    | 3563       | Manufacturer#1            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9508.37         | Supplier#000000070        | FRANCE                    | 17268      | Manufacturer#4            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 10021      | Manufacturer#5            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 13275      | Manufacturer#4            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9192.10         | Supplier#000000115        | UNITED KINGDOM            | 13325      | Manufacturer#1            | nJ 2t0f7Ve,wL1,6WzGBJLNBUCKlsV           | 33-597-248-1220 | es across the carefully express accounts boost caref                                                  |
| 9032.15         | Supplier#000000959        | GERMANY                   | 4958       | Manufacturer#4            | 8grA EHBnwOZhO                           | 17-108-642-3106 | nding dependencies nag furiou                                                                         |
| 8702.02         | Supplier#000000333        | RUSSIA                    | 11810      | Manufacturer#3            | MaVf XgwPdkiX4nfJGOis8Uu2zKiIZH          | 32-508-202-6136 | oss the deposits cajole carefully even pinto beans. regular foxes detect alo                          |
| 8615.50         | Supplier#000000812        | FRANCE                    | 10551      | Manufacturer#2            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
| 8615.50         | Supplier#000000812        | FRANCE                    | 13811      | Manufacturer#4            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+

> SELECT
> C_COUNT, COUNT(*) AS CUSTDIST
> FROM (
> SELECT
> C_CUSTKEY,
> COUNT(O_ORDERKEY)
> FROM
> CUSTOMER LEFT OUTER JOIN ORDERS ON
> C_CUSTKEY = O_CUSTKEY
> AND O_COMMENT NOT LIKE '%special%requests%'
> GROUP BY
> C_CUSTKEY
> )AS C_ORDERS (C_CUSTKEY, C_COUNT)
> GROUP BY
> C_COUNT
> ORDER BY
> CUSTDIST DESC,
> C_COUNT DESC;
+---------------------+---------------------+
| C_COUNT             | CUSTDIST            |
+---------------------+---------------------+
| 0                   | 5000                |
| 10                  | 670                 |
| 9                   | 658                 |
| 11                  | 622                 |
| 8                   | 562                 |
| 12                  | 556                 |
| 13                  | 493                 |
| 7                   | 479                 |
| 18                  | 477                 |
| 14                  | 460                 |
| 20                  | 456                 |
| 19                  | 451                 |
| 16                  | 443                 |
| 15                  | 435                 |
| 17                  | 431                 |
| 21                  | 411                 |
| 22                  | 371                 |
| 6                   | 338                 |
| 23                  | 321                 |
| 24                  | 260                 |
| 5                   | 205                 |
| 25                  | 196                 |
| 26                  | 159                 |
| 27                  | 138                 |
| 28                  | 98                  |
| 4                   | 93                  |
| 29                  | 66                  |
| 3                   | 48                  |
| 30                  | 28                  |
| 31                  | 25                  |
| 33                  | 13                  |
| 32                  | 12                  |
| 2                   | 11                  |
| 35                  | 6                   |
| 34                  | 5                   |
| 1                   | 2                   |
| 36                  | 1                   |
+---------------------+---------------------+

> SELECT
> P_BRAND,
> P_TYPE,
> P_SIZE,
> COUNT(DISTINCT PS_SUPPKEY) AS SUPPLIER_CNT
> FROM
> PARTSUPP,
> PART
> WHERE
> P_PARTKEY = PS_PARTKEY
> AND P_BRAND <> 'Brand#45'
> AND P_TYPE NOT LIKE 'MEDIUM POLISHED%'
> AND P_SIZE IN (49, 14, 23, 45, 19, 3, 36, 9)
> AND PS_SUPPKEY NOT IN (
> SELECT
> S_SUPPKEY
> FROM
> SUPPLIER
> WHERE
> S_COMMENT LIKE '%Customer%Complaints%'
> )
> GROUP BY
> P_BRAND,
> P_TYPE,
> P_SIZE
> ORDER BY
> SUPPLIER_CNT DESC,
> P_BRAND,
> P_TYPE,
> P_SIZE;
+------------+---------------------------+------------+---------------------+
| P_BRAND    | P_TYPE                    | P_SIZE     | SUPPLIER_CNT        |
+------------+---------------------------+------------+---------------------+
| Brand#14   | SMALL ANODIZED NICKEL     | 45         | 12                  |
| Brand#22   | SMALL BURNISHED BRASS     | 19         | 12                  |
| Brand#25   | PROMO POLISHED COPPER     | 14         | 12                  |
| Brand#35   | LARGE ANODIZED STEEL      | 45         | 12                  |
| Brand#35   | PROMO BRUSHED COPPER      | 9          | 12                  |
| Brand#51   | ECONOMY ANODIZED STEEL    | 9          | 12                  |
| Brand#53   | LARGE BRUSHED NICKEL      | 45         | 12                  |
| Brand#11   | ECONOMY POLISHED COPPER   | 14         | 8                   |
| Brand#11   | LARGE PLATED STEEL        | 23         | 8                   |
| Brand#11   | PROMO POLISHED STEEL      | 23         | 8                   |
+------------+---------------------------+------------+---------------------+

> SELECT
> L_SHIPMODE,
> SUM(CASE WHEN O_ORDERPRIORITY = '1-URGENT'
> OR O_ORDERPRIORITY = '2-HIGH'
> THEN 1
> ELSE 0
> END) AS HIGH_LINE_COUNT,
> SUM(CASE WHEN O_ORDERPRIORITY <> '1-URGENT'
> AND O_ORDERPRIORITY <> '2-HIGH'
> THEN 1
> ELSE 0
> END) AS LOW_LINE_COUNT
> FROM ORDERS, LINEITEM
> WHERE
> O_ORDERKEY = L_ORDERKEY
> AND L_SHIPMODE IN ('MAIL', 'SHIP')
> AND L_COMMITDATE < L_RECEIPTDATE
> AND L_SHIPDATE < L_COMMITDATE
> AND L_RECEIPTDATE >= DATE'1994-01-01'
> AND L_RECEIPTDATE < DATE'1995-01-01'
> GROUP BY L_SHIPMODE
> ORDER BY L_SHIPMODE;
+------------+-----------------+----------------+
| L_SHIPMODE | HIGH_LINE_COUNT | LOW_LINE_COUNT |
+------------+-----------------+----------------+
| MAIL       | 647             | 947            |
| SHIP       | 620             | 942            |
+------------+-----------------+----------------+

> SELECT
> L_ORDERKEY,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> O_ORDERDATE,
> O_SHIPPRIORITY
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> C_MKTSEGMENT = 'BUILDING' AND
> C_CUSTKEY = O_CUSTKEY AND
> L_ORDERKEY = O_ORDERKEY AND
> O_ORDERDATE < DATE '1995-03-15' AND
> L_SHIPDATE > DATE '1995-03-15'
> GROUP BY
> L_ORDERKEY,
> O_ORDERDATE,
> O_SHIPPRIORITY
> ORDER BY
> REVENUE DESC,
> O_ORDERDATE;
+------------+---------------------+-------------+----------------+
| L_ORDERKEY | REVENUE             | O_ORDERDATE | O_SHIPPRIORITY |
+------------+---------------------+-------------+----------------+
| 223140     | 355369.0698         | 1995-03-14  | 0              |
| 584291     | 354494.7318         | 1995-02-21  | 0              |
| 405063     | 353125.4577         | 1995-03-03  | 0              |
| 573861     | 351238.2770         | 1995-03-09  | 0              |
| 554757     | 349181.7426         | 1995-03-14  | 0              |
| 506021     | 321075.5810         | 1995-03-10  | 0              |
| 121604     | 318576.4154         | 1995-03-07  | 0              |
| 108514     | 314967.0754         | 1995-02-20  | 0              |
| 462502     | 312604.5420         | 1995-03-08  | 0              |
| 178727     | 309728.9306         | 1995-02-25  | 0              |
+------------+---------------------+-------------+----------------+

> SELECT
> S_NAME,
> S_ADDRESS
> FROM
> SUPPLIER,
> NATION
> WHERE
> S_SUPPKEY IN (
> SELECT
> PS_SUPPKEY
> FROM
> PARTSUPP
> WHERE
> PS_PARTKEY IN (
> SELECT
> P_PARTKEY
> FROM
> PART
> WHERE
> P_NAME LIKE 'forest%'
> )
> AND PS_AVAILQTY > (
> SELECT
> 0.5 * SUM(L_QUANTITY)
> FROM
> LINEITEM
> WHERE
> L_PARTKEY = PS_PARTKEY
> AND L_SUPPKEY = PS_SUPPKEY
> AND L_SHIPDATE >= DATE '1994-01-01'
> AND L_SHIPDATE < DATE '1995-01-01'
> )
> )
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'CANADA'
> ORDER BY
> S_NAME;
+---------------------------+------------------------------------------+
| S_NAME                    | S_ADDRESS                                |
+---------------------------+------------------------------------------+
| Supplier#000000013        | HK71HQyWoqRWOX8GI FpgAifW,2PoH           |
| Supplier#000000020        | iybAE,RmTymrZVYaFZva2SH,j                |
| Supplier#000000091        | YV45D7TkfdQanOOZ7q9QxkyGUapU1oOWU6q3     |
| Supplier#000000157        | ,mEGorBfVIm                              |
| Supplier#000000197        | YC2Acon6kjY3zj3Fbxs2k4Vdf7X0cd2F         |
| Supplier#000000205        | rF uV8d0JNEk                             |
| Supplier#000000285        | Br7e1nnt1yxrw6ImgpJ7YdhFDjuBf            |
| Supplier#000000287        | 7a9SP7qW5Yku5PvSg                        |
| Supplier#000000358        | V3yxhHhHSXqOoc5UPv5TwkVDGKQsG            |
| Supplier#000000402        | i9Sw4DoyMhzhKXCH9By,AYSgmD               |
| Supplier#000000431        | WoeV,NINojE6hJjauAdrl5fGcdxX5JUPLnrim    |
| Supplier#000000530        | 0qwCMwobKY OcmLyfRXlagA8ukENJv,          |
| Supplier#000000555        | TfB,a5bfl3Ah 3Z 74GqnNs6zKVGM            |
| Supplier#000000557        | jj0wUYh9K3fG5Jhdhrkuy ,4                 |
| Supplier#000000640        | mvvtlQKsTOsJj5Ihk7,cq                    |
| Supplier#000000729        | pqck2ppy758TQpZCUAjPvlU55K3QjfL7Bi       |
| Supplier#000000736        | l6i2nMwVuovfKnuVgaSGK2rDy65DlAFLegiL7    |
| Supplier#000000744        | 5NKuw5W4mFDMQBbUjUO4k kfokG8yvAe         |
| Supplier#000000752        | l cHMtEnodxj3FV                          |
| Supplier#000000848        | tx44JAuF,Jnw1                            |
| Supplier#000000997        | 7eUWMrOCKCp2JYas6P4mL93eaWIOtKKWtTX      |
+---------------------------+------------------------------------------+

> alter session set "label" = null;
0 rows affected.
-- end of thread queries2

-- thread queries3
> set schema 'rwconcur';
0 rows affected.
> alter session set "label" = 'AFTERUPDATE2';
0 rows affected.
> SELECT
> N_NAME,
> SUM(L_EXTENDEDPRICE * ( 1 - L_DISCOUNT)) AS REVENUE
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> SUPPLIER,
> NATION,
> REGION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND L_SUPPKEY = S_SUPPKEY
> AND C_NATIONKEY = S_NATIONKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'ASIA'
> AND O_ORDERDATE >=  date '1994-01-01'
> AND O_ORDERDATE < DATE '1995-01-01'
> GROUP BY
> N_NAME
> ORDER BY
> REVENUE DESC;
+---------------------------+---------------------+
| N_NAME                    | REVENUE             |
+---------------------------+---------------------+
| CHINA                     | 7849559.4460        |
| INDIA                     | 6336585.5105        |
| JAPAN                     | 5951101.3784        |
| INDONESIA                 | 5580475.4027        |
| VIETNAM                   | 4479888.8325        |
+---------------------------+---------------------+

> SELECT
> O_ORDERPRIORITY,
> COUNT(*) AS ORDER_COUNT
> FROM ORDERS
> WHERE
> O_ORDERDATE >= DATE '1993-07-01'
> AND O_ORDERDATE < DATE '1993-10-01'
> AND EXISTS (
> SELECT
> *
> FROM
> LINEITEM
> WHERE
> L_ORDERKEY = O_ORDERKEY
> AND L_COMMITDATE < L_RECEIPTDATE
> )
> GROUP BY
> O_ORDERPRIORITY
> ORDER BY
> O_ORDERPRIORITY;
+-----------------+---------------------+
| O_ORDERPRIORITY | ORDER_COUNT         |
+-----------------+---------------------+
| 1-URGENT        | 999                 |
| 2-HIGH          | 999                 |
| 3-MEDIUM        | 1034                |
| 4-NOT SPECIFIED | 988                 |
| 5-LOW           | 1078                |
+-----------------+---------------------+

> SELECT SUM(L_EXTENDEDPRICE * L_DISCOUNT) AS REVENUE
> FROM LINEITEM
> WHERE
> L_SHIPDATE >= DATE '1994-01-01' AND
> L_SHIPDATE < date '1995-01-01' AND
> L_DISCOUNT BETWEEN .06 - 0.01 AND .06 + 0.01 AND
> L_QUANTITY <  24;
+---------------------+
| REVENUE             |
+---------------------+
| 11790401.0133       |
+---------------------+

> SELECT SUM(L_EXTENDEDPRICE) / 7.0 AS AVG_YEARLY
> FROM LINEITEM L, PART,
> (SELECT L1.L_PARTKEY, (0.2 * AVG(L_QUANTITY)) AS AVGQTY
> FROM LINEITEM L1
> GROUP BY L1.L_PARTKEY) AS TEMP
> WHERE
> P_PARTKEY = L.L_PARTKEY AND
> P_BRAND = 'Brand#23' AND
> P_CONTAINER = 'MED BOX' AND
> P_PARTKEY = TEMP.L_PARTKEY AND
> L.L_QUANTITY < TEMP.AVGQTY;
+---------------------+
| AVG_YEARLY          |
+---------------------+
| 23512.752857        |
+---------------------+

> SELECT
> YYEAR,
> CAST(SUM(CASE WHEN NATION = 'BRAZIL'
> THEN VOLUME
> ELSE 0
> END) AS DECIMAL(19,4))*1.0000 /
> CAST(SUM(VOLUME) AS DECIMAL(19,4)) AS MKT_SHARE
> FROM (SELECT
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME,
> N2.N_NAME AS NATION
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2,
> REGION
> WHERE
> P_PARTKEY = L_PARTKEY
> AND S_SUPPKEY = L_SUPPKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_CUSTKEY = C_CUSTKEY
> AND C_NATIONKEY = N1.N_NATIONKEY
> AND N1.N_REGIONKEY = R_REGIONKEY
> AND R_NAME = 'AMERICA'
> AND S_NATIONKEY = N2.N_NATIONKEY
> AND O_ORDERDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> AND P_TYPE = 'ECONOMY ANODIZED STEEL') AS ALL_NATIONS
> GROUP BY YYEAR
> ORDER BY YYEAR;
+-------+---------------------+
| YYEAR | MKT_SHARE           |
+-------+---------------------+
| 1995  | 0.028649            |
| 1996  | 0.018250            |
+-------+---------------------+

> SELECT
> L_RETURNFLAG,
> L_LINESTATUS,
> SUM(L_QUANTITY) AS SUM_QTY,
> SUM(L_EXTENDEDPRICE) AS SUM_BASE_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS SUM_DISC_PRICE,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) * (1 + L_TAX)) AS SUM_CHARGE,
> AVG(L_QUANTITY) AS AVG_QTY,
> AVG(L_EXTENDEDPRICE) AS AVG_PRICE,
> AVG(L_DISCOUNT) AS AVG_DISC,
> COUNT(*) AS COUNT_ORDER
> FROM
> LINEITEM
> WHERE
> L_SHIPDATE <=  APPLIB.ADD_DAYS(DATE '1998-12-01', -90)
> GROUP BY
> L_RETURNFLAG,
> L_LINESTATUS
> ORDER BY
> L_RETURNFLAG,
> L_LINESTATUS;
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| L_RETURNFLAG | L_LINESTATUS | SUM_QTY         | SUM_BASE_PRICE  | SUM_DISC_PRICE      | SUM_CHARGE          | AVG_QTY         | AVG_PRICE       | AVG_DISC        | COUNT_ORDER         |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+
| A            | F            | 3775299.00      | 5321924399.20   | 5055187429.3684     | 5257890533.999707   | 25.54           | 36001.03        | 0.05            | 147827              |
| N            | F            | 95184.00        | 133618633.69    | 127011938.2323      | 132165967.954221    | 25.29           | 35499.11        | 0.05            | 3764                |
| N            | O            | 7458127.00      | 10510540287.65  | 9984619896.9243     | 10383852053.076596  | 25.55           | 36001.66        | 0.05            | 291946              |
| R            | F            | 3787340.00      | 5340572063.80   | 5074316743.3989     | 5276992152.509269   | 25.53           | 35998.36        | 0.05            | 148356              |
+--------------+--------------+-----------------+-----------------+---------------------+---------------------+-----------------+-----------------+-----------------+---------------------+

> SELECT
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE,
> SUM(L_QUANTITY)
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> O_ORDERKEY IN (
> SELECT
> L_ORDERKEY
> FROM
> LINEITEM
> GROUP BY
> L_ORDERKEY
> HAVING
> SUM(L_QUANTITY) > 300
> )
> AND C_CUSTKEY = O_CUSTKEY
> AND O_ORDERKEY = L_ORDERKEY
> GROUP BY
> C_NAME,
> C_CUSTKEY,
> O_ORDERKEY,
> O_ORDERDATE,
> O_TOTALPRICE
> ORDER BY
> O_TOTALPRICE DESC,
> O_ORDERDATE;
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| C_NAME                    | C_CUSTKEY  | O_ORDERKEY | O_ORDERDATE | O_TOTALPRICE    | EXPR$5          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+
| Customer#000001639        | 1639       | 502886     | 1994-04-12  | 456423.88       | 312.00          |
| Customer#000006655        | 6655       | 29158      | 1995-10-21  | 452805.02       | 305.00          |
| Customer#000014110        | 14110      | 565574     | 1995-09-24  | 425099.85       | 301.00          |
| Customer#000001775        | 1775       | 6882       | 1997-04-09  | 408368.10       | 303.00          |
| Customer#000011459        | 11459      | 551136     | 1993-05-19  | 386812.74       | 308.00          |
+---------------------------+------------+------------+-------------+-----------------+-----------------+

> SELECT
> 100.00 * SUM(CASE WHEN P_TYPE LIKE 'PROMO%'
> THEN L_EXTENDEDPRICE * (1 - L_DISCOUNT)
> ELSE 0
> END) / SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT))
> AS PROMO_REVENUE
> FROM LINEITEM, PART
> WHERE L_PARTKEY = P_PARTKEY
> AND L_SHIPDATE >= DATE'1995-09-01'
> AND L_SHIPDATE < DATE'1995-10-01';
+---------------------+
| PROMO_REVENUE       |
+---------------------+
| 16.303011           |
+---------------------+

> SELECT
> SUPP_NATION,
> CUST_NATION,
> YYEAR,
> SUM(VOLUME) AS REVENUE
> FROM
> (SELECT
> N1.N_NAME AS SUPP_NATION,
> N2.N_NAME AS CUST_NATION,
> APPLIB.DATE_TO_CHAR('yyyy', L_SHIPDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) AS VOLUME
> FROM
> SUPPLIER,
> LINEITEM,
> ORDERS,
> CUSTOMER,
> NATION N1,
> NATION N2
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND C_CUSTKEY = O_CUSTKEY
> AND S_NATIONKEY = N1.N_NATIONKEY
> AND C_NATIONKEY = N2.N_NATIONKEY
> AND ((N1.N_NAME = 'FRANCE' AND N2.N_NAME = 'GERMANY')
> OR (N1.N_NAME = 'GERMANY' AND N2.N_NAME = 'FRANCE'))
> AND L_SHIPDATE BETWEEN DATE'1995-01-01' AND DATE'1996-12-31'
> ) AS SHIPPING
> GROUP BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR
> ORDER BY
> SUPP_NATION,
> CUST_NATION,
> YYEAR;
+---------------------------+---------------------------+-------+---------------------+
| SUPP_NATION               | CUST_NATION               | YYEAR | REVENUE             |
+---------------------------+---------------------------+-------+---------------------+
| FRANCE                    | GERMANY                   | 1995  | 4637235.1501        |
| FRANCE                    | GERMANY                   | 1996  | 5224779.5736        |
| GERMANY                   | FRANCE                    | 1995  | 6232818.7037        |
| GERMANY                   | FRANCE                    | 1996  | 5557312.1121        |
+---------------------------+---------------------------+-------+---------------------+

> SELECT
> C_CUSTKEY,
> C_NAME,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> C_ACCTBAL,
> N_NAME,
> C_ADDRESS,
> C_PHONE,
> C_COMMENT
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM,
> NATION
> WHERE
> C_CUSTKEY = O_CUSTKEY
> AND L_ORDERKEY = O_ORDERKEY
> AND O_ORDERDATE >= date '1993-10-01'
> AND O_ORDERDATE < DATE '1994-01-01'
> AND L_RETURNFLAG = 'R'
> AND C_NATIONKEY = N_NATIONKEY
> GROUP BY
> C_CUSTKEY,
> C_NAME,
> C_ACCTBAL,
> C_PHONE,
> N_NAME,
> C_ADDRESS,
> C_COMMENT
> ORDER BY
> REVENUE DESC;
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| C_CUSTKEY  | C_NAME                    | REVENUE             | C_ACCTBAL       | N_NAME                    | C_ADDRESS                                | C_PHONE         | C_COMMENT                                                                                                             |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+
| 8242       | Customer#000008242        | 622786.7297         | 6322.09         | ETHIOPIA                  | P2n4nJhy,UqSo2s43YfSvYJDZ6lk             | 15-792-676-1184 | slyly regular packages haggle carefully ironic ideas. courts are furiously. furiously unusual theodolites cajole. i   |
| 7714       | Customer#000007714        | 557400.3053         | 9799.98         | IRAN                      | SnnIGB,SkmnWpX3                          | 20-922-418-6024 | arhorses according to the blithely express re                                                                         |
| 11032      | Customer#000011032        | 512500.9641         | 8496.93         | UNITED KINGDOM            | WIKHC7K3Cn7156iNOyfVG3cZ7YqkgsR,Ly       | 33-102-772-3533 | posits-- furiously ironic accounts are again                                                                          |
| 2455       | Customer#000002455        | 481592.4053         | 2070.99         | GERMANY                   | RVn1ZSRtLqPlJLIZxvpmsbgC02               | 17-946-225-9977 | al asymptotes. finally ironic accounts cajole furiously. permanently unusual theodolites aro                          |
| 12106      | Customer#000012106        | 479414.2133         | 5342.11         | UNITED STATES             | wth3twOmu6vy                             | 34-905-346-4472 | ly after the blithely regular foxes. accounts haggle carefully alongside of the blithely even ideas.                  |
| 8530       | Customer#000008530        | 457855.9467         | 9734.95         | MOROCCO                   | GMQyte94oDM7eD7exnkj 4hH9yq3             | 25-736-932-5850 | slyly asymptotes. quickly final deposits in                                                                           |
| 13984      | Customer#000013984        | 446316.5104         | 3482.28         | IRAN                      | qZXwuapCHvxbX                            | 20-981-264-2952 | y unusual courts could wake furiously                                                                                 |
| 1966       | Customer#000001966        | 444059.0382         | 1937.72         | ALGERIA                   | jPv1 UHra5JLALR5Isci5u0636RoAu7t vH      | 10-973-269-8886 | the blithely even accounts. final deposits cajole around the blithely final packages.                                 |
| 2104       | Customer#000002104        | 438617.6982         | 5533.39         | UNITED STATES             | 5OZFQ dlhF4                              | 34-786-781-9766 | y regular asymptotes. final platel                                                                                    |
| 11026      | Customer#000011026        | 417913.4142         | 7738.76         | ALGERIA                   | XorIktoJOAEJkpNNMx                       | 10-184-163-4632 | ly even dolphins eat along the blithely even instructions. express attainments cajole slyly. busy dolphins in         |
+------------+---------------------------+---------------------+-----------------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------------------------+

> SELECT
> S_SUPPKEY,
> S_NAME,
> S_ADDRESS,
> S_PHONE,
> TOTAL_REVENUE
> FROM
> SUPPLIER,
> REVENUE0
> WHERE
> S_SUPPKEY = SUPPLIER_NO
> AND TOTAL_REVENUE = (
> SELECT
> MAX(TOTAL_REVENUE)
> FROM
> REVENUE0
> )
> ORDER BY
> S_SUPPKEY;
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| S_SUPPKEY  | S_NAME                    | S_ADDRESS                                | S_PHONE         | TOTAL_REVENUE       |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+
| 677        | Supplier#000000677        | 8mhrffG7D2WJBSQbOGstQ                    | 23-290-639-3315 | 1614410.2928        |
+------------+---------------------------+------------------------------------------+-----------------+---------------------+

> SELECT
> PS_PARTKEY,
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) AS VAL
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> GROUP BY
> PS_PARTKEY HAVING
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) > (
> SELECT
> SUM(PS_SUPPLYCOST * PS_AVAILQTY) * (0.0001 / 0.1)
> FROM
> PARTSUPP,
> SUPPLIER,
> NATION
> WHERE
> PS_SUPPKEY = S_SUPPKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'GERMANY'
> )
> ORDER BY
> VAL DESC;
+------------+---------------------+
| PS_PARTKEY | VAL                 |
+------------+---------------------+
| 12098      | 16227681.21         |
| 5134       | 15709338.52         |
| 13334      | 15023662.41         |
| 17052      | 14351644.20         |
| 3452       | 14070870.14         |
| 12552      | 13332469.18         |
| 1084       | 13170428.29         |
| 5797       | 13038622.72         |
| 12633      | 12892561.61         |
| 403        | 12856217.34         |
| 1833       | 12024581.72         |
| 2084       | 11502875.36         |
| 17349      | 11354213.05         |
| 18427      | 11282385.24         |
| 2860       | 11262529.95         |
| 17852      | 10934711.93         |
| 9871       | 10889253.68         |
| 12231      | 10841131.39         |
| 6366       | 10759786.81         |
| 12146      | 10257362.66         |
| 5043       | 10226395.88         |
| 12969      | 10125777.93         |
+------------+---------------------+

> SELECT
> NATION,
> YYEAR,
> SUM(AMOUNT) AS SUM_PROFIT
> FROM (SELECT
> N_NAME AS NATION,
> APPLIB.DATE_TO_CHAR('yyyy', O_ORDERDATE) AS YYEAR,
> L_EXTENDEDPRICE * (1 - L_DISCOUNT) - PS_SUPPLYCOST * L_QUANTITY AS AMOUNT
> FROM
> PART,
> SUPPLIER,
> LINEITEM,
> PARTSUPP,
> ORDERS,
> NATION
> WHERE
> S_SUPPKEY = L_SUPPKEY
> AND PS_SUPPKEY = L_SUPPKEY
> AND PS_PARTKEY = L_PARTKEY
> AND P_PARTKEY = L_PARTKEY
> AND O_ORDERKEY = L_ORDERKEY
> AND S_NATIONKEY = N_NATIONKEY
> AND P_NAME LIKE '%green%'
> ) AS PROFIT
> GROUP BY
> NATION,
> YYEAR
> ORDER BY
> NATION,
> YYEAR DESC;
+---------------------------+-------+---------------------+
| NATION                    | YYEAR | SUM_PROFIT          |
+---------------------------+-------+---------------------+
| ALGERIA                   | 1998  | 2334804.6272        |
| ALGERIA                   | 1997  | 3908009.1819        |
| ALGERIA                   | 1996  | 4208437.4708        |
| ALGERIA                   | 1995  | 4159170.6827        |
| ALGERIA                   | 1994  | 4642813.9269        |
| ALGERIA                   | 1993  | 3628134.7118        |
| ALGERIA                   | 1992  | 3453838.6906        |
| ARGENTINA                 | 1998  | 3173981.1186        |
| ARGENTINA                 | 1997  | 4648199.7641        |
| ARGENTINA                 | 1996  | 5245774.4014        |
+---------------------------+-------+---------------------+

> SELECT
> CNTRYCODE,
> COUNT(*) AS NUMCUST,
> SUM(C_ACCTBAL) AS TOTACCTBAL
> FROM (
> SELECT
> SUBSTRING(C_PHONE FROM 1 FOR 2) AS CNTRYCODE,
> C_ACCTBAL
> FROM
> CUSTOMER
> WHERE
> SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> AND C_ACCTBAL > (
> SELECT
> AVG(C_ACCTBAL)
> FROM
> CUSTOMER
> WHERE
> C_ACCTBAL > 0.00
> AND SUBSTRING(C_PHONE FROM 1 FOR 2) IN
> ('13','31','23','29','30','18','17')
> )
> AND NOT EXISTS (
> SELECT
> *
> FROM
> ORDERS
> WHERE
> O_CUSTKEY = C_CUSTKEY
> )
> ) AS CUSTSALE
> GROUP BY
> CNTRYCODE
> ORDER BY
> CNTRYCODE;
+-----------------+---------------------+-----------------+
| CNTRYCODE       | NUMCUST             | TOTACCTBAL      |
+-----------------+---------------------+-----------------+
| 13              | 94                  | 714035.05       |
| 17              | 96                  | 722560.15       |
| 18              | 99                  | 738012.52       |
| 23              | 93                  | 708285.25       |
| 29              | 85                  | 632693.46       |
| 30              | 87                  | 646748.02       |
| 31              | 87                  | 647372.50       |
+-----------------+---------------------+-----------------+

> SELECT
> S_NAME,
> S_ADDRESS
> FROM
> SUPPLIER,
> NATION
> WHERE
> S_SUPPKEY IN (
> SELECT
> PS_SUPPKEY
> FROM
> PARTSUPP
> WHERE
> PS_PARTKEY IN (
> SELECT
> P_PARTKEY
> FROM
> PART
> WHERE
> P_NAME LIKE 'forest%'
> )
> AND PS_AVAILQTY > (
> SELECT
> 0.5 * SUM(L_QUANTITY)
> FROM
> LINEITEM
> WHERE
> L_PARTKEY = PS_PARTKEY
> AND L_SUPPKEY = PS_SUPPKEY
> AND L_SHIPDATE >= DATE '1994-01-01'
> AND L_SHIPDATE < DATE '1995-01-01'
> )
> )
> AND S_NATIONKEY = N_NATIONKEY
> AND N_NAME = 'CANADA'
> ORDER BY
> S_NAME;
+---------------------------+------------------------------------------+
| S_NAME                    | S_ADDRESS                                |
+---------------------------+------------------------------------------+
| Supplier#000000013        | HK71HQyWoqRWOX8GI FpgAifW,2PoH           |
| Supplier#000000020        | iybAE,RmTymrZVYaFZva2SH,j                |
| Supplier#000000091        | YV45D7TkfdQanOOZ7q9QxkyGUapU1oOWU6q3     |
| Supplier#000000157        | ,mEGorBfVIm                              |
| Supplier#000000197        | YC2Acon6kjY3zj3Fbxs2k4Vdf7X0cd2F         |
| Supplier#000000205        | rF uV8d0JNEk                             |
| Supplier#000000285        | Br7e1nnt1yxrw6ImgpJ7YdhFDjuBf            |
| Supplier#000000287        | 7a9SP7qW5Yku5PvSg                        |
| Supplier#000000358        | V3yxhHhHSXqOoc5UPv5TwkVDGKQsG            |
| Supplier#000000402        | i9Sw4DoyMhzhKXCH9By,AYSgmD               |
| Supplier#000000431        | WoeV,NINojE6hJjauAdrl5fGcdxX5JUPLnrim    |
| Supplier#000000530        | 0qwCMwobKY OcmLyfRXlagA8ukENJv,          |
| Supplier#000000555        | TfB,a5bfl3Ah 3Z 74GqnNs6zKVGM            |
| Supplier#000000557        | jj0wUYh9K3fG5Jhdhrkuy ,4                 |
| Supplier#000000640        | mvvtlQKsTOsJj5Ihk7,cq                    |
| Supplier#000000729        | pqck2ppy758TQpZCUAjPvlU55K3QjfL7Bi       |
| Supplier#000000736        | l6i2nMwVuovfKnuVgaSGK2rDy65DlAFLegiL7    |
| Supplier#000000744        | 5NKuw5W4mFDMQBbUjUO4k kfokG8yvAe         |
| Supplier#000000752        | l cHMtEnodxj3FV                          |
| Supplier#000000848        | tx44JAuF,Jnw1                            |
| Supplier#000000997        | 7eUWMrOCKCp2JYas6P4mL93eaWIOtKKWtTX      |
+---------------------------+------------------------------------------+

> SELECT
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT) ) AS REVENUE
> FROM
> LINEITEM,
> PART
> WHERE
> P_PARTKEY = L_PARTKEY
> AND
> ((
> P_BRAND = 'Brand#12'
> AND P_CONTAINER IN ( 'SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
> AND L_QUANTITY >= 1 AND L_QUANTITY <= 1 + 10
> AND P_SIZE BETWEEN 1 AND 5
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#23'
> AND P_CONTAINER IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
> AND L_QUANTITY >= 10 AND L_QUANTITY <= 10 + 10
> AND P_SIZE BETWEEN 1 AND 10
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> )
> OR
> (
> P_BRAND = 'Brand#34'
> AND P_CONTAINER IN ( 'LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
> AND L_QUANTITY >= 20 AND L_QUANTITY <= 20 + 10
> AND P_SIZE BETWEEN 1 AND 15
> AND L_SHIPMODE IN ('AIR', 'AIR REG')
> AND L_SHIPINSTRUCT = 'DELIVER IN PERSON'
> ));
+---------------------+
| REVENUE             |
+---------------------+
| 168597.2860         |
+---------------------+

> SELECT
> C_COUNT, COUNT(*) AS CUSTDIST
> FROM (
> SELECT
> C_CUSTKEY,
> COUNT(O_ORDERKEY)
> FROM
> CUSTOMER LEFT OUTER JOIN ORDERS ON
> C_CUSTKEY = O_CUSTKEY
> AND O_COMMENT NOT LIKE '%special%requests%'
> GROUP BY
> C_CUSTKEY
> )AS C_ORDERS (C_CUSTKEY, C_COUNT)
> GROUP BY
> C_COUNT
> ORDER BY
> CUSTDIST DESC,
> C_COUNT DESC;
+---------------------+---------------------+
| C_COUNT             | CUSTDIST            |
+---------------------+---------------------+
| 0                   | 5000                |
| 10                  | 662                 |
| 9                   | 656                 |
| 11                  | 628                 |
| 8                   | 569                 |
| 12                  | 552                 |
| 13                  | 504                 |
| 7                   | 478                 |
| 18                  | 475                 |
| 19                  | 459                 |
| 14                  | 453                 |
| 20                  | 448                 |
| 16                  | 438                 |
| 15                  | 437                 |
| 17                  | 435                 |
| 21                  | 406                 |
| 22                  | 369                 |
| 6                   | 337                 |
| 23                  | 324                 |
| 24                  | 264                 |
| 5                   | 204                 |
| 25                  | 194                 |
| 26                  | 160                 |
| 27                  | 140                 |
| 28                  | 97                  |
| 4                   | 94                  |
| 29                  | 64                  |
| 3                   | 48                  |
| 30                  | 30                  |
| 31                  | 23                  |
| 32                  | 14                  |
| 33                  | 12                  |
| 2                   | 10                  |
| 35                  | 6                   |
| 34                  | 6                   |
| 1                   | 3                   |
| 36                  | 1                   |
+---------------------+---------------------+

> SELECT
> P_BRAND,
> P_TYPE,
> P_SIZE,
> COUNT(DISTINCT PS_SUPPKEY) AS SUPPLIER_CNT
> FROM
> PARTSUPP,
> PART
> WHERE
> P_PARTKEY = PS_PARTKEY
> AND P_BRAND <> 'Brand#45'
> AND P_TYPE NOT LIKE 'MEDIUM POLISHED%'
> AND P_SIZE IN (49, 14, 23, 45, 19, 3, 36, 9)
> AND PS_SUPPKEY NOT IN (
> SELECT
> S_SUPPKEY
> FROM
> SUPPLIER
> WHERE
> S_COMMENT LIKE '%Customer%Complaints%'
> )
> GROUP BY
> P_BRAND,
> P_TYPE,
> P_SIZE
> ORDER BY
> SUPPLIER_CNT DESC,
> P_BRAND,
> P_TYPE,
> P_SIZE;
+------------+---------------------------+------------+---------------------+
| P_BRAND    | P_TYPE                    | P_SIZE     | SUPPLIER_CNT        |
+------------+---------------------------+------------+---------------------+
| Brand#14   | SMALL ANODIZED NICKEL     | 45         | 12                  |
| Brand#22   | SMALL BURNISHED BRASS     | 19         | 12                  |
| Brand#25   | PROMO POLISHED COPPER     | 14         | 12                  |
| Brand#35   | LARGE ANODIZED STEEL      | 45         | 12                  |
| Brand#35   | PROMO BRUSHED COPPER      | 9          | 12                  |
| Brand#51   | ECONOMY ANODIZED STEEL    | 9          | 12                  |
| Brand#53   | LARGE BRUSHED NICKEL      | 45         | 12                  |
| Brand#11   | ECONOMY POLISHED COPPER   | 14         | 8                   |
| Brand#11   | LARGE PLATED STEEL        | 23         | 8                   |
| Brand#11   | PROMO POLISHED STEEL      | 23         | 8                   |
+------------+---------------------------+------------+---------------------+

> SELECT
> L_SHIPMODE,
> SUM(CASE WHEN O_ORDERPRIORITY = '1-URGENT'
> OR O_ORDERPRIORITY = '2-HIGH'
> THEN 1
> ELSE 0
> END) AS HIGH_LINE_COUNT,
> SUM(CASE WHEN O_ORDERPRIORITY <> '1-URGENT'
> AND O_ORDERPRIORITY <> '2-HIGH'
> THEN 1
> ELSE 0
> END) AS LOW_LINE_COUNT
> FROM ORDERS, LINEITEM
> WHERE
> O_ORDERKEY = L_ORDERKEY
> AND L_SHIPMODE IN ('MAIL', 'SHIP')
> AND L_COMMITDATE < L_RECEIPTDATE
> AND L_SHIPDATE < L_COMMITDATE
> AND L_RECEIPTDATE >= DATE'1994-01-01'
> AND L_RECEIPTDATE < DATE'1995-01-01'
> GROUP BY L_SHIPMODE
> ORDER BY L_SHIPMODE;
+------------+-----------------+----------------+
| L_SHIPMODE | HIGH_LINE_COUNT | LOW_LINE_COUNT |
+------------+-----------------+----------------+
| MAIL       | 645             | 946            |
| SHIP       | 621             | 943            |
+------------+-----------------+----------------+

> SELECT S.S_ACCTBAL, S.S_NAME, N_NAME, PS.PS_PARTKEY, P.P_MFGR,
> S.S_ADDRESS, S.S_PHONE, S.S_COMMENT
> FROM PART P, SUPPLIER S, PARTSUPP PS, NATION, REGION,
> (SELECT PS1.PS_PARTKEY, MIN(PS1.PS_SUPPLYCOST) AS MINCOST
> FROM PARTSUPP PS1, SUPPLIER S1, NATION N1, REGION R1
> WHERE PS1.PS_SUPPKEY = S1.S_SUPPKEY AND
> S1.S_NATIONKEY = N1.N_NATIONKEY AND
> N1.N_REGIONKEY = R1.R_REGIONKEY AND
> R1.R_NAME = 'EUROPE'
> GROUP BY PS1.PS_PARTKEY) AS TEMP
> WHERE P.P_PARTKEY = PS.PS_PARTKEY AND
> S.S_SUPPKEY = PS.PS_SUPPKEY AND
> P.P_SIZE = 15 AND
> P.P_TYPE LIKE '%BRASS' AND
> S.S_NATIONKEY = N_NATIONKEY AND
> N_REGIONKEY = R_REGIONKEY AND
> PS.PS_PARTKEY = TEMP.PS_PARTKEY AND
> PS.PS_SUPPLYCOST = TEMP.MINCOST
> ORDER BY S.S_ACCTBAL DESC, N_NAME, S.S_NAME, PS.PS_PARTKEY;
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| S_ACCTBAL       | S_NAME                    | N_NAME                    | PS_PARTKEY | P_MFGR                    | S_ADDRESS                                | S_PHONE         | S_COMMENT                                                                                             |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+
| 9828.21         | Supplier#000000647        | UNITED KINGDOM            | 13120      | Manufacturer#5            | x5U7MBZmwfG9                             | 33-258-202-4782 | s the slyly even ideas poach fluffily                                                                 |
| 9508.37         | Supplier#000000070        | FRANCE                    | 3563       | Manufacturer#1            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9508.37         | Supplier#000000070        | FRANCE                    | 17268      | Manufacturer#4            | INWNH2w,OOWgNDq0BRCcBwOMQc6PdFDc4        | 16-821-608-1166 | ests sleep quickly express ideas. ironic ideas haggle about the final T                               |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 10021      | Manufacturer#5            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9453.01         | Supplier#000000802        | ROMANIA                   | 13275      | Manufacturer#4            | ,6HYXb4uaHITmtMBj4Ak57Pd                 | 29-342-882-6463 | gular frets. permanently special multipliers believe blithely alongs                                  |
| 9192.10         | Supplier#000000115        | UNITED KINGDOM            | 13325      | Manufacturer#1            | nJ 2t0f7Ve,wL1,6WzGBJLNBUCKlsV           | 33-597-248-1220 | es across the carefully express accounts boost caref                                                  |
| 9032.15         | Supplier#000000959        | GERMANY                   | 4958       | Manufacturer#4            | 8grA EHBnwOZhO                           | 17-108-642-3106 | nding dependencies nag furiou                                                                         |
| 8702.02         | Supplier#000000333        | RUSSIA                    | 11810      | Manufacturer#3            | MaVf XgwPdkiX4nfJGOis8Uu2zKiIZH          | 32-508-202-6136 | oss the deposits cajole carefully even pinto beans. regular foxes detect alo                          |
| 8615.50         | Supplier#000000812        | FRANCE                    | 10551      | Manufacturer#2            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
| 8615.50         | Supplier#000000812        | FRANCE                    | 13811      | Manufacturer#4            | 8qh4tezyScl5bidLAysvutB,,ZI2dn6xP        | 16-585-724-6633 | y quickly regular deposits? quickly pending packages after the caref                                  |
+-----------------+---------------------------+---------------------------+------------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------------------------------------------+

> SELECT
> L_ORDERKEY,
> SUM(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) AS REVENUE,
> O_ORDERDATE,
> O_SHIPPRIORITY
> FROM
> CUSTOMER,
> ORDERS,
> LINEITEM
> WHERE
> C_MKTSEGMENT = 'BUILDING' AND
> C_CUSTKEY = O_CUSTKEY AND
> L_ORDERKEY = O_ORDERKEY AND
> O_ORDERDATE < DATE '1995-03-15' AND
> L_SHIPDATE > DATE '1995-03-15'
> GROUP BY
> L_ORDERKEY,
> O_ORDERDATE,
> O_SHIPPRIORITY
> ORDER BY
> REVENUE DESC,
> O_ORDERDATE;
+------------+---------------------+-------------+----------------+
| L_ORDERKEY | REVENUE             | O_ORDERDATE | O_SHIPPRIORITY |
+------------+---------------------+-------------+----------------+
| 223140     | 355369.0698         | 1995-03-14  | 0              |
| 584291     | 354494.7318         | 1995-02-21  | 0              |
| 405063     | 353125.4577         | 1995-03-03  | 0              |
| 573861     | 351238.2770         | 1995-03-09  | 0              |
| 554757     | 349181.7426         | 1995-03-14  | 0              |
| 506021     | 321075.5810         | 1995-03-10  | 0              |
| 121604     | 318576.4154         | 1995-03-07  | 0              |
| 108514     | 314967.0754         | 1995-02-20  | 0              |
| 462502     | 312604.5420         | 1995-03-08  | 0              |
| 178727     | 309728.9306         | 1995-02-25  | 0              |
+------------+---------------------+-------------+----------------+

> alter session set "label" = null;
0 rows affected.
-- end of thread queries3

