<?xml version="1.0" ?>
<Root>
    <TestCase name="testUnionToDistinctRule">
        <Resource name="sql">
            <![CDATA[select * from dept union select * from dept]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
AggregateRel(groupCount=[2])
  UnionRel(all=[true])
    ProjectRel(DEPTNO=[$0], NAME=[$1])
      TableAccessRel(table=[[SALES, DEPT]])
    ProjectRel(DEPTNO=[$0], NAME=[$1])
      TableAccessRel(table=[[SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
UnionRel(all=[false])
  ProjectRel(DEPTNO=[$0], NAME=[$1])
    TableAccessRel(table=[[SALES, DEPT]])
  ProjectRel(DEPTNO=[$0], NAME=[$1])
    TableAccessRel(table=[[SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testExtractJoinFilterRule">
        <Resource name="sql">
            <![CDATA[select 1 from emp inner join dept on emp.deptno=dept.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
ProjectRel(EXPR$0=[1])
  JoinRel(condition=[=($7, $8)], joinType=[inner])
    TableAccessRel(table=[[SALES, EMP]])
    TableAccessRel(table=[[SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
ProjectRel(EXPR$0=[1])
  FilterRel(condition=[=($7, $8)])
    JoinRel(condition=[true], joinType=[inner])
      TableAccessRel(table=[[SALES, EMP]])
      TableAccessRel(table=[[SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testAddRedundantSemiJoinRule">
        <Resource name="sql">
            <![CDATA[select 1 from emp inner join dept on emp.deptno = dept.deptno]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
ProjectRel(EXPR$0=[1])
  JoinRel(condition=[=($7, $8)], joinType=[inner])
    TableAccessRel(table=[[SALES, EMP]])
    TableAccessRel(table=[[SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
ProjectRel(EXPR$0=[1])
  JoinRel(condition=[=($7, $8)], joinType=[inner], semiJoinDone=[true], multiJoinDone=[false])
    SemiJoinRel(condition=[=($7, $8)], joinType=[inner])
      TableAccessRel(table=[[SALES, EMP]])
      TableAccessRel(table=[[SALES, DEPT]])
    TableAccessRel(table=[[SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testPushFilterThroughOuterJoin">
        <Resource name="sql">
            <![CDATA[select 1 from sales.dept d left outer join sales.emp e on d.deptno = e.deptno where d.name = 'Charlie']]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
ProjectRel(EXPR$0=[1])
  FilterRel(condition=[=($1, _ISO-8859-1'Charlie')])
    JoinRel(condition=[=($0, $9)], joinType=[left])
      TableAccessRel(table=[[SALES, DEPT]])
      TableAccessRel(table=[[SALES, EMP]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
ProjectRel(EXPR$0=[1])
  JoinRel(condition=[=($0, $9)], joinType=[left])
    FilterRel(condition=[=($1, _ISO-8859-1'Charlie')])
      TableAccessRel(table=[[SALES, DEPT]])
    TableAccessRel(table=[[SALES, EMP]])
]]>
        </Resource>
    </TestCase>
    <TestCase name="testReduceAverage">
        <Resource name="sql">
            <![CDATA[select name, max(name), avg(deptno), min(name) from sales.dept group by name]]>
        </Resource>
        <Resource name="planBefore">
            <![CDATA[
ProjectRel(NAME=[$0], EXPR$1=[$1], EXPR$2=[$2], EXPR$3=[$3])
  AggregateRel(groupCount=[1], agg#0=[MAX(0)], agg#1=[AVG(1)], agg#2=[MIN(0)])
    ProjectRel($f0=[$1], $f1=[$0])
      TableAccessRel(table=[[SALES, DEPT]])
]]>
        </Resource>
        <Resource name="planAfter">
            <![CDATA[
ProjectRel(NAME=[$0], EXPR$1=[$1], EXPR$2=[$2], EXPR$3=[$3])
  ProjectRel($f0=[$0], $f1=[$1], $f2=[CAST(/($2, $4)):INTEGER], $f3=[$3])
    AggregateRel(groupCount=[1], agg#0=[MAX(0)], agg#1=[SUM(1)], agg#2=[MIN(0)], agg#3=[COUNT(1)])
      ProjectRel($f0=[$1], $f1=[$0])
        TableAccessRel(table=[[SALES, DEPT]])
]]>
        </Resource>
    </TestCase>
</Root>
